X-Received: by 2002:a17:902:e3:: with SMTP id a90mr1592075pla.133.1549997185461;
        Tue, 12 Feb 2019 10:46:25 -0800 (PST)
X-BeenThere: singularity@lbl.gov
Received: by 2002:a17:902:70ca:: with SMTP id l10ls9064748plt.0.gmail; Tue, 12
 Feb 2019 10:46:23 -0800 (PST)
X-Received: by 2002:a17:902:1e8:: with SMTP id b95mr5288186plb.325.1549997183714;
        Tue, 12 Feb 2019 10:46:23 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1549997183; cv=none;
        d=google.com; s=arc-20160816;
        b=U1l54/7L9yClX9ASumb6iyPW2bFRPH2RG9lWcS6uR6g9rB9x/20bL3R7CJKF62Sx+w
         ZFc+u3Gwqm+7tAwLfYKO1364X9J4qtgK+ijDqYcqbL6N+krbcT4munA8lFx47TQ3a4tO
         qIDHFb554CkJo/OzcLSZtJNVrSKQ3/mJT/yjj70eQUxPCpd8PNOwOqLblo0orJ0Qn65D
         iStGPh7UH3EXpQOAg8/EDDa2/g3uFYTPqsTyYPdU8kW6z/kWNHKAsC2gN8MyGLofHn+6
         GetDqeygT1Rm3pzLfBxcwebdxOfG2eA6CguL8664Yxh0cLDREqTzdw4wNmtaaYZ/IalU
         zSEQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=to:subject:message-id:date:from:in-reply-to:references:mime-version
         :dkim-signature;
        bh=8dRlzIdoQWLHD3Mm2nljg0tRKuEHEjGDJ2H4OgPvDZM=;
        b=SdXSIJIRwXXX3SC3YNf1IOViL7/0gdZEjrznHhumu8MDHlz0yzZDYo4a465Nb6LW4D
         w0eJobLsNWDzA/krAcux3DDsD8VmdOcrCxoPc+kw3Jb3IqT+YJBtol9AK6Jf6vQDNRMZ
         gt5pZbbsCw5ETrXfuCFhiXCrfwHZoPzqn1yPG15TvPrfQnSr2dQPti3EFKiW7NGHt0qT
         aSAcomjhL9CHxJPpjbvb4iq0DknbBkS02m2P4VcG5xbR3hESN15hL0mgvr6jHwh2B/v/
         9USKRMuD5b193AGfo7H6o8EVDiy3eRqI/aHaHpclQL+JtpgVpRzefPgMYB8krUcd8Lk8
         nOow==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=pass head...@gmail.com header.s=20161025 header.b=H+RZuVvQ;
       spf=pass (google.com: domain of bulldog...@gmail.com designates 209.85.210.49 as permitted sender) smtp.mailfrom=bulldog...@gmail.com
Return-Path: <bulldog...@gmail.com>
Received: from fe4.lbl.gov (fe4.lbl.gov. [131.243.228.53])
        by mx.google.com with ESMTP id l7si13923374pfg.245.2019.02.12.10.46.23
        for <singu...@lbl.gov>;
        Tue, 12 Feb 2019 10:46:23 -0800 (PST)
Received-SPF: pass (google.com: domain of bulldog...@gmail.com designates 209.85.210.49 as permitted sender) client-ip=209.85.210.49;
Authentication-Results: mx.google.com;
       dkim=pass head...@gmail.com header.s=20161025 header.b=H+RZuVvQ;
       spf=pass (google.com: domain of bulldog...@gmail.com designates 209.85.210.49 as permitted sender) smtp.mailfrom=bulldog...@gmail.com
X-Ironport-SBRS: 2.7
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A2FwBwDOE2NcfzHSVdFjghdESk2BEIEDJ?=
 =?us-ascii?q?4N+BoEdgi0xkBCBJWiJFotLgzIUgSs4BCUBAhOBAoM8AoNGIjQJDQEDAQECAQE?=
 =?us-ascii?q?CAQECEAEBCQsLCBsMJQyCOgUCAx8HDk07LwEBAQEBAQEBAQEBHwItBj0BAQEBA?=
 =?us-ascii?q?gEjHQENDh4DAQsGAwILCgMgAQkCAiEBAQ4DAQUBCxEOBwQBHASDBCcBgUABAw0?=
 =?us-ascii?q?IBY96kAo8ixuBEgUBF4J5BXWDRAoZJw1fgTcCBhKMMYFWQIERgxKCV4F3ARECA?=
 =?us-ascii?q?YMngjUiAoEsAQEBiDtEUYZAWpBTMgEGAgGBXgeFU4Nsg3GDOxmBbVKQIYtChVq?=
 =?us-ascii?q?HOwGDVTCBJWENDSNxcIEBbYFOCYIfFxODOIZRhCAkMBCOG4F3AQE?=
X-IronPort-AV: E=Sophos;i="5.58,362,1544515200"; 
   d="scan'208,217";a="51375154"
Received: from mail-ot1-f49.google.com ([209.85.210.49])
  by fe4.lbl.gov with ESMTP; 12 Feb 2019 10:46:21 -0800
Received: by mail-ot1-f49.google.com with SMTP id n71so6177841ota.10
        for <singu...@lbl.gov>; Tue, 12 Feb 2019 10:46:21 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20161025;
        h=mime-version:references:in-reply-to:from:date:message-id:subject:to;
        bh=8dRlzIdoQWLHD3Mm2nljg0tRKuEHEjGDJ2H4OgPvDZM=;
        b=H+RZuVvQBVWV6s0WJ9CGytiX6KOi37m1Btvsf/vLFfUGlHpGDF52rBOnUFAwb3/GDM
         38kwgA7uzVHA0hHG+2I2+ZMD1FdPr4YjFF6rkagVa5BbEiwG8S3f64yMgwjOq5GXSshO
         ybO+YcBfFWBsSDQwIkLrG7qdScOdcwsIH1qmNP0DlSjkYZ8OGMSen4zb2uODu9zJCYsd
         AXwyk5/nl51hdt+wUhQsLh3ERsuKjyz9wqwu8jnVXQciGvr3L9XpLsW9j9Q200YcLzlP
         uAGc9NAGGEZWrmEgPiX8qnl9/KYmjFR1WoB0GJPZjTNqhm56l50dtyZfMDp1VO6pXP2p
         QiUg==
X-Gm-Message-State: AHQUAuZ7Kr2AhyTrWy6A5YkFyaN4FmGMZSoil/PMLsI65NX/c7lxx23o
	mPSuXw6PVKbezI2kWS1p7MzqD+s2WpU04s/QCXHkWzFN
X-Received: by 2002:a05:6830:208e:: with SMTP id y14mr4961553otq.92.1549997180645;
 Tue, 12 Feb 2019 10:46:20 -0800 (PST)
MIME-Version: 1.0
References: <c9d4ff43-1036-46b5-ba2f-a97491d4e59f@lbl.gov> <71474c03-3137-4a03-a2fa-8f09b13e9f2b@lbl.gov>
 <CAOivMdStzrZUg8XSrSS++0iforrsuVL3rdxsaGbE9AK+2aAZag@mail.gmail.com>
 <fee8fd72-5e96-4653-b90c-cebcd5f05805@lbl.gov> <CAOivMdRFdUy59we6-nc8cLFE9V9TqA6TT43cBerUWc0MpMCCzQ@mail.gmail.com>
In-Reply-To: <CAOivMdRFdUy59we6-nc8cLFE9V9TqA6TT43cBerUWc0MpMCCzQ@mail.gmail.com>
From: Bulldog20630405 <bulldog...@gmail.com>
Date: Tue, 12 Feb 2019 13:46:09 -0500
Message-ID: <CAFF6QLaLepvxSDStb-=VzV4GS9noD0d+yaAsPhvYFW+CVAgMmA@mail.gmail.com>
Subject: Re: [Singularity] Re: jupyter notebook singularity images (creating
 new notebook) write error
To: singularity@lbl.gov
Content-Type: multipart/alternative; boundary="0000000000005af4eb0581b6d768"

--0000000000005af4eb0581b6d768
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable

XDG_VTNR=3D1
MANPATH=3D/opt/rh/rh-python36/root/usr/share/man:/opt/rh/rh-python36/root/u=
sr/share/man:
SSH_AGENT_PID=3D10187
XDG_SESSION_ID=3D952
HOSTNAME=3Dlocalhost.localdomain
IMSETTINGS_INTEGRATE_DESKTOP=3Dyes
TERM=3Dxterm-256color
VTE_VERSION=3D5202
XDG_MENU_PREFIX=3Dgnome-
SHELL=3D/bin/bash
HADOOP_HOME=3D/opt/hadoop/
HISTSIZE=3D32767
KERN_DIR=3D/usr/src/kernels/3.10.0-957.5.1.el7.x86_64
GNOME_TERMINAL_SCREEN=3D/org/gnome/Terminal/screen/3c0b98a7_c32b_481e_ad2c_=
4043368e661e
ACCUMULO_LOG_DIR=3D/data/accumulo/logs
QTDIR=3D/usr/lib64/qt-3.3
QTINC=3D/usr/lib64/qt-3.3/include
IMSETTINGS_MODULE=3Dnone
QT_GRAPHICSSYSTEM_CHECKED=3D1
USER=3Dbulldog
LS_COLORS=3Drs=3D0:di=3D38;5;27:ln=3D38;5;51:mh=3D44;38;5;15:pi=3D40;38;5;1=
1:so=3D38;5;13:do=3D38;5;5:bd=3D48;5;232;38;5;11:cd=3D48;5;232;38;5;3:or=3D=
48;5;232;38;5;9:mi=3D05;48;5;232;38;5;15:su=3D48;5;196;38;5;15:sg=3D48;5;11=
;38;5;16:ca=3D48;5;196;38;5;226:tw=3D48;5;10;38;5;16:ow=3D48;5;10;38;5;21:s=
t=3D48;5;21;38;5;15:ex=3D38;5;34:*.tar=3D38;5;9:*.tgz=3D38;5;9:*.arc=3D38;5=
;9:*.arj=3D38;5;9:*.taz=3D38;5;9:*.lha=3D38;5;9:*.lz4=3D38;5;9:*.lzh=3D38;5=
;9:*.lzma=3D38;5;9:*.tlz=3D38;5;9:*.txz=3D38;5;9:*.tzo=3D38;5;9:*.t7z=3D38;=
5;9:*.zip=3D38;5;9:*.z=3D38;5;9:*.Z=3D38;5;9:*.dz=3D38;5;9:*.gz=3D38;5;9:*.=
lrz=3D38;5;9:*.lz=3D38;5;9:*.lzo=3D38;5;9:*.xz=3D38;5;9:*.bz2=3D38;5;9:*.bz=
=3D38;5;9:*.tbz=3D38;5;9:*.tbz2=3D38;5;9:*.tz=3D38;5;9:*.deb=3D38;5;9:*.rpm=
=3D38;5;9:*.jar=3D38;5;9:*.war=3D38;5;9:*.ear=3D38;5;9:*.sar=3D38;5;9:*.rar=
=3D38;5;9:*.alz=3D38;5;9:*.ace=3D38;5;9:*.zoo=3D38;5;9:*.cpio=3D38;5;9:*.7z=
=3D38;5;9:*.rz=3D38;5;9:*.cab=3D38;5;9:*.jpg=3D38;5;13:*.jpeg=3D38;5;13:*.g=
if=3D38;5;13:*.bmp=3D38;5;13:*.pbm=3D38;5;13:*.pgm=3D38;5;13:*.ppm=3D38;5;1=
3:*.tga=3D38;5;13:*.xbm=3D38;5;13:*.xpm=3D38;5;13:*.tif=3D38;5;13:*.tiff=3D=
38;5;13:*.png=3D38;5;13:*.svg=3D38;5;13:*.svgz=3D38;5;13:*.mng=3D38;5;13:*.=
pcx=3D38;5;13:*.mov=3D38;5;13:*.mpg=3D38;5;13:*.mpeg=3D38;5;13:*.m2v=3D38;5=
;13:*.mkv=3D38;5;13:*.webm=3D38;5;13:*.ogm=3D38;5;13:*.mp4=3D38;5;13:*.m4v=
=3D38;5;13:*.mp4v=3D38;5;13:*.vob=3D38;5;13:*.qt=3D38;5;13:*.nuv=3D38;5;13:=
*.wmv=3D38;5;13:*.asf=3D38;5;13:*.rm=3D38;5;13:*.rmvb=3D38;5;13:*.flc=3D38;=
5;13:*.avi=3D38;5;13:*.fli=3D38;5;13:*.flv=3D38;5;13:*.gl=3D38;5;13:*.dl=3D=
38;5;13:*.xcf=3D38;5;13:*.xwd=3D38;5;13:*.yuv=3D38;5;13:*.cgm=3D38;5;13:*.e=
mf=3D38;5;13:*.axv=3D38;5;13:*.anx=3D38;5;13:*.ogv=3D38;5;13:*.ogx=3D38;5;1=
3:*.aac=3D38;5;45:*.au=3D38;5;45:*.flac=3D38;5;45:*.mid=3D38;5;45:*.midi=3D=
38;5;45:*.mka=3D38;5;45:*.mp3=3D38;5;45:*.mpc=3D38;5;45:*.ogg=3D38;5;45:*.r=
a=3D38;5;45:*.wav=3D38;5;45:*.axa=3D38;5;45:*.oga=3D38;5;45:*.spx=3D38;5;45=
:*.xspf=3D38;5;45:
LD_LIBRARY_PATH=3D/opt/rh/rh-python36/root/usr/lib64:/opt/rh/rh-python36/ro=
ot/usr/lib64
GNOME_TERMINAL_SERVICE=3D:1.101
SSH_AUTH_SOCK=3D/run/user/1005/keyring/ssh
SESSION_MANAGER=3Dlocal/unix:@
/tmp/.ICE-unix/9996,unix/unix:/tmp/.ICE-unix/9996
USERNAME=3Dbulldog
GNOME_SHELL_SESSION_MODE=3Dclassic
DESKTOP_SESSION=3Dgnome-classic
MAIL=3D/var/spool/mail/bulldog
PATH=3D/opt/rh/rh-python36/root/usr/bin::/usr/lib/jvm/java-1.8.0-openjdk-1.=
8.0.191.b12-1.el7_6.x86_64/bin:/opt/scala/bin:/opt/go/bin:/opt/maven/bin:/o=
pt/singularity/bin:/home/bulldog/go/bin:/usr/lib64/qt-3.3/bin:/usr/local/bi=
n:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin:/home/bulldog/.local/bin:/h=
ome/bulldog/bin:/opt/hadoop//bin:/opt/hadoop//sbin:/bin:/opt/accumulo//bin
MAVEN_HOME=3D/opt/maven
ZOO_LOG_DIR=3D/data/zookeeper/logs
QT_IM_MODULE=3Dxim
ZOO_LOG4J_PROP=3DWARN,ROLLINGFILE
GO_HOME=3D/opt/go
XDG_SESSION_TYPE=3Dx11
PWD=3D/home/bulldog
SINGULARITY_HOME=3D/opt/singularity
XMODIFIERS=3D@im=3Dnone
JAVA_HOME=3D/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.191.b12-1.el7_6.x86_64
LANG=3Den_US.UTF-8
GDM_LANG=3Den_US.UTF-8
KDEDIRS=3D/usr
PS1=3D\[\e[31;1m\][\u@\[\e[34;1m\]\H \W]# \[\e[0m\]
ZOOKEEPER_HOME=3D/opt/zookeeper/
GDMSESSION=3Dgnome-classic
HISTCONTROL=3Derasedups
SHLVL=3D2
HOME=3D/home/bulldog
XDG_SEAT=3Dseat0
GNOME_DESKTOP_SESSION_ID=3Dthis-is-deprecated
XDG_SESSION_DESKTOP=3Dgnome-classic
LOGNAME=3Dbulldog
QTLIB=3D/usr/lib64/qt-3.3/lib
DBUS_SESSION_BUS_ADDRESS=3Dunix:abstract=3D/tmp/dbus-M95FiFjB43,guid=3D3c7e=
df4ba91a80ae500d47285c62f874
XDG_DATA_DIRS=3D/opt/rh/rh-python36/root/usr/share:/opt/rh/rh-python36/root=
/usr/share:/home/bulldog/.local/share/flatpak/exports/share/:/var/lib/flatp=
ak/exports/share/:/usr/local/share/:/usr/share/
ACCUMULO_HOME=3D/opt/accumulo/
GOPATH=3D/home/bulldog/go
PKG_CONFIG_PATH=3D/opt/rh/rh-python36/root/usr/lib64/pkgconfig:/opt/rh/rh-p=
ython36/root/usr/lib64/pkgconfig
LESSOPEN=3D||/usr/bin/lesspipe.sh %s
ACCUMULO_PID_DIR=3D/data/accumulo/pid
SCALA_HOME=3D/opt/scala
WINDOWPATH=3D1:1:1:1:1
XDG_RUNTIME_DIR=3D/run/user/1005
DISPLAY=3D:0
QT_PLUGIN_PATH=3D/usr/lib64/kde4/plugins:/usr/lib/kde4/plugins
XDG_CURRENT_DESKTOP=3DGNOME-Classic:GNOME
XAUTHORITY=3D/run/gdm/auth-for-bulldog-urCBL1/database
COLORTERM=3Dtruecolor
OLDPWD=3D/home/bulldog/dev/singularity-dev/singularity_definitions
_=3D/usr/bin/env


On Tue, Feb 12, 2019 at 1:33 PM Michael Bauer <bau...@umich.edu> wrote:

> Glad to hear you got it working.
>
> I think your environment on your host might have a weird value set. Can
> you run `env` on your host and paste the entire output? I think that migh=
t
> help explain the weird behavior
>
> On Tue, Feb 12, 2019 at 11:23 AM Bulldog20630405 <
> bulldog...@gmail.com> wrote:
>
>>
>> thanx for the tip:
>>
>> i got it to work doing the following (its repeatable):
>>
>> export HOME=3D/home/username
>> cd /data/jupyter #(mounted from host using --bind)
>>
>> jupyter notebook --no-browser
>>
>>
>> what is needs to the ability to write to:
>>
>>    - where jupyter is started
>>    - /run/uid
>>    - /home/username/.local
>>
>>
>>
>> which makes sense except for having to change HOME back to my home path
>> from host???
>>
>> singularity --debug shell --bind /data:/data,/run,/home/username jupyter=
.
>> sif
>> DEBUG   [U=3D1005,P=3D1925]    envStringNSlice()             Set home Va=
lue
>> to: /opt/singularity
>>
>>
>>
>>
>>
>> On Tuesday, February 12, 2019 at 12:42:04 PM UTC-5, Michael Bauer wrote:
>>>
>>> Hi,
>>>
>>> In order to help debug this, can you run the command with debug flag an=
d
>>> paste the output here. In this case:
>>>
>>> singularity --debug shell [...]
>>>
>>> On Tue, Feb 12, 2019 at 10:33 AM Bulldog20630405 <bul...@gmail.com>
>>> wrote:
>>>
>>>>
>>>> (forgot to add commands)
>>>>
>>>> run:
>>>> singularity shell --bind /data:/data,/run,/home/username jupyter.sif
>>>>
>>>> run inside container:
>>>> # cd to mounted writable to start jupyter
>>>> cd /data/jupyter
>>>> # start jupyter
>>>> jupyter notebook
>>>>
>>>> #from broswer =3D> new | python3
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> On Tuesday, February 12, 2019 at 12:24:14 PM UTC-5, Bulldog20630405
>>>> wrote:
>>>>>
>>>>>
>>>>> after building a jupyter notebook singularity instance and running it
>>>>> i get a write error when trying to create a new notebook.
>>>>> Unexpected error while saving file: Untitled.ipynb [Errno 13]
>>>>> Permission denied: '/opt/singularity/.local'
>>>>>
>>>>> when a new notebook is created; jupyter writes to $HOME/.local;
>>>>> however singularity seems to map $HOME to SINGULARITY_INSTALL_DIR (in=
 my
>>>>> case /opt/singularity).
>>>>>
>>>>> so then:
>>>>> export HOME=3D/home/username
>>>>>
>>>>>
>>>>> which then produces the following error:
>>>>> error
>>>>>
>>>>>
>>>>> Questions:
>>>>> 1) why does singularity remap HOME to SINGULARITY_INSTALL_DIR?
>>>>> 2) after resetting HOME back to home directory; why does it still
>>>>> error out?
>>>>>
>>>>>
>>>>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>>>>>
>>>>> {
>>>>>
>>>>>
>>>>> BootStrap: docker
>>>>> From: fedora:28
>>>>>
>>>>>
>>>>> %setup
>>>>> rm -rf /tmp/sing_fedora-jupyter
>>>>> mkdir /tmp/sing_fedora-jupyter
>>>>> touch /tmp/sing_fedora-jupyter/bashrc
>>>>> echo 'export PS1=3D"\[\e[30;1m\]Singularity ${SINGULARITY_NAME}:\[\e[=
31;1m\]\u:\[\e[34;1m\]\W]> \[\e[0m\]"' >> /tmp/sing_fedora-jupyter/bashrc
>>>>> echo "alias rm=3D'rm -i'"                              >> /tmp/sing_f=
edora-jupyter/bashrc
>>>>> echo "alias cp=3D'cp -i'"                              >> /tmp/sing_f=
edora-jupyter/bashrc
>>>>> echo "alias mv=3D'mv -i'"                              >> /tmp/sing_f=
edora-jupyter/bashrc
>>>>> echo "alias lss=3D'ls --color=3Dtty '"                   >> /tmp/sing=
_fedora-jupyter/bashrc
>>>>> echo "alias l=3D'lss -F '"                             >> /tmp/sing_f=
edora-jupyter/bashrc
>>>>> echo "alias ll=3D'lss -lhF '"                          >> /tmp/sing_f=
edora-jupyter/bashrc
>>>>> echo "alias lll=3D'lss -lrthF '"                       >> /tmp/sing_f=
edora-jupyter/bashrc
>>>>> echo "alias la=3D'lss -ahF '"                          >> /tmp/sing_f=
edora-jupyter/bashrc
>>>>> echo "alias lla=3D'lss -alhF '"                        >> /tmp/sing_f=
edora-jupyter/bashrc
>>>>> echo "alias llla=3D'lss -alrthF '"                     >> /tmp/sing_f=
edora-jupyter/bashrc
>>>>> echo "alias l.=3D'lss -dF .* '"                        >> /tmp/sing_f=
edora-jupyter/bashrc
>>>>> echo "alias ll.=3D'lss -dlhF .* '"                     >> /tmp/sing_f=
edora-jupyter/bashrc
>>>>> echo "alias lll.=3D'lss -dlrthF .* '"                  >> /tmp/sing_f=
edora-jupyter/bashrc
>>>>> echo "alias inet=3D'ifconfig | grep "inet "'"          >> /tmp/sing_f=
edora-jupyter/bashrc
>>>>> echo "alias hist=3D'history | tail -n 80'"             >> /tmp/sing_f=
edora-jupyter/bashrc
>>>>> echo ""                                              >> /tmp/sing_fed=
ora-jupyter/bashrc
>>>>> echo "alias jup=3D'jupyter notebook --ip=3D'0.0.0.0' --port=3D8888 --=
no-browser'" >> /tmp/sing_fedora-jupyter/bashrc
>>>>>
>>>>>
>>>>> %files
>>>>> /tmp/sing_fedora-jupyter/bashrc /
>>>>>
>>>>>
>>>>> %post
>>>>>     chmod ugo+r /bashrc
>>>>>     yum clean all
>>>>>     yum -y update
>>>>>     yum -y install squashfs-tools ca-certificates net-tools vim-commo=
n vim-enhanced tree which python3-devel libstdc++
>>>>>     cd /usr/bin
>>>>>     pip3 install --upgrade pip setuptools
>>>>>     pip3 install pyyaml numpy scipy scikit-learn matplotlib tensorflo=
w tensorflow_probability torch torchvision jupyter
>>>>>     ln -s pip3 pip
>>>>>     ln -s python3 python
>>>>>
>>>>> %environment
>>>>>     export PATH=3D/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/=
bin:/sbin
>>>>>
>>>>> #%runscript
>>>>>
>>>>>
>>>>> #%startscript
>>>>>
>>>>>
>>>>> %test
>>>>>     echo "#################################"
>>>>>     echo "redhat-release  =3D> $(cat /etc/redhat-release)"
>>>>>     echo "kernel version  =3D> $(uname -r)"
>>>>>     echo "PATH            =3D> $PATH"
>>>>>     echo "python version  =3D> $(python --version)"
>>>>>     echo "pip version     =3D> $(pip --version)"
>>>>>     echo "jupyter version =3D> $(jupyter --version)"
>>>>>     echo ""
>>>>>
>>>>>
>>>>> %labels
>>>>>     Author bulldog
>>>>>
>>>>> }
>>>>>
>>>> --
>>>> You received this message because you are subscribed to the Google
>>>> Groups "singularity" group.
>>>> To unsubscribe from this group and stop receiving emails from it, send
>>>> an email to singu...@lbl.gov.
>>>>
>>> --
>> You received this message because you are subscribed to the Google Group=
s
>> "singularity" group.
>> To unsubscribe from this group and stop receiving emails from it, send a=
n
>> email to singu...@lbl.gov.
>>
> --
> You received this message because you are subscribed to the Google Groups
> "singularity" group.
> To unsubscribe from this group and stop receiving emails from it, send an
> email to singu...@lbl.gov.
>

--0000000000005af4eb0581b6d768
Content-Type: text/html; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div dir=3D"ltr">XDG_VTNR=3D1<br>MANPATH=3D/opt/rh/rh-pyth=
on36/root/usr/share/man:/opt/rh/rh-python36/root/usr/share/man:<br>SSH_AGEN=
T_PID=3D10187<br>XDG_SESSION_ID=3D952<br>HOSTNAME=3Dlocalhost.localdomain<b=
r>IMSETTINGS_INTEGRATE_DESKTOP=3Dyes<br>TERM=3Dxterm-256color<br>VTE_VERSIO=
N=3D5202<br>XDG_MENU_PREFIX=3Dgnome-<br>SHELL=3D/bin/bash<br>HADOOP_HOME=3D=
/opt/hadoop/<br>HISTSIZE=3D32767<br>KERN_DIR=3D/usr/src/kernels/3.10.0-957.=
5.1.el7.x86_64<br>GNOME_TERMINAL_SCREEN=3D/org/gnome/Terminal/screen/3c0b98=
a7_c32b_481e_ad2c_4043368e661e<br>ACCUMULO_LOG_DIR=3D/data/accumulo/logs<br=
>QTDIR=3D/usr/lib64/qt-3.3<br>QTINC=3D/usr/lib64/qt-3.3/include<br>IMSETTIN=
GS_MODULE=3Dnone<br>QT_GRAPHICSSYSTEM_CHECKED=3D1<br>USER=3Dbulldog<br>LS_C=
OLORS=3Drs=3D0:di=3D38;5;27:ln=3D38;5;51:mh=3D44;38;5;15:pi=3D40;38;5;11:so=
=3D38;5;13:do=3D38;5;5:bd=3D48;5;232;38;5;11:cd=3D48;5;232;38;5;3:or=3D48;5=
;232;38;5;9:mi=3D05;48;5;232;38;5;15:su=3D48;5;196;38;5;15:sg=3D48;5;11;38;=
5;16:ca=3D48;5;196;38;5;226:tw=3D48;5;10;38;5;16:ow=3D48;5;10;38;5;21:st=3D=
48;5;21;38;5;15:ex=3D38;5;34:*.tar=3D38;5;9:*.tgz=3D38;5;9:*.arc=3D38;5;9:*=
.arj=3D38;5;9:*.taz=3D38;5;9:*.lha=3D38;5;9:*.lz4=3D38;5;9:*.lzh=3D38;5;9:*=
.lzma=3D38;5;9:*.tlz=3D38;5;9:*.txz=3D38;5;9:*.tzo=3D38;5;9:*.t7z=3D38;5;9:=
*.zip=3D38;5;9:*.z=3D38;5;9:*.Z=3D38;5;9:*.dz=3D38;5;9:*.gz=3D38;5;9:*.lrz=
=3D38;5;9:*.lz=3D38;5;9:*.lzo=3D38;5;9:*.xz=3D38;5;9:*.bz2=3D38;5;9:*.bz=3D=
38;5;9:*.tbz=3D38;5;9:*.tbz2=3D38;5;9:*.tz=3D38;5;9:*.deb=3D38;5;9:*.rpm=3D=
38;5;9:*.jar=3D38;5;9:*.war=3D38;5;9:*.ear=3D38;5;9:*.sar=3D38;5;9:*.rar=3D=
38;5;9:*.alz=3D38;5;9:*.ace=3D38;5;9:*.zoo=3D38;5;9:*.cpio=3D38;5;9:*.7z=3D=
38;5;9:*.rz=3D38;5;9:*.cab=3D38;5;9:*.jpg=3D38;5;13:*.jpeg=3D38;5;13:*.gif=
=3D38;5;13:*.bmp=3D38;5;13:*.pbm=3D38;5;13:*.pgm=3D38;5;13:*.ppm=3D38;5;13:=
*.tga=3D38;5;13:*.xbm=3D38;5;13:*.xpm=3D38;5;13:*.tif=3D38;5;13:*.tiff=3D38=
;5;13:*.png=3D38;5;13:*.svg=3D38;5;13:*.svgz=3D38;5;13:*.mng=3D38;5;13:*.pc=
x=3D38;5;13:*.mov=3D38;5;13:*.mpg=3D38;5;13:*.mpeg=3D38;5;13:*.m2v=3D38;5;1=
3:*.mkv=3D38;5;13:*.webm=3D38;5;13:*.ogm=3D38;5;13:*.mp4=3D38;5;13:*.m4v=3D=
38;5;13:*.mp4v=3D38;5;13:*.vob=3D38;5;13:*.qt=3D38;5;13:*.nuv=3D38;5;13:*.w=
mv=3D38;5;13:*.asf=3D38;5;13:*.rm=3D38;5;13:*.rmvb=3D38;5;13:*.flc=3D38;5;1=
3:*.avi=3D38;5;13:*.fli=3D38;5;13:*.flv=3D38;5;13:*.gl=3D38;5;13:*.dl=3D38;=
5;13:*.xcf=3D38;5;13:*.xwd=3D38;5;13:*.yuv=3D38;5;13:*.cgm=3D38;5;13:*.emf=
=3D38;5;13:*.axv=3D38;5;13:*.anx=3D38;5;13:*.ogv=3D38;5;13:*.ogx=3D38;5;13:=
*.aac=3D38;5;45:*.au=3D38;5;45:*.flac=3D38;5;45:*.mid=3D38;5;45:*.midi=3D38=
;5;45:*.mka=3D38;5;45:*.mp3=3D38;5;45:*.mpc=3D38;5;45:*.ogg=3D38;5;45:*.ra=
=3D38;5;45:*.wav=3D38;5;45:*.axa=3D38;5;45:*.oga=3D38;5;45:*.spx=3D38;5;45:=
*.xspf=3D38;5;45:<br>LD_LIBRARY_PATH=3D/opt/rh/rh-python36/root/usr/lib64:/=
opt/rh/rh-python36/root/usr/lib64<br>GNOME_TERMINAL_SERVICE=3D:1.101<br>SSH=
_AUTH_SOCK=3D/run/user/1005/keyring/ssh<br>SESSION_MANAGER=3Dlocal/unix:@/t=
mp/.ICE-unix/9996,unix/unix:/tmp/.ICE-unix/9996<br>USERNAME=3Dbulldog<br>GN=
OME_SHELL_SESSION_MODE=3Dclassic<br>DESKTOP_SESSION=3Dgnome-classic<br>MAIL=
=3D/var/spool/mail/bulldog<br>PATH=3D/opt/rh/rh-python36/root/usr/bin::/usr=
/lib/jvm/java-1.8.0-openjdk-1.8.0.191.b12-1.el7_6.x86_64/bin:/opt/scala/bin=
:/opt/go/bin:/opt/maven/bin:/opt/singularity/bin:/home/bulldog/go/bin:/usr/=
lib64/qt-3.3/bin:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sb=
in:/home/bulldog/.local/bin:/home/bulldog/bin:/opt/hadoop//bin:/opt/hadoop/=
/sbin:/bin:/opt/accumulo//bin<br>MAVEN_HOME=3D/opt/maven<br>ZOO_LOG_DIR=3D/=
data/zookeeper/logs<br>QT_IM_MODULE=3Dxim<br>ZOO_LOG4J_PROP=3DWARN,ROLLINGF=
ILE<br>GO_HOME=3D/opt/go<br>XDG_SESSION_TYPE=3Dx11<br>PWD=3D/home/bulldog<b=
r>SINGULARITY_HOME=3D/opt/singularity<br>XMODIFIERS=3D@im=3Dnone<br>JAVA_HO=
ME=3D/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.191.b12-1.el7_6.x86_64<br>LANG=
=3Den_US.UTF-8<br>GDM_LANG=3Den_US.UTF-8<br>KDEDIRS=3D/usr<br>PS1=3D\[\e[31=
;1m\][\u@\[\e[34;1m\]\H \W]# \[\e[0m\]<br>ZOOKEEPER_HOME=3D/opt/zookeeper/<=
br>GDMSESSION=3Dgnome-classic<br>HISTCONTROL=3Derasedups<br>SHLVL=3D2<br>HO=
ME=3D/home/bulldog<br>XDG_SEAT=3Dseat0<br>GNOME_DESKTOP_SESSION_ID=3Dthis-i=
s-deprecated<br>XDG_SESSION_DESKTOP=3Dgnome-classic<br>LOGNAME=3Dbulldog<br=
>QTLIB=3D/usr/lib64/qt-3.3/lib<br>DBUS_SESSION_BUS_ADDRESS=3Dunix:abstract=
=3D/tmp/dbus-M95FiFjB43,guid=3D3c7edf4ba91a80ae500d47285c62f874<br>XDG_DATA=
_DIRS=3D/opt/rh/rh-python36/root/usr/share:/opt/rh/rh-python36/root/usr/sha=
re:/home/bulldog/.local/share/flatpak/exports/share/:/var/lib/flatpak/expor=
ts/share/:/usr/local/share/:/usr/share/<br>ACCUMULO_HOME=3D/opt/accumulo/<b=
r>GOPATH=3D/home/bulldog/go<br>PKG_CONFIG_PATH=3D/opt/rh/rh-python36/root/u=
sr/lib64/pkgconfig:/opt/rh/rh-python36/root/usr/lib64/pkgconfig<br>LESSOPEN=
=3D||/usr/bin/lesspipe.sh %s<br>ACCUMULO_PID_DIR=3D/data/accumulo/pid<br>SC=
ALA_HOME=3D/opt/scala<br>WINDOWPATH=3D1:1:1:1:1<br>XDG_RUNTIME_DIR=3D/run/u=
ser/1005<br>DISPLAY=3D:0<br>QT_PLUGIN_PATH=3D/usr/lib64/kde4/plugins:/usr/l=
ib/kde4/plugins<br>XDG_CURRENT_DESKTOP=3DGNOME-Classic:GNOME<br>XAUTHORITY=
=3D/run/gdm/auth-for-bulldog-urCBL1/database<br>COLORTERM=3Dtruecolor<br>OL=
DPWD=3D/home/bulldog/dev/singularity-dev/singularity_definitions<br>_=3D/us=
r/bin/env<br><br></div></div><br><div class=3D"gmail_quote"><div dir=3D"ltr=
" class=3D"gmail_attr">On Tue, Feb 12, 2019 at 1:33 PM Michael Bauer &lt;<a=
 href=3D"mailto:bau...@umich.edu">bau...@umich.edu</a>&gt; wrote:<br></div>=
<blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-=
left:1px solid rgb(204,204,204);padding-left:1ex"><div dir=3D"ltr">Glad to =
hear you got it working.<div><br></div><div>I think your environment on you=
r host might have a weird value set. Can you run `env` on your host and pas=
te the entire output? I think that might help explain the weird behavior</d=
iv></div><br><div class=3D"gmail_quote"><div dir=3D"ltr" class=3D"gmail_att=
r">On Tue, Feb 12, 2019 at 11:23 AM Bulldog20630405 &lt;<a href=3D"mailto:b=
ulldog...@gmail.com" target=3D"_blank">bulldog...@gmail.com</a>&gt; wrote:<=
br></div><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8e=
x;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div dir=3D"ltr"=
><br><div>thanx for the tip:<br><br>i got it to work doing the following (i=
ts repeatable):<br></div><div><br></div><div style=3D"background-color:rgb(=
250,250,250);border-color:rgb(187,187,187);border-style:solid;border-width:=
1px" class=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377prettyp=
rint"><code class=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377=
prettyprint"><div class=3D"gmail-m_7396657163828918198gmail-m_8667276839957=
419377subprettyprint"><span style=3D"color:rgb(0,0,136)" class=3D"gmail-m_7=
396657163828918198gmail-m_8667276839957419377styled-by-prettify">export</sp=
an><span style=3D"color:rgb(0,0,0)" class=3D"gmail-m_7396657163828918198gma=
il-m_8667276839957419377styled-by-prettify"> HOME</span><span style=3D"colo=
r:rgb(102,102,0)" class=3D"gmail-m_7396657163828918198gmail-m_8667276839957=
419377styled-by-prettify">=3D</span><span style=3D"color:rgb(0,136,0)" clas=
s=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377styled-by-pretti=
fy">/home/</span><span style=3D"color:rgb(0,0,0)" class=3D"gmail-m_73966571=
63828918198gmail-m_8667276839957419377styled-by-prettify">username<br>cd </=
span><span style=3D"color:rgb(102,102,0)" class=3D"gmail-m_7396657163828918=
198gmail-m_8667276839957419377styled-by-prettify">/</span><span style=3D"co=
lor:rgb(0,0,0)" class=3D"gmail-m_7396657163828918198gmail-m_866727683995741=
9377styled-by-prettify">data</span><span style=3D"color:rgb(102,102,0)" cla=
ss=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377styled-by-prett=
ify">/</span><span style=3D"color:rgb(0,0,0)" class=3D"gmail-m_739665716382=
8918198gmail-m_8667276839957419377styled-by-prettify">jupyter </span><span =
style=3D"color:rgb(136,0,0)" class=3D"gmail-m_7396657163828918198gmail-m_86=
67276839957419377styled-by-prettify">#(mounted from host using --bind)</spa=
n><span style=3D"color:rgb(0,0,0)" class=3D"gmail-m_7396657163828918198gmai=
l-m_8667276839957419377styled-by-prettify"><br><br>jupyter notebook </span>=
<span style=3D"color:rgb(102,102,0)" class=3D"gmail-m_7396657163828918198gm=
ail-m_8667276839957419377styled-by-prettify">--</span><span style=3D"color:=
rgb(0,0,136)" class=3D"gmail-m_7396657163828918198gmail-m_86672768399574193=
77styled-by-prettify">no</span><span style=3D"color:rgb(102,102,0)" class=
=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377styled-by-prettif=
y">-</span><span style=3D"color:rgb(0,0,0)" class=3D"gmail-m_73966571638289=
18198gmail-m_8667276839957419377styled-by-prettify">browser </span></div></=
code></div><div><br><br>what is needs to the ability to write to:<br><ul><l=
i> where jupyter is started</li><li>/run/uid</li><li>/home/username/.local<=
/li></ul><br></div><div><br>which makes sense except for having to change H=
OME back to my home path from host???<br><br><div style=3D"background-color=
:rgb(250,250,250);border-color:rgb(187,187,187);border-style:solid;border-w=
idth:1px" class=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377pr=
ettyprint"><code class=3D"gmail-m_7396657163828918198gmail-m_86672768399574=
19377prettyprint"><div class=3D"gmail-m_7396657163828918198gmail-m_86672768=
39957419377subprettyprint"><span style=3D"color:rgb(0,0,0)" class=3D"gmail-=
m_7396657163828918198gmail-m_8667276839957419377styled-by-prettify">singula=
rity </span><span style=3D"color:rgb(102,102,0)" class=3D"gmail-m_739665716=
3828918198gmail-m_8667276839957419377styled-by-prettify">--</span><span sty=
le=3D"color:rgb(0,0,0)" class=3D"gmail-m_7396657163828918198gmail-m_8667276=
839957419377styled-by-prettify">debug shell </span><span style=3D"color:rgb=
(102,102,0)" class=3D"gmail-m_7396657163828918198gmail-m_866727683995741937=
7styled-by-prettify">--</span><span style=3D"color:rgb(0,0,0)" class=3D"gma=
il-m_7396657163828918198gmail-m_8667276839957419377styled-by-prettify">bind=
 </span><span style=3D"color:rgb(102,102,0)" class=3D"gmail-m_7396657163828=
918198gmail-m_8667276839957419377styled-by-prettify">/</span><span style=3D=
"color:rgb(0,0,0)" class=3D"gmail-m_7396657163828918198gmail-m_866727683995=
7419377styled-by-prettify">data</span><span style=3D"color:rgb(102,102,0)" =
class=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377styled-by-pr=
ettify">:</span><span style=3D"color:rgb(0,136,0)" class=3D"gmail-m_7396657=
163828918198gmail-m_8667276839957419377styled-by-prettify">/data,/</span><s=
pan style=3D"color:rgb(0,0,0)" class=3D"gmail-m_7396657163828918198gmail-m_=
8667276839957419377styled-by-prettify">run</span><span style=3D"color:rgb(1=
02,102,0)" class=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377s=
tyled-by-prettify">,</span><span style=3D"color:rgb(0,136,0)" class=3D"gmai=
l-m_7396657163828918198gmail-m_8667276839957419377styled-by-prettify">/home=
/</span><span style=3D"color:rgb(0,0,0)" class=3D"gmail-m_73966571638289181=
98gmail-m_8667276839957419377styled-by-prettify">username jupyter</span><sp=
an style=3D"color:rgb(102,102,0)" class=3D"gmail-m_7396657163828918198gmail=
-m_8667276839957419377styled-by-prettify">.</span><span style=3D"color:rgb(=
0,0,0)" class=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377styl=
ed-by-prettify">sif<br>DEBUG =C2=A0 </span><span style=3D"color:rgb(102,102=
,0)" class=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377styled-=
by-prettify">[</span><span style=3D"color:rgb(0,0,0)" class=3D"gmail-m_7396=
657163828918198gmail-m_8667276839957419377styled-by-prettify">U</span><span=
 style=3D"color:rgb(102,102,0)" class=3D"gmail-m_7396657163828918198gmail-m=
_8667276839957419377styled-by-prettify">=3D</span><span style=3D"color:rgb(=
0,102,102)" class=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377=
styled-by-prettify">1005</span><span style=3D"color:rgb(102,102,0)" class=
=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377styled-by-prettif=
y">,</span><span style=3D"color:rgb(0,0,0)" class=3D"gmail-m_73966571638289=
18198gmail-m_8667276839957419377styled-by-prettify">P</span><span style=3D"=
color:rgb(102,102,0)" class=3D"gmail-m_7396657163828918198gmail-m_866727683=
9957419377styled-by-prettify">=3D</span><span style=3D"color:rgb(0,102,102)=
" class=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377styled-by-=
prettify">1925</span><span style=3D"color:rgb(102,102,0)" class=3D"gmail-m_=
7396657163828918198gmail-m_8667276839957419377styled-by-prettify">]</span><=
span style=3D"color:rgb(0,0,0)" class=3D"gmail-m_7396657163828918198gmail-m=
_8667276839957419377styled-by-prettify"> =C2=A0 =C2=A0envStringNSlice</span=
><span style=3D"color:rgb(102,102,0)" class=3D"gmail-m_7396657163828918198g=
mail-m_8667276839957419377styled-by-prettify">()</span><span style=3D"color=
:rgb(0,0,0)" class=3D"gmail-m_7396657163828918198gmail-m_866727683995741937=
7styled-by-prettify"> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 </span><spa=
n style=3D"color:rgb(102,0,102)" class=3D"gmail-m_7396657163828918198gmail-=
m_8667276839957419377styled-by-prettify">Set</span><span style=3D"color:rgb=
(0,0,0)" class=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377sty=
led-by-prettify"> home </span><span style=3D"color:rgb(102,0,102)" class=3D=
"gmail-m_7396657163828918198gmail-m_8667276839957419377styled-by-prettify">=
Value</span><span style=3D"color:rgb(0,0,0)" class=3D"gmail-m_7396657163828=
918198gmail-m_8667276839957419377styled-by-prettify"> to</span><span style=
=3D"color:rgb(102,102,0)" class=3D"gmail-m_7396657163828918198gmail-m_86672=
76839957419377styled-by-prettify">:</span><span style=3D"color:rgb(0,0,0)" =
class=3D"gmail-m_7396657163828918198gmail-m_8667276839957419377styled-by-pr=
ettify"> </span><span style=3D"color:rgb(0,136,0)" class=3D"gmail-m_7396657=
163828918198gmail-m_8667276839957419377styled-by-prettify">/opt/</span><spa=
n style=3D"color:rgb(0,0,0)" class=3D"gmail-m_7396657163828918198gmail-m_86=
67276839957419377styled-by-prettify">singularity</span></div></code></div><=
br><br><br></div><div><br></div><div><br></div>On Tuesday, February 12, 201=
9 at 12:42:04 PM UTC-5, Michael Bauer wrote:<blockquote class=3D"gmail_quot=
e" style=3D"margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204)=
;padding-left:1ex"><div dir=3D"ltr">Hi,<div><br></div><div>In order to help=
 debug this, can you run the command with debug flag and paste the output h=
ere. In this case:</div><div><br></div><div>singularity --debug shell [...]=
</div></div><br><div class=3D"gmail_quote"><div dir=3D"ltr">On Tue, Feb 12,=
 2019 at 10:33 AM Bulldog20630405 &lt;<a rel=3D"nofollow">bul...@gmail.com<=
/a>&gt; wrote:<br></div><blockquote class=3D"gmail_quote" style=3D"margin:0=
px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><=
div dir=3D"ltr"><div><br></div><div>(forgot to add commands)<br><br>run:<co=
de><div><span style=3D"color:rgb(0,0,0)">singularity shell </span><span sty=
le=3D"color:rgb(102,102,0)">--</span><span style=3D"color:rgb(0,0,0)">bind =
</span><span style=3D"color:rgb(102,102,0)">/</span><span style=3D"color:rg=
b(0,0,0)">data</span><span style=3D"color:rgb(102,102,0)">:</span><span sty=
le=3D"color:rgb(0,136,0)">/data,/</span><span style=3D"color:rgb(0,0,0)">ru=
n</span><span style=3D"color:rgb(102,102,0)">,</span><span style=3D"color:r=
gb(0,136,0)">/home/</span><span style=3D"color:rgb(0,0,0)">username jupyter=
</span><span style=3D"color:rgb(102,102,0)">.</span><span style=3D"color:rg=
b(0,0,0)">sif</span></div></code></div><div><br></div><div>run inside conta=
iner:<br></div><div style=3D"background-color:rgb(250,250,250);border-color=
:rgb(187,187,187);border-style:solid;border-width:1px"><code><div><span sty=
le=3D"color:rgb(136,0,0)"># cd to mounted writable to start jupyter</span><=
span style=3D"color:rgb(0,0,0)"><br>cd </span><span style=3D"color:rgb(102,=
102,0)">/</span><span style=3D"color:rgb(0,0,0)">data</span><span style=3D"=
color:rgb(102,102,0)">/</span><span style=3D"color:rgb(0,0,0)">jupyter<br><=
/span><span style=3D"color:rgb(136,0,0)"># start jupyter</span><span style=
=3D"color:rgb(0,0,0)"><br>jupyter notebook<br><br></span><span style=3D"col=
or:rgb(136,0,0)">#from broswer =3D&gt; new | python3</span><span style=3D"c=
olor:rgb(0,0,0)"><br></span><span style=3D"color:rgb(0,0,0)"><br><br></span=
></div></code></div><div><br><br></div><div><br></div><div><br></div><br>On=
 Tuesday, February 12, 2019 at 12:24:14 PM UTC-5, Bulldog20630405 wrote:<bl=
ockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-lef=
t:1px solid rgb(204,204,204);padding-left:1ex"><div dir=3D"ltr"><div><br></=
div><div>after building a jupyter notebook singularity instance and running=
 it i get a write error when trying to create a new notebook.=C2=A0 <br></d=
iv><div><div style=3D"background-color:rgb(250,250,250);border-color:rgb(18=
7,187,187);border-style:solid;border-width:1px"><code><div><span style=3D"c=
olor:rgb(102,0,102)">Unexpected</span><span style=3D"color:rgb(0,0,0)"> err=
or </span><span style=3D"color:rgb(0,0,136)">while</span><span style=3D"col=
or:rgb(0,0,0)"> saving file</span><span style=3D"color:rgb(102,102,0)">:</s=
pan><span style=3D"color:rgb(0,0,0)"> </span><span style=3D"color:rgb(102,0=
,102)">Untitled</span><span style=3D"color:rgb(102,102,0)">.</span><span st=
yle=3D"color:rgb(0,0,0)">ipynb </span><span style=3D"color:rgb(102,102,0)">=
[</span><span style=3D"color:rgb(102,0,102)">Errno</span><span style=3D"col=
or:rgb(0,0,0)"> </span><span style=3D"color:rgb(0,102,102)">13</span><span =
style=3D"color:rgb(102,102,0)">]</span><span style=3D"color:rgb(0,0,0)"> </=
span><span style=3D"color:rgb(102,0,102)">Permission</span><span style=3D"c=
olor:rgb(0,0,0)"> denied</span><span style=3D"color:rgb(102,102,0)">:</span=
><span style=3D"color:rgb(0,0,0)"> </span><span style=3D"color:rgb(0,136,0)=
">&#39;/opt/singularity/.local&#39;</span></div></code></div><br></div><div=
>when a new notebook is created; jupyter writes to $HOME/.local; however si=
ngularity seems to map $HOME to SINGULARITY_INSTALL_DIR (in my case /opt/si=
ngularity).=C2=A0 <br></div><div><br></div><div>so then:</div><div><div sty=
le=3D"background-color:rgb(250,250,250);border-color:rgb(187,187,187);borde=
r-style:solid;border-width:1px"><code><div><span style=3D"color:rgb(0,0,136=
)">export</span><span style=3D"color:rgb(0,0,0)"> HOME</span><span style=3D=
"color:rgb(102,102,0)">=3D</span><span style=3D"color:rgb(0,136,0)">/home/<=
/span><span style=3D"color:rgb(0,0,0)">username <br></span></div></code></d=
iv><br><br></div><div>which then produces the following error:<br><div styl=
e=3D"background-color:rgb(250,250,250);border-color:rgb(187,187,187);border=
-style:solid;border-width:1px"><code><div><span style=3D"color:rgb(0,0,0)">=
error<br></span></div></code></div><br></div><div><br></div><div>Questions:=
<br>1) why does singularity remap HOME to SINGULARITY_INSTALL_DIR?</div><di=
v>2) after resetting HOME back to home directory; why does it still error o=
ut?</div><div><br></div><div>=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D<br><br></div><div>{</div><div><pre style=3D"backgroun=
d-color:rgb(43,43,43);color:rgb(169,183,198);font-family:&quot;DejaVu Sans =
Mono&quot;;font-size:9pt"><br>BootStrap: docker<br>From: fedora:28<br><br><=
br>%setup<br>rm -rf /tmp/sing_fedora-jupyter<br>mkdir /tmp/sing_fedora-jupy=
ter<br>touch /tmp/sing_fedora-jupyter/bashrc<br>echo &#39;export PS1=3D&quo=
t;\[\e[30;1m\]Singularity ${SINGULARITY_NAME}:\[\e[31;1m\]\u:\[\e[34;1m\]\W=
]&gt; \[\e[0m\]&quot;&#39; &gt;&gt; /tmp/sing_fedora-jupyter/bashrc<br>echo=
 &quot;alias rm=3D&#39;rm -i&#39;&quot;                              &gt;&g=
t; /tmp/sing_fedora-jupyter/bashrc<br>echo &quot;alias cp=3D&#39;cp -i&#39;=
&quot;                              &gt;&gt; /tmp/sing_fedora-jupyter/bashr=
c<br>echo &quot;alias mv=3D&#39;mv -i&#39;&quot;                           =
   &gt;&gt; /tmp/sing_fedora-jupyter/bashrc<br>echo &quot;alias lss=3D&#39;=
ls --color=3Dtty &#39;&quot;                   &gt;&gt; /tmp/sing_fedora-ju=
pyter/bashrc<br>echo &quot;alias l=3D&#39;lss -F &#39;&quot;               =
              &gt;&gt; /tmp/sing_fedora-jupyter/bashrc<br>echo &quot;alias =
ll=3D&#39;lss -lhF &#39;&quot;                          &gt;&gt; /tmp/sing_=
fedora-jupyter/bashrc<br>echo &quot;alias lll=3D&#39;lss -lrthF &#39;&quot;=
                       &gt;&gt; /tmp/sing_fedora-jupyter/bashrc<br>echo &qu=
ot;alias la=3D&#39;lss -ahF &#39;&quot;                          &gt;&gt; /=
tmp/sing_fedora-jupyter/bashrc<br>echo &quot;alias lla=3D&#39;lss -alhF &#3=
9;&quot;                        &gt;&gt; /tmp/sing_fedora-jupyter/bashrc<br=
>echo &quot;alias llla=3D&#39;lss -alrthF &#39;&quot;                     &=
gt;&gt; /tmp/sing_fedora-jupyter/bashrc<br>echo &quot;alias l.=3D&#39;lss -=
dF .* &#39;&quot;                        &gt;&gt; /tmp/sing_fedora-jupyter/=
bashrc<br>echo &quot;alias ll.=3D&#39;lss -dlhF .* &#39;&quot;             =
        &gt;&gt; /tmp/sing_fedora-jupyter/bashrc<br>echo &quot;alias lll.=
=3D&#39;lss -dlrthF .* &#39;&quot;                  &gt;&gt; /tmp/sing_fedo=
ra-jupyter/bashrc<br>echo &quot;alias inet=3D&#39;ifconfig | grep &quot;ine=
t &quot;&#39;&quot;          &gt;&gt; /tmp/sing_fedora-jupyter/bashrc<br>ec=
ho &quot;alias hist=3D&#39;history | tail -n 80&#39;&quot;             &gt;=
&gt; /tmp/sing_fedora-jupyter/bashrc<br>echo &quot;&quot;                  =
                            &gt;&gt; /tmp/sing_fedora-jupyter/bashrc<br>ech=
o &quot;alias jup=3D&#39;jupyter notebook --ip=3D&#39;0.0.0.0&#39; --port=
=3D8888 --no-browser&#39;&quot; &gt;&gt; /tmp/sing_fedora-jupyter/bashrc<br=
><br><br>%files<br>/tmp/sing_fedora-jupyter/bashrc /<br><br><br>%post<br>  =
  chmod ugo+r /bashrc<br>    yum clean all<br>    yum -y update<br>    yum =
-y install squashfs-tools ca-certificates net-tools vim-common vim-enhanced=
 tree which python3-devel libstdc++<br>    cd /usr/bin<br>    pip3 install =
--upgrade pip setuptools<br>    pip3 install pyyaml numpy scipy scikit-lear=
n matplotlib tensorflow tensorflow_probability torch torchvision jupyter<br=
>    ln -s pip3 pip<br>    ln -s python3 python<br><br>%environment<br>    =
export PATH=3D/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin<=
br><br>#%runscript<br><br> <br>#%startscript<br><br><br>%test<br>    echo &=
quot;#################################&quot;<br>    echo &quot;redhat-relea=
se  =3D&gt; $(cat /etc/redhat-release)&quot;<br>    echo &quot;kernel versi=
on  =3D&gt; $(uname -r)&quot;<br>    echo &quot;PATH            =3D&gt; $PA=
TH&quot;<br>    echo &quot;python version  =3D&gt; $(python --version)&quot=
;<br>    echo &quot;pip version     =3D&gt; $(pip --version)&quot;<br>    e=
cho &quot;jupyter version =3D&gt; $(jupyter --version)&quot;<br>    echo &q=
uot;&quot;<br><br> <br>%labels<br>    Author bulldog<br><br></pre></div><di=
v>}<br></div></div></blockquote></div>

<p></p>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a rel=3D"nofollow">singu...@lbl.gov</a>.<br>
</blockquote></div>
</blockquote></div>

<p></p>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singu...@lbl.=
gov</a>.<br>
</blockquote></div>

<p></p>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singu...@lbl.=
gov</a>.<br>
</blockquote></div>

--0000000000005af4eb0581b6d768--
