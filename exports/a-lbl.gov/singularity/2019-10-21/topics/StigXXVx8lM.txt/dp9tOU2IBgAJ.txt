X-Received: by 10.176.16.20 with SMTP id f20mr9696905uab.6.1496765077660;
        Tue, 06 Jun 2017 09:04:37 -0700 (PDT)
X-BeenThere: singularity@lbl.gov
Received: by 10.107.181.200 with SMTP id e191ls928410iof.47.gmail; Tue, 06 Jun
 2017 09:04:36 -0700 (PDT)
X-Received: by 10.99.102.7 with SMTP id a7mr26617492pgc.216.1496765076546;
        Tue, 06 Jun 2017 09:04:36 -0700 (PDT)
ARC-Seal: i=1; a=rsa-sha256; t=1496765076; cv=none;
        d=google.com; s=arc-20160816;
        b=cXhvQHO7HMgSPV+Ud79vftNN0RGvZU0HLtz1C3Eb6iHPli2xFhcAw9/XjPVfBIIVxN
         HU0eOiCUAogxo4GvKUp0XxqxMSLfRisgba1nkYKpyvvj4WBo7wyz4yXRxjlPt0O82Ad6
         5gK3D6TwsC9xK9iAldYPd8RvYORjT2N3qVymxR3XSRr0Tzki/qynsTASno3bWpJSAg02
         dR0EMBgvfM5jCe8ZYdyb6li2tHGN8baLuZmZtwFqLL6ptqN1a+dECui4nHO3roNFl1iV
         FmaNo9H3b+amNWPaGvbNUX03c4UjltC8yqhW8d+CmqXg7sfIdN1eDfwmK2Uon53lOtAR
         Qr7w==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=in-reply-to:to:references:date:subject:mime-version:message-id:from
         :dkim-signature:arc-authentication-results;
        bh=pDHP2rZouo7F1BHz/6N3GKV20ddOenrvlHjrfoZupFY=;
        b=JJzXqxWmQa8NxbzbswkrG1HPp7N31ifVjt2uQSFiWEIhkPDenohQMN1NVgbQlptpud
         uirSKx0SNIjC1UpwR10TbVErU0ijQUKmG2BndflIuH3/TVIIvZF2VZR7JrArO0MXh6FF
         H8lzzW0MWM/o6Mgix0ojtqgQhwBeMUHgFuMeJJgBz4THczGGWT32aPKV44WgRaqr2bOl
         K83z8jid90Mg9GCe/wMeMoDJgV3RPvUWFkJWZvwzFwjNArZJpYuhA6IXdFDyW4Tac/Eq
         EfVISUU61xY18aGnGgDZkEZtlQW2M7G3Lp8fbkehRYDPUCZ3rpIMC6swOBWNy1QzVaXy
         8kFA==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=pass head...@fordham-edu.20150623.gappssmtp.com;
       spf=pass (google.com: domain of rku...@fordham.edu designates 209.85.216.173 as permitted sender) smtp.mailfrom=rku...@fordham.edu
Return-Path: <rku...@fordham.edu>
Received: from fe3.lbl.gov (fe3.lbl.gov. [128.3.41.68])
        by mx.google.com with ESMTP id y5si6273444pgb.85.2017.06.06.09.04.36
        for <singu...@lbl.gov>;
        Tue, 06 Jun 2017 09:04:36 -0700 (PDT)
Received-SPF: pass (google.com: domain of rku...@fordham.edu designates 209.85.216.173 as permitted sender) client-ip=209.85.216.173;
Authentication-Results: mx.google.com;
       dkim=pass head...@fordham-edu.20150623.gappssmtp.com;
       spf=pass (google.com: domain of rku...@fordham.edu designates 209.85.216.173 as permitted sender) smtp.mailfrom=rku...@fordham.edu
X-Ironport-SBRS: 3.4
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A2GDAAB70TZZhq3YVdFeGgEBAQECAQEBA?=
 =?us-ascii?q?QgBAQEBFQEBAQECAQEBAQgBAQEBgkQ8AoENgQ2DawicHYgqjVWBMQEbQAMBIAE?=
 =?us-ascii?q?JgXCECQKCY0EWAQEBAQEBAQEBAQECEAEBAQgLCwgoL4IzBQIDAh4EBEYhBgIDA?=
 =?us-ascii?q?QEBAQEBAQEBAQEgAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBCQI?=
 =?us-ascii?q?MAyAhAQEYAQEBAQIBGgkEGQEBDCAMBAsLGBYBCQEGAwICIRADAQUBCxEOBwQBG?=
 =?us-ascii?q?QECBIg3gToDDQcBBQugZz+LHWqBbDqDCQEBBYQwDUQBB4NmAQEBAQYBAQEBAQE?=
 =?us-ascii?q?BARgDBQkBCIZPgWArgWmBDIJYTkZPEgFJGwGCSTCCMYlFA4ZtgV2EdYZ3O4cmh?=
 =?us-ascii?q?ldcj1oQhnCLPoRbgwAzgRUmAXANMwswIQgdE0YSAYJhgVkqDxAMggBaAQEBBYc?=
 =?us-ascii?q?HDRcwgWkBAQE?=
X-IronPort-AV: E=Sophos;i="5.39,306,1493708400"; 
   d="scan'208,217";a="77669217"
Received: from mail-qt0-f173.google.com ([209.85.216.173])
  by fe3.lbl.gov with ESMTP; 06 Jun 2017 09:04:33 -0700
Received: by mail-qt0-f173.google.com with SMTP id u12so111797839qth.0
        for <singu...@lbl.gov>; Tue, 06 Jun 2017 09:04:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=fordham-edu.20150623.gappssmtp.com; s=20150623;
        h=from:message-id:mime-version:subject:date:references:to:in-reply-to;
        bh=pDHP2rZouo7F1BHz/6N3GKV20ddOenrvlHjrfoZupFY=;
        b=gnoUyGIeWlLvLjw6EV64eZ7bcxO3ZNKI1vIUHrLbh4G1STxbGqFWG30xXDmdn/sv6k
         jUtePrlqv9e79Oc2D21L+wApoMxn/HEonPZdeuL1Y+DAf3GjftSv6EpKy4LyAxmwL5wR
         iu4C9T2zyOUzSvffon6OgQ9FRcr+FkKwprKWAJcxA34DOi2D6SU/rU+0Tsze/epp/TIO
         re9TDDi5fUbG7NuApv2ZgcSlBvJRV+hit2HJT9QFSm1VVYKojMakFXM5d1sxEDhj6Rf+
         z03b+zcNKYidsMsnfYe1AmEHAEr7yFl0PWfgZ6bM30/04RciiQHSgKzQ8rG/h/NYbPI0
         5nUw==
X-Gm-Message-State: AODbwcDnWrTDvstIF2JCikTrSK8/qiLzNzgJoloUWEXyVYRUqnMNQYkf
	nlAo8WzNA1GGwDZEVboliQ==
X-Received: by 10.55.15.26 with SMTP id z26mr31962552qkg.114.1496765073309;
        Tue, 06 Jun 2017 09:04:33 -0700 (PDT)
Return-Path: <rku...@fordham.edu>
Received: from [10.10.1.22] (dax.cis.fordham.edu. [150.108.68.33])
        by smtp.gmail.com with ESMTPSA id 41sm10500008qtv.14.2017.06.06.09.04.32
        for <singu...@lbl.gov>
        (version=TLS1 cipher=ECDHE-RSA-AES128-SHA bits=128/128);
        Tue, 06 Jun 2017 09:04:32 -0700 (PDT)
From: Robert Kudyba <rku...@fordham.edu>
Content-Type: multipart/alternative; boundary="Apple-Mail=_E5ABD697-3CD4-4461-B078-280AF4072CC0"
Message-Id: <F920964C-A347-41C8-A231-12A9167A2546@fordham.edu>
Mime-Version: 1.0 (Mac OS X Mail 9.3 \(3124\))
Subject: Re: [Singularity] using Singularity to add Ubuntu to a NPACI Rocks Cluster node
Date: Tue, 6 Jun 2017 12:04:32 -0400
References: <eb2e5586-6bbb-4764-a155-83aea545ded0@lbl.gov> <CAM=pu+JNZw5WSspqPJhxfvVVa+W4CrUatPOFyJd02uNXK7QGsw@mail.gmail.com> <705AFBC5-ABBF-45AB-9A0A-F094AC0A7E07@fordham.edu> <CAM=pu+KwqfXQwbxYwZbAifx-rQjFgCoh-4KNwMPLaw8BD1xidg@mail.gmail.com> <C734A832-7C37-424C-BDA8-F3003A088C9A@fordham.edu> <6F6BCBDE-B10D-40F5-8D23-AB3470CA7DAA@gmail.com> <672F6430-4C6C-4A66-919B-A9C4E7FE4ECB@fordham.edu> <F0A18C08-400E-4362-AD1B-B9DA736F72AB@gmail.com> <59F05D2F-47A7-49BC-9F37-D16F845C159D@fordham.edu> <CAA6Bz=f=191vj-Mx29bsDtmt+vwHFp9E7wE9xse34ak762JxDQ@mail.gmail.com> <9CF6424D-BCDB-40E8-830C-81CE2F1C5538@fordham.edu> <CAA6Bz=eFXAstGLM8pm+p_PiaMvo8LNb=TGNJn82K+mLuM2BAFg@mail.gmail.com> <BDFE338B-2C36-4DE2-B94E-6AAB75FF2615@fordham.edu> <CAA6Bz=dKY7hicKNuGdea9YyHrd+n_cPTLuSS2SW2vb3xZspmug@mail.gmail.com>
To: singularity@lbl.gov
In-Reply-To: <CAA6Bz=dKY7hicKNuGdea9YyHrd+n_cPTLuSS2SW2vb3xZspmug@mail.gmail.com>
X-Mailer: Apple Mail (2.3124)

--Apple-Mail=_E5ABD697-3CD4-4461-B078-280AF4072CC0
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=utf-8

is this the correct usage of -w?

./singularity run -w /share/apps/ubuntu.simg=20
ERROR  : Could not open image /share/apps/ubuntu.simg: Permission denied
ABORT  : Retval =3D 255



> On Jun 6, 2017, at 11:18 AM, R=C3=A9my Dernat <rem...@gmail.com> wrote:
>=20
> I think you built your image on a machine with uid "426" which is not pre=
sent on the cluster, so, that's normal. You just have to enter in the conta=
iner with '-w' flag in root, and edit permissions on your runscript to fit =
your user on the cluster side.
>=20
> BTW, of course, normally, on Rocks, you had to build your image with:
> ```
> ./configure --prefix=3D/share/apps/singularity-install
> ```
> Instead of:
> ```
> ./configure --prefix=3D/export/apps/singularity-install
> ```
> Specially if some binaries contain the path of some files like singularit=
y.conf
> Sorry for this mistake.
>=20
> Best,
> R=C3=A9my
>=20
>=20
>=20
> 2017-06-06 16:55 GMT+02:00 Robert Kudyba <rku...@fordham.edu <mailto:rku.=
..@fordham.edu>>:
> I was able to delete everything except the var directory:=20
> rmdir session/
> rmdir: failed to remove `session/': Device or resource busy
> pwd
> /share/apps/var/singularity/mnt
>=20
> But deleting the source and recloning did get me further. On the head nod=
e I can run singularity commands. But again on the desired node we=E2=80=99=
d like to run this on we get this:
>=20
> ./singularity=20
> Error loading functions: /export/apps/singularity-install/libexec/singula=
rity/functions
>=20
> On the Rocks mailing list I as reminded to do this:
> "You need to reference singularity (or any app for that matter) as /share=
/apps and never /export/apps
>=20
> /export/apps only exists on the head node. "
>=20
> So the good news is once I redid everything to use /share/apps I was able=
 to get the singularity command to work on the compute node.
>=20
> So once I tried a command like: ./singularity run /share/apps/ubuntu.simg=
=20
> groups: cannot find name for group ID 426
>=20
> It looks like I=E2=80=99m in a shell:
> ls -l /singularity=20
> lrwxrwxrwx 1 root root 24 Jun  6 14:46 /singularity -> .singularity.d/run=
script
>=20
> But is that error/warning normal?
>=20
>=20
>> On Jun 6, 2017, at 10:01 AM, R=C3=A9my Dernat <rem...@gmail.com <mailto:=
rem...@gmail.com>> wrote:
>>=20
>> Hi,
>>=20
>> Try to remove every previous install and the install src directory. Then=
, logout/login and clone singularity again. Finally, build it from a clean =
environment.
>> Let us know if it solves your issue.
>>=20
>> Otherwise, it could be a bug. Try to create a symbolic link to configura=
tion file where it is searching (/etc/singularity/singularity.conf).
>>=20
>> Best regards,
>> R=C3=A9my
>>=20
>> 2017-06-06 15:51 GMT+02:00 Robert Kudyba <rku...@fordham.edu <mailto:rku=
...@fordham.edu>>:
>> OK I did that but still getting the bathing error about the conf file. I=
 did find a previous thread mentioning this https://groups.google.com/a/lbl=
.gov/forum/#!topic/singularity/mTPunMFQF4k <https://urldefense.proofpoint.c=
om/v2/url?u=3Dhttps-3A__groups.google.com_a_lbl.gov_forum_-23-21topic_singu=
larity_mTPunMFQF4k&d=3DDwMFaQ&c=3DaqMfXOEvEJQh2iQMCb7Wy8l0sPnURkcqADc2guUW8=
IM&r=3DX0jL9y0sL4r4iU_qVtR3lLNo4tOL1ry_m7-psV3GejY&m=3D6bH1ymxbi1sjYEf1b1I5=
mFgmrV6i74K8qBLXr92Gwts&s=3D8idh7dZXYflc0-GnBBay6ept9BXftZeazG5A09GHiNA&e=
=3D> but there=E2=80=99s no solution on how to point to an alternative loca=
tion, like a -c option. I updated the init file to add /export/apps/singula=
rity-install to the $PATH.
>>=20
>>=20
>> ./singularity --debug create /export/apps/ubuntu.simg
>> Enabling debugging
>> Ending argument loop
>> Singularity version: 2.3-master.gda9cd20
>> Exec'ing: /export/apps/singularity-install/libexec/singularity/cli/creat=
e.exec
>> VERBOSE [U=3D0,P=3D17149]      message_init()                           =
 Set messagelevel to: 5
>> VERBOSE [U=3D0,P=3D17149]      singularity_config_parse()               =
 Initialize configuration file: /etc/singularity/singularity.conf
>> ERROR   [U=3D0,P=3D17149]      singularity_config_parse()               =
 Specified configuration file /etc/singularity/singularity.conf does not ap=
pear to be a normal file.
>> ERROR   [U=3D0,P=3D17149]      singularity_config_parse()               =
 Could not open configuration file /etc/singularity/singularity.conf: No su=
ch file or directory
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_init()              =
 Initializing Singularity Registry
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()               =
 Adding value to registry: 'WRITABLE' =3D '1'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()               =
 Returning singularity_registry_set(WRITABLE, 1) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()               =
 Adding value to registry: 'LIBEXECDIR' =3D '/export/apps/singularity-insta=
ll/libexec'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()               =
 Returning singularity_registry_set(libexecdir, /export/apps/singularity-in=
stall/libexec) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()               =
 Adding value to registry: 'COMMAND' =3D 'create'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()               =
 Returning singularity_registry_set(COMMAND, create) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()               =
 Adding value to registry: 'MESSAGELEVEL' =3D '5'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()               =
 Returning singularity_registry_set(MESSAGELEVEL, 5) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()               =
 Adding value to registry: 'VERSION' =3D '2.3-master.gda9cd20'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()               =
 Returning singularity_registry_set(version, 2.3-master.gda9cd20) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()               =
 Adding value to registry: 'LOCALSTATEDIR' =3D '/export/apps/singularity-in=
stall/var'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()               =
 Returning singularity_registry_set(localstatedir, /export/apps/singularity=
-install/var) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()               =
 Adding value to registry: 'SYSCONFDIR' =3D '/export/apps/singularity-insta=
ll/etc'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()               =
 Returning singularity_registry_set(sysconfdir, /export/apps/singularity-in=
stall/etc) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()               =
 Adding value to registry: 'BINDIR' =3D '/export/apps/singularity-install/b=
in'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()               =
 Returning singularity_registry_set(bindir, /export/apps/singularity-instal=
l/bin) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()               =
 Adding value to registry: 'IMAGE' =3D '/export/apps/ubuntu.simg'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()               =
 Returning singularity_registry_set(IMAGE, /export/apps/ubuntu.simg) =3D 0
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_get()               =
 Returning NULL on 'HOME'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_get()               =
 Returning NULL on 'TARGET_UID'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_get()               =
 Returning NULL on 'TARGET_GID'
>> DEBUG   [U=3D0,P=3D17149]      singularity_priv_init()                  =
 Initializing user info
>> DEBUG   [U=3D0,P=3D17149]      singularity_priv_init()                  =
 Set the calling user's username to: root
>> DEBUG   [U=3D0,P=3D17149]      singularity_priv_init()                  =
 Marking uinfo structure as ready
>> DEBUG   [U=3D0,P=3D17149]      singularity_priv_init()                  =
 Obtaining home directory
>> VERBOSE [U=3D0,P=3D17149]      singularity_priv_init()                  =
 Set home (via getpwuid()) to: /root
>> VERBOSE [U=3D0,P=3D17149]      singularity_suid_init()                  =
 Running SUID program workflow
>> VERBOSE [U=3D0,P=3D17149]      singularity_suid_init()                  =
 Checking program has appropriate permissions
>> VERBOSE [U=3D0,P=3D17149]      singularity_suid_init()                  =
 Checking configuration file is properly owned by root
>> ABORT   [U=3D0,P=3D17149]      singularity_suid_init()                  =
 Running in privileged mode, root must own the Singularity configuration fi=
le: /etc/singularity/singularity.conf
>> ABORT   [U=3D0,P=3D17149]      singularity_suid_init()                  =
 Retval =3D 255
>>=20
>>=20
>>> On Jun 6, 2017, at 2:53 AM, R=C3=A9my Dernat <rem...@gmail.com <mailto:=
rem...@gmail.com>> wrote:
>>>=20
>>> Hi Robert,
>>>=20
>>> You just have to install singularity on a NFS export; Replace:
>>>=20
>>> ```
>>>  ./configure --prefix=3D/export/apps/singularity-install --sysconfdir=
=3D/etc
>>> ```
>>> With:
>>> ```
>>>  ./configure --prefix=3D/export/apps/singularity-install
>>> ```
>>>=20
>>> Then, it should works as expected.
>>>=20
>>> Do not forget that some singularity commands, like `bootstrap` in 2.3 o=
r many more in previous release need sudo/root privileges.
>>>=20
>>> Best regards,
>>> R=C3=A9my
>>>=20
>>> 2017-06-05 23:09 GMT+02:00 Robert Kudyba <rku...@fordham.edu <mailto:rk=
u...@fordham.edu>>:
>>>=20
>>>> On Jun 5, 2017, at 4:30 PM, Rick Wagner <richard...@gmail.com <mailto:=
richard...@gmail.com>> wrote:
>>>>=20
>>>>=20
>>>>> On Jun 5, 2017, at 4:13 PM, Robert Kudyba <rku...@fordham.edu <mailto=
:rku...@fordham.edu>> wrote:
>>>>>=20
>>>>>=20
>>>>>> On Jun 5, 2017, at 4:08 PM, Rick Wagner <richard...@gmail.com <mailt=
o:richard...@gmail.com>> wrote:
>>>>>>=20
>>>>>> Robert,
>>>>>>=20
>>>>>> That=E2=80=99s an NFS export for the Rocks head node that may be mou=
nted nosuid
>>>>>=20
>>>>> Right in /etc/fstab for other applications we already have this:
>>>>>=20
>>>>> UUID=3Dxxxxx /export                 ext4    defaults        1 2
>>>>>=20
>>>>> So what else needs to be done?
>>>>=20
>>>> One option is to build an RPM using the spec file in the Singularity r=
epo and put that in contrib for your Rocks distro along with a package tag =
in extend compute. That=E2=80=99s my preference because I don=E2=80=99t lik=
e serving applications over NFS, especially ones with setuid.
>>>>=20
>>>> WARNING: the following will allow any executable with a setuid bit in =
that NFS file system to be run.
>>>>=20
>>>> You can try changing defaults to defaults,suid and remounting the file=
 system on a compute node.
>>>=20
>>> Is this an =E2=80=9Cor=E2=80=9D suggestion? I don=E2=80=99t have a prob=
lem with changing the /etc/fstab. I did that and ran:
>>>   rocks sync config
>>>   rocks sync users
>>>=20
>>> Also made sure to use the config option as /share/apps (not /export/app=
s as that=E2=80=99s just for the head node)
>>>=20
>>> Still getting:
>>> /share/apps/bin
>>> ./singularity shell /share/apps/ubuntu.simg
>>> ERROR  : Session directory does not exist: /export/apps/var/singularity=
/mnt/session
>>> ABORT  : Retval =3D 255
>>>=20
>>> --=20
>>> You received this message because you are subscribed to the Google Grou=
ps "singularity" group.
>>> To unsubscribe from this group and stop receiving emails from it, send =
an email to singu...@lbl.gov <mailto:singu...@lbl.gov>.
>>>=20
>>>=20
>>> --=20
>>> You received this message because you are subscribed to the Google Grou=
ps "singularity" group.
>>> To unsubscribe from this group and stop receiving emails from it, send =
an email to singu...@lbl.gov <mailto:singu...@lbl.gov>.
>>=20
>>=20
>> --=20
>> You received this message because you are subscribed to the Google Group=
s "singularity" group.
>> To unsubscribe from this group and stop receiving emails from it, send a=
n email to singu...@lbl.gov <mailto:singu...@lbl.gov>.
>>=20
>>=20
>> --=20
>> You received this message because you are subscribed to the Google Group=
s "singularity" group.
>> To unsubscribe from this group and stop receiving emails from it, send a=
n email to singu...@lbl.gov <mailto:singu...@lbl.gov>.
>=20
>=20
> --=20
> You received this message because you are subscribed to the Google Groups=
 "singularity" group.
> To unsubscribe from this group and stop receiving emails from it, send an=
 email to singu...@lbl.gov <mailto:singu...@lbl.gov>.
>=20
>=20
> --=20
> You received this message because you are subscribed to the Google Groups=
 "singularity" group.
> To unsubscribe from this group and stop receiving emails from it, send an=
 email to singu...@lbl.gov <mailto:singu...@lbl.gov>.


--Apple-Mail=_E5ABD697-3CD4-4461-B078-280AF4072CC0
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html;
	charset=utf-8

<html><head><meta http-equiv=3D"Content-Type" content=3D"text/html charset=
=3Dutf-8"></head><body style=3D"word-wrap: break-word; -webkit-nbsp-mode: s=
pace; -webkit-line-break: after-white-space;" class=3D"">is this the correc=
t usage of -w?<div class=3D""><br class=3D""></div><div class=3D""><div sty=
le=3D"margin: 0px; font-size: 10px; line-height: normal; font-family: Menlo=
;" class=3D""><span style=3D"font-variant-ligatures: no-common-ligatures" c=
lass=3D"">./singularity run -w /share/apps/ubuntu.simg&nbsp;</span></div><d=
iv style=3D"margin: 0px; font-size: 10px; line-height: normal; font-family:=
 Menlo; color: rgb(255, 59, 29);" class=3D""><span style=3D"font-variant-li=
gatures: no-common-ligatures" class=3D"">ERROR&nbsp; : Could not open image=
 /share/apps/ubuntu.simg: Permission denied</span></div><div style=3D"margi=
n: 0px; font-size: 10px; line-height: normal; font-family: Menlo; color: rg=
b(195, 55, 32);" class=3D""><span style=3D"font-variant-ligatures: no-commo=
n-ligatures" class=3D"">ABORT&nbsp; : Retval =3D 255</span></div><div class=
=3D""><span style=3D"font-variant-ligatures: no-common-ligatures" class=3D"=
"><br class=3D""></span></div><div class=3D""><span style=3D"font-variant-l=
igatures: no-common-ligatures" class=3D""><br class=3D""></span></div><div =
class=3D""><span style=3D"font-variant-ligatures: no-common-ligatures" clas=
s=3D""><br class=3D""></span></div><div style=3D""><blockquote type=3D"cite=
" class=3D""><div class=3D"">On Jun 6, 2017, at 11:18 AM, R=C3=A9my Dernat =
&lt;<a href=3D"mailto:rem...@gmail.com" class=3D"">rem...@gmail.com</a>&gt;=
 wrote:</div><br class=3D"Apple-interchange-newline"><div class=3D""><div d=
ir=3D"ltr" class=3D"">I think you built your image on a machine with uid "4=
26" which is not present on the cluster, so, that's normal. You just have t=
o enter in the container with '-w' flag in root, and edit permissions on yo=
ur runscript to fit your user on the cluster side.<div class=3D""><br class=
=3D""></div><div class=3D"">BTW, of course, normally, on Rocks, you had to =
build your image with:</div><div class=3D"">```</div><div class=3D""><span =
style=3D"font-family:Menlo;font-size:10px;font-variant-ligatures:no-common-=
ligatures" class=3D"">./configure --prefix=3D/share/apps/singular</span><wb=
r style=3D"font-family:Menlo;font-size:10px;font-variant-ligatures:no-commo=
n-ligatures" class=3D""><span style=3D"font-family:Menlo;font-size:10px;fon=
t-variant-ligatures:no-common-ligatures" class=3D"">ity-install</span><br c=
lass=3D""></div><div class=3D"">```</div><div class=3D"">Instead of:</div><=
div class=3D""><div class=3D"">```</div><div class=3D""><span style=3D"font=
-family:Menlo;font-size:10px;font-variant-ligatures:no-common-ligatures" cl=
ass=3D"">./configure --prefix=3D/export/apps/singular</span><wbr style=3D"f=
ont-family:Menlo;font-size:10px;font-variant-ligatures:no-common-ligatures"=
 class=3D""><span style=3D"font-family:Menlo;font-size:10px;font-variant-li=
gatures:no-common-ligatures" class=3D"">ity-install</span><br class=3D""></=
div><div class=3D"">```</div></div><div class=3D"">Specially if some binari=
es contain the path of some files like singularity.conf</div><div class=3D"=
">Sorry for this mistake.<br class=3D""></div><div class=3D""><br class=3D"=
"></div><div class=3D"">Best,</div><div class=3D"">R=C3=A9my</div><div clas=
s=3D""><br class=3D""></div><div class=3D""><br class=3D""></div></div><div=
 class=3D"gmail_extra"><br class=3D""><div class=3D"gmail_quote">2017-06-06=
 16:55 GMT+02:00 Robert Kudyba <span dir=3D"ltr" class=3D"">&lt;<a href=3D"=
mailto:rku...@fordham.edu" target=3D"_blank" class=3D"">rku...@fordham.edu<=
/a>&gt;</span>:<br class=3D""><blockquote class=3D"gmail_quote" style=3D"ma=
rgin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div style=3D"=
word-wrap:break-word" class=3D""><div class=3D"">I was able to delete every=
thing except the var directory:&nbsp;</div><div class=3D""><div style=3D"ma=
rgin:0px;font-size:10px;line-height:normal;font-family:Menlo" class=3D""><s=
pan style=3D"font-variant-ligatures:no-common-ligatures" class=3D"">rmdir s=
ession/</span></div><div style=3D"margin:0px;font-size:10px;line-height:nor=
mal;font-family:Menlo" class=3D""><span style=3D"font-variant-ligatures:no-=
common-ligatures" class=3D"">rmdir: failed to remove `session/': Device or =
resource busy</span></div><div style=3D"margin:0px;font-size:10px;line-heig=
ht:normal;font-family:Menlo" class=3D""><span style=3D"font-variant-ligatur=
es:no-common-ligatures" class=3D"">pwd</span></div><div style=3D"margin:0px=
;font-size:10px;line-height:normal;font-family:Menlo" class=3D""><span styl=
e=3D"font-variant-ligatures:no-common-ligatures" class=3D"">/share/apps/var=
/singularity/<wbr class=3D"">mnt</span></div></div><div class=3D""><span st=
yle=3D"font-variant-ligatures:no-common-ligatures" class=3D""><br class=3D"=
"></span></div><div class=3D"">But deleting the source and recloning did ge=
t me further. On the head node I can run singularity commands. But again on=
 the desired node we=E2=80=99d like to run this on we get this:</div><div c=
lass=3D""><br class=3D""></div><div class=3D""><div style=3D"margin:0px;fon=
t-size:10px;line-height:normal;font-family:Menlo" class=3D""><span style=3D=
"font-variant-ligatures:no-common-ligatures" class=3D"">./singularity&nbsp;=
</span></div><div style=3D"margin:0px;font-size:10px;line-height:normal;fon=
t-family:Menlo" class=3D""><span style=3D"font-variant-ligatures:no-common-=
ligatures" class=3D"">Error loading functions: /export/apps/singularity-<wb=
r class=3D"">install/libexec/singularity/<wbr class=3D"">functions</span></=
div></div><div class=3D""><br class=3D""></div><div class=3D"">On the Rocks=
 mailing list I as reminded to do this:</div><div class=3D"">"You need to r=
eference singularity (or any app for that matter) as /share/apps and never =
/export/apps<br class=3D""><br class=3D"">/export/apps only exists on the h=
ead node. "</div><div class=3D""><br class=3D""></div><div class=3D"">So th=
e good news is once I redid everything to use /share/apps I was able to get=
 the singularity command to work on the compute node.</div><div class=3D"">=
<br class=3D""></div><div class=3D"">So once I tried a command like:&nbsp;<=
span style=3D"font-family:Menlo;font-size:10px" class=3D"">./singularity ru=
n /share/apps/ubuntu.simg</span><span style=3D"font-family:Menlo;font-size:=
10px" class=3D"">&nbsp;</span></div><div style=3D"margin:0px;font-size:10px=
;line-height:normal;font-family:Menlo" class=3D""><span style=3D"font-varia=
nt-ligatures:no-common-ligatures" class=3D"">groups: cannot find name for g=
roup ID 426</span></div><div class=3D""><br class=3D""></div><div class=3D"=
">It looks like I=E2=80=99m in a shell:</div><div class=3D""><div style=3D"=
margin:0px;font-size:10px;line-height:normal;font-family:Menlo" class=3D"">=
<span style=3D"font-variant-ligatures:no-common-ligatures" class=3D"">ls -l=
 /singularity&nbsp;</span></div><div style=3D"margin:0px;font-size:10px;lin=
e-height:normal;font-family:Menlo" class=3D""><span style=3D"font-variant-l=
igatures:no-common-ligatures" class=3D"">lrwxrwxrwx 1 root root 24 Jun&nbsp=
; 6 14:46 /singularity -&gt; .singularity.d/runscript</span></div></div><di=
v class=3D""><br class=3D""></div><div class=3D"">But is that error/warning=
 normal?</div><div class=3D""><div class=3D"h5"><div class=3D""><br class=
=3D""></div><br class=3D""><div class=3D""><blockquote type=3D"cite" class=
=3D""><div class=3D"">On Jun 6, 2017, at 10:01 AM, R=C3=A9my Dernat &lt;<a =
href=3D"mailto:rem...@gmail.com" target=3D"_blank" class=3D"">rem...@gmail.=
com</a>&gt; wrote:</div><br class=3D"m_-672932233201048330Apple-interchange=
-newline"><div class=3D""><div dir=3D"ltr" class=3D"">Hi,<div class=3D""><b=
r class=3D""></div><div class=3D"">Try to remove every previous install and=
 the install src directory. Then, logout/login and clone singularity again.=
 Finally, build it from a clean environment.</div><div class=3D"">Let us kn=
ow if it solves your issue.</div><div class=3D""><br class=3D""></div><div =
class=3D"">Otherwise, it could be a bug. Try to create a symbolic link to c=
onfiguration file where it is searching (/etc/singularity/singularity.<wbr =
class=3D"">conf).</div><div class=3D""><br class=3D""></div><div class=3D""=
>Best regards,</div><div class=3D"">R=C3=A9my</div></div><div class=3D"gmai=
l_extra"><br class=3D""><div class=3D"gmail_quote">2017-06-06 15:51 GMT+02:=
00 Robert Kudyba <span dir=3D"ltr" class=3D"">&lt;<a href=3D"mailto:rku...@=
fordham.edu" target=3D"_blank" class=3D"">rku...@fordham.edu</a>&gt;</span>=
:<br class=3D""><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8e=
x;border-left:1px #ccc solid;padding-left:1ex"><div style=3D"word-wrap:brea=
k-word" class=3D""><div class=3D"">OK I did that but still getting the bath=
ing error about the conf file. I did find a previous thread mentioning this=
&nbsp;<a href=3D"https://urldefense.proofpoint.com/v2/url?u=3Dhttps-3A__gro=
ups.google.com_a_lbl.gov_forum_-23-21topic_singularity_mTPunMFQF4k&amp;d=3D=
DwMFaQ&amp;c=3DaqMfXOEvEJQh2iQMCb7Wy8l0sPnURkcqADc2guUW8IM&amp;r=3DX0jL9y0s=
L4r4iU_qVtR3lLNo4tOL1ry_m7-psV3GejY&amp;m=3D6bH1ymxbi1sjYEf1b1I5mFgmrV6i74K=
8qBLXr92Gwts&amp;s=3D8idh7dZXYflc0-GnBBay6ept9BXftZeazG5A09GHiNA&amp;e=3D" =
target=3D"_blank" class=3D"">https://groups.google.com<wbr class=3D"">/a/lb=
l.gov/forum/#!topic/singu<wbr class=3D"">larity/mTPunMFQF4k</a>&nbsp;but th=
ere=E2=80=99s no solution on how to point to an alternative location, like =
a -c option. I updated the init file to add /export/apps/singularity-insta<=
wbr class=3D"">ll to the $PATH.</div><div class=3D""><br class=3D""></div><=
div class=3D""><br class=3D""></div><div class=3D""><div style=3D"margin:0p=
x;font-size:10px;line-height:normal;font-family:Menlo" class=3D""><span sty=
le=3D"font-variant-ligatures:no-common-ligatures" class=3D"">./singularity =
--debug create /export/apps/ubuntu.simg</span></div><div style=3D"margin:0p=
x;font-size:10px;line-height:normal;font-family:Menlo" class=3D""><span sty=
le=3D"font-variant-ligatures:no-common-ligatures" class=3D"">Enabling debug=
ging</span></div><div style=3D"margin:0px;font-size:10px;line-height:normal=
;font-family:Menlo" class=3D""><span style=3D"font-variant-ligatures:no-com=
mon-ligatures" class=3D"">Ending argument loop</span></div><div style=3D"ma=
rgin:0px;font-size:10px;line-height:normal;font-family:Menlo" class=3D""><s=
pan style=3D"font-variant-ligatures:no-common-ligatures" class=3D"">Singula=
rity version: 2.3-master.gda9cd20</span></div><div style=3D"margin:0px;font=
-size:10px;line-height:normal;font-family:Menlo" class=3D""><span style=3D"=
font-variant-ligatures:no-common-ligatures" class=3D"">Exec'ing: /export/ap=
ps/singularity-insta<wbr class=3D"">ll/libexec/singularity/cli/<wbr class=
=3D"">create.exec</span></div><div style=3D"margin:0px;font-size:10px;line-=
height:normal;font-family:Menlo" class=3D""><span style=3D"font-variant-lig=
atures:no-common-ligatures" class=3D"">VERBOSE [U=3D0,P=3D17149]&nbsp; &nbs=
p; &nbsp; message_init()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set messagelevel to: 5</span=
></div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-fami=
ly:Menlo" class=3D""><span style=3D"font-variant-ligatures:no-common-ligatu=
res" class=3D"">VERBOSE [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_c=
onfig_parse()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Initia=
lize configuration file: /etc/singularity/singularity.c<wbr class=3D"">onf<=
/span></div><div style=3D"margin:0px;font-size:10px;line-height:normal;font=
-family:Menlo;color:rgb(255,59,29)" class=3D""><span style=3D"font-variant-=
ligatures:no-common-ligatures" class=3D"">ERROR &nbsp; [U=3D0,P=3D17149]&nb=
sp; &nbsp; &nbsp; singularity_config_parse()&nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; Specified configuration file /etc/singularity/sing=
ularity.c<wbr class=3D"">onf does not appear to be a normal file.</span></d=
iv><div style=3D"margin:0px;font-size:10px;line-height:normal;font-family:M=
enlo;color:rgb(255,59,29)" class=3D""><span style=3D"font-variant-ligatures=
:no-common-ligatures" class=3D"">ERROR &nbsp; [U=3D0,P=3D17149]&nbsp; &nbsp=
; &nbsp; singularity_config_parse()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; Could not open configuration file /etc/singularity/singular=
ity.c<wbr class=3D"">onf: No such file or directory</span></div><div style=
=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo" class=
=3D""><span style=3D"font-variant-ligatures:no-common-ligatures" class=3D""=
>VERBOSE [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_registry_init() =
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Initializing Singularity R=
egistry</span></div><div style=3D"margin:0px;font-size:10px;line-height:nor=
mal;font-family:Menlo" class=3D""><span style=3D"font-variant-ligatures:no-=
common-ligatures" class=3D"">VERBOSE [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; =
singularity_registry_set()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =
&nbsp; Adding value to registry: 'WRITABLE' =3D '1'</span></div><div style=
=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo" class=
=3D""><span style=3D"font-variant-ligatures:no-common-ligatures" class=3D""=
>DEBUG &nbsp; [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_registry_se=
t()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Returning singul=
arity_registry_set(WRITA<wbr class=3D"">BLE, 1) =3D 0</span></div><div styl=
e=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo" class=
=3D""><span style=3D"font-variant-ligatures:no-common-ligatures" class=3D""=
>VERBOSE [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_registry_set()&n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Adding value to regis=
try: 'LIBEXECDIR' =3D '/export/apps/singularity-inst<wbr class=3D"">all/lib=
exec'</span></div><div style=3D"margin:0px;font-size:10px;line-height:norma=
l;font-family:Menlo" class=3D""><span style=3D"font-variant-ligatures:no-co=
mmon-ligatures" class=3D"">DEBUG &nbsp; [U=3D0,P=3D17149]&nbsp; &nbsp; &nbs=
p; singularity_registry_set()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; Returning singularity_registry_set(libex<wbr class=3D"">ecdir, /e=
xport/apps/singularity-insta<wbr class=3D"">ll/libexec) =3D 0</span></div><=
div style=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo=
" class=3D""><span style=3D"font-variant-ligatures:no-common-ligatures" cla=
ss=3D"">VERBOSE [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_registry_=
set()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Adding value t=
o registry: 'COMMAND' =3D 'create'</span></div><div style=3D"margin:0px;fon=
t-size:10px;line-height:normal;font-family:Menlo" class=3D""><span style=3D=
"font-variant-ligatures:no-common-ligatures" class=3D"">DEBUG &nbsp; [U=3D0=
,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_registry_set()&nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Returning singularity_registry_set(C=
OMMA<wbr class=3D"">ND, create) =3D 0</span></div><div style=3D"margin:0px;=
font-size:10px;line-height:normal;font-family:Menlo" class=3D""><span style=
=3D"font-variant-ligatures:no-common-ligatures" class=3D"">VERBOSE [U=3D0,P=
=3D17149]&nbsp; &nbsp; &nbsp; singularity_registry_set()&nbsp; &nbsp; &nbsp=
; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Adding value to registry: 'MESSAGELEVE=
L' =3D '5'</span></div><div style=3D"margin:0px;font-size:10px;line-height:=
normal;font-family:Menlo" class=3D""><span style=3D"font-variant-ligatures:=
no-common-ligatures" class=3D"">DEBUG &nbsp; [U=3D0,P=3D17149]&nbsp; &nbsp;=
 &nbsp; singularity_registry_set()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; Returning singularity_registry_set(MESSA<wbr class=3D"">GELE=
VEL, 5) =3D 0</span></div><div style=3D"margin:0px;font-size:10px;line-heig=
ht:normal;font-family:Menlo" class=3D""><span style=3D"font-variant-ligatur=
es:no-common-ligatures" class=3D"">VERBOSE [U=3D0,P=3D17149]&nbsp; &nbsp; &=
nbsp; singularity_registry_set()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; Adding value to registry: 'VERSION' =3D '2.3-master.gda9cd20'<=
/span></div><div style=3D"margin:0px;font-size:10px;line-height:normal;font=
-family:Menlo" class=3D""><span style=3D"font-variant-ligatures:no-common-l=
igatures" class=3D"">DEBUG &nbsp; [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; sin=
gularity_registry_set()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; Returning singularity_registry_set(versi<wbr class=3D"">on, 2.3-master.=
gda9cd20) =3D 0</span></div><div style=3D"margin:0px;font-size:10px;line-he=
ight:normal;font-family:Menlo" class=3D""><span style=3D"font-variant-ligat=
ures:no-common-ligatures" class=3D"">VERBOSE [U=3D0,P=3D17149]&nbsp; &nbsp;=
 &nbsp; singularity_registry_set()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=
 &nbsp; &nbsp; Adding value to registry: 'LOCALSTATEDIR' =3D '/export/apps/=
singularity-inst<wbr class=3D"">all/var'</span></div><div style=3D"margin:0=
px;font-size:10px;line-height:normal;font-family:Menlo" class=3D""><span st=
yle=3D"font-variant-ligatures:no-common-ligatures" class=3D"">DEBUG &nbsp; =
[U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_registry_set()&nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Returning singularity_registry=
_set(local<wbr class=3D"">statedir, /export/apps/singularity-insta<wbr clas=
s=3D"">ll/var) =3D 0</span></div><div style=3D"margin:0px;font-size:10px;li=
ne-height:normal;font-family:Menlo" class=3D""><span style=3D"font-variant-=
ligatures:no-common-ligatures" class=3D"">VERBOSE [U=3D0,P=3D17149]&nbsp; &=
nbsp; &nbsp; singularity_registry_set()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; &nbsp; Adding value to registry: 'SYSCONFDIR' =3D '/export/app=
s/singularity-inst<wbr class=3D"">all/etc'</span></div><div style=3D"margin=
:0px;font-size:10px;line-height:normal;font-family:Menlo" class=3D""><span =
style=3D"font-variant-ligatures:no-common-ligatures" class=3D"">DEBUG &nbsp=
; [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_registry_set()&nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Returning singularity_regist=
ry_set(sysco<wbr class=3D"">nfdir, /export/apps/singularity-insta<wbr class=
=3D"">ll/etc) =3D 0</span></div><div style=3D"margin:0px;font-size:10px;lin=
e-height:normal;font-family:Menlo" class=3D""><span style=3D"font-variant-l=
igatures:no-common-ligatures" class=3D"">VERBOSE [U=3D0,P=3D17149]&nbsp; &n=
bsp; &nbsp; singularity_registry_set()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; Adding value to registry: 'BINDIR' =3D '/export/apps/sin=
gularity-inst<wbr class=3D"">all/bin'</span></div><div style=3D"margin:0px;=
font-size:10px;line-height:normal;font-family:Menlo" class=3D""><span style=
=3D"font-variant-ligatures:no-common-ligatures" class=3D"">DEBUG &nbsp; [U=
=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_registry_set()&nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Returning singularity_registry_s=
et(bindi<wbr class=3D"">r, /export/apps/singularity-insta<wbr class=3D"">ll=
/bin) =3D 0</span></div><div style=3D"margin:0px;font-size:10px;line-height=
:normal;font-family:Menlo" class=3D""><span style=3D"font-variant-ligatures=
:no-common-ligatures" class=3D"">VERBOSE [U=3D0,P=3D17149]&nbsp; &nbsp; &nb=
sp; singularity_registry_set()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; Adding value to registry: 'IMAGE' =3D '/export/apps/ubuntu.simg'=
</span></div><div style=3D"margin:0px;font-size:10px;line-height:normal;fon=
t-family:Menlo" class=3D""><span style=3D"font-variant-ligatures:no-common-=
ligatures" class=3D"">DEBUG &nbsp; [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; si=
ngularity_registry_set()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; Returning singularity_registry_set(IMAGE<wbr class=3D"">, /export/apps=
/ubuntu.simg) =3D 0</span></div><div style=3D"margin:0px;font-size:10px;lin=
e-height:normal;font-family:Menlo" class=3D""><span style=3D"font-variant-l=
igatures:no-common-ligatures" class=3D"">DEBUG &nbsp; [U=3D0,P=3D17149]&nbs=
p; &nbsp; &nbsp; singularity_registry_get()&nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; Returning NULL on 'HOME'</span></div><div style=3D"=
margin:0px;font-size:10px;line-height:normal;font-family:Menlo" class=3D"">=
<span style=3D"font-variant-ligatures:no-common-ligatures" class=3D"">DEBUG=
 &nbsp; [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_registry_get()&nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Returning NULL on 'TAR=
GET_UID'</span></div><div style=3D"margin:0px;font-size:10px;line-height:no=
rmal;font-family:Menlo" class=3D""><span style=3D"font-variant-ligatures:no=
-common-ligatures" class=3D"">DEBUG &nbsp; [U=3D0,P=3D17149]&nbsp; &nbsp; &=
nbsp; singularity_registry_get()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &=
nbsp; &nbsp; Returning NULL on 'TARGET_GID'</span></div><div style=3D"margi=
n:0px;font-size:10px;line-height:normal;font-family:Menlo" class=3D""><span=
 style=3D"font-variant-ligatures:no-common-ligatures" class=3D"">DEBUG &nbs=
p; [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_priv_init() &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Initializing user info=
</span></div><div style=3D"margin:0px;font-size:10px;line-height:normal;fon=
t-family:Menlo" class=3D""><span style=3D"font-variant-ligatures:no-common-=
ligatures" class=3D"">DEBUG &nbsp; [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; si=
ngularity_priv_init() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; Set the calling user's username to: root</span></div><div style=
=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo" class=
=3D""><span style=3D"font-variant-ligatures:no-common-ligatures" class=3D""=
>DEBUG &nbsp; [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_priv_init()=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Marking uin=
fo structure as ready</span></div><div style=3D"margin:0px;font-size:10px;l=
ine-height:normal;font-family:Menlo" class=3D""><span style=3D"font-variant=
-ligatures:no-common-ligatures" class=3D"">DEBUG &nbsp; [U=3D0,P=3D17149]&n=
bsp; &nbsp; &nbsp; singularity_priv_init() &nbsp; &nbsp; &nbsp; &nbsp; &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; Obtaining home directory</span></div><div st=
yle=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo" clas=
s=3D""><span style=3D"font-variant-ligatures:no-common-ligatures" class=3D"=
">VERBOSE [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_priv_init() &nb=
sp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set home (via g=
etpwuid()) to: /root</span></div><div style=3D"margin:0px;font-size:10px;li=
ne-height:normal;font-family:Menlo" class=3D""><span style=3D"font-variant-=
ligatures:no-common-ligatures" class=3D"">VERBOSE [U=3D0,P=3D17149]&nbsp; &=
nbsp; &nbsp; singularity_suid_init() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nb=
sp; &nbsp; &nbsp; &nbsp; Running SUID program workflow</span></div><div sty=
le=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo" class=
=3D""><span style=3D"font-variant-ligatures:no-common-ligatures" class=3D""=
>VERBOSE [U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_suid_init() &nbs=
p; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Checking program=
 has appropriate permissions</span></div><div style=3D"margin:0px;font-size=
:10px;line-height:normal;font-family:Menlo" class=3D""><span style=3D"font-=
variant-ligatures:no-common-ligatures" class=3D"">VERBOSE [U=3D0,P=3D17149]=
&nbsp; &nbsp; &nbsp; singularity_suid_init() &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; &nbsp; &nbsp; &nbsp; Checking configuration file is properly ow=
ned by root</span></div><div style=3D"margin:0px;font-size:10px;line-height=
:normal;font-family:Menlo;color:rgb(195,55,32)" class=3D""><span style=3D"f=
ont-variant-ligatures:no-common-ligatures" class=3D"">ABORT &nbsp; [U=3D0,P=
=3D17149]&nbsp; &nbsp; &nbsp; singularity_suid_init() &nbsp; &nbsp; &nbsp; =
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Running in privileged mode, root =
must own the Singularity configuration file: /etc/singularity/singularity.c=
<wbr class=3D"">onf</span></div><div style=3D"margin:0px;font-size:10px;lin=
e-height:normal;font-family:Menlo;color:rgb(195,55,32)" class=3D""><span st=
yle=3D"font-variant-ligatures:no-common-ligatures" class=3D"">ABORT &nbsp; =
[U=3D0,P=3D17149]&nbsp; &nbsp; &nbsp; singularity_suid_init() &nbsp; &nbsp;=
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Retval =3D 255</span></di=
v></div><div class=3D""><div class=3D"m_-672932233201048330h5"><div class=
=3D""><span style=3D"font-variant-ligatures:no-common-ligatures" class=3D""=
><br class=3D""></span></div><br class=3D""><div class=3D""><blockquote typ=
e=3D"cite" class=3D""><div class=3D"">On Jun 6, 2017, at 2:53 AM, R=C3=A9my=
 Dernat &lt;<a href=3D"mailto:rem...@gmail.com" target=3D"_blank" class=3D"=
">rem...@gmail.com</a>&gt; wrote:</div><br class=3D"m_-672932233201048330m_=
9141356409832340507Apple-interchange-newline"><div class=3D""><div dir=3D"l=
tr" class=3D"">Hi Robert,<div class=3D""><br class=3D""></div><div class=3D=
"">You just have to install singularity on a NFS export; Replace:</div><div=
 class=3D""><br class=3D""></div><div class=3D"">```</div><div class=3D""><=
span style=3D"font-variant-ligatures:no-common-ligatures;font-family:Menlo;=
font-size:10px" class=3D"">&nbsp;</span><span style=3D"font-variant-ligatur=
es:no-common-ligatures;font-family:Menlo;font-size:10px" class=3D"">./confi=
gure --prefix=3D/export/apps/singular<wbr class=3D"">ity-install --sysconfd=
ir=3D/etc</span><br class=3D""></div><div class=3D"">```</div><div class=3D=
"">With:</div><div class=3D"">```</div><div class=3D""><span style=3D"font-=
variant-ligatures:no-common-ligatures;font-family:Menlo;font-size:10px" cla=
ss=3D"">&nbsp;</span><span style=3D"font-variant-ligatures:no-common-ligatu=
res;font-family:Menlo;font-size:10px" class=3D"">./configure --prefix=3D/ex=
port/apps/singular<wbr class=3D"">ity-install</span><br class=3D""></div><d=
iv class=3D"">```</div><div class=3D""><br class=3D""></div><div class=3D""=
>Then, it should works as expected.</div><div class=3D""><br class=3D""></d=
iv><div class=3D"">Do not forget that some singularity commands, like `boot=
strap` in 2.3 or many more in previous release need sudo/root privileges.</=
div><div class=3D""><br class=3D""></div><div class=3D"">Best regards,<br c=
lass=3D"">R=C3=A9my</div></div><div class=3D"gmail_extra"><br class=3D""><d=
iv class=3D"gmail_quote">2017-06-05 23:09 GMT+02:00 Robert Kudyba <span dir=
=3D"ltr" class=3D"">&lt;<a href=3D"mailto:rku...@fordham.edu" target=3D"_bl=
ank" class=3D"">rku...@fordham.edu</a>&gt;</span>:<br class=3D""><blockquot=
e class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc sol=
id;padding-left:1ex"><div style=3D"word-wrap:break-word" class=3D""><span c=
lass=3D""><br class=3D""><div class=3D""><blockquote type=3D"cite" class=3D=
""><div class=3D"">On Jun 5, 2017, at 4:30 PM, Rick Wagner &lt;<a href=3D"m=
ailto:richard...@gmail.com" target=3D"_blank" class=3D"">richard...@gmail.c=
om</a>&gt; wrote:</div><br class=3D"m_-672932233201048330m_9141356409832340=
507m_-5619588665609687384Apple-interchange-newline"><div class=3D""><div st=
yle=3D"word-wrap:break-word" class=3D""><br class=3D""><div class=3D""><blo=
ckquote type=3D"cite" class=3D""><div class=3D"">On Jun 5, 2017, at 4:13 PM=
, Robert Kudyba &lt;<a href=3D"mailto:rku...@fordham.edu" target=3D"_blank"=
 class=3D"">rku...@fordham.edu</a>&gt; wrote:</div><br class=3D"m_-67293223=
3201048330m_9141356409832340507m_-5619588665609687384Apple-interchange-newl=
ine"><div class=3D""><div style=3D"word-wrap:break-word" class=3D""><br cla=
ss=3D""><div class=3D""><blockquote type=3D"cite" class=3D""><div class=3D"=
">On Jun 5, 2017, at 4:08 PM, Rick Wagner &lt;<a href=3D"mailto:richard...@=
gmail.com" target=3D"_blank" class=3D"">richard...@gmail.com</a>&gt; wrote:=
</div><br class=3D"m_-672932233201048330m_9141356409832340507m_-56195886656=
09687384Apple-interchange-newline"><div class=3D""><div style=3D"word-wrap:=
break-word" class=3D""><div class=3D"">Robert,</div><div class=3D""><br cla=
ss=3D""></div><div class=3D"">That=E2=80=99s an NFS export for the Rocks he=
ad node that may be mounted nosuid</div></div></div></blockquote><br class=
=3D""></div><div class=3D"">Right in /etc/fstab for other applications we a=
lready have this:</div><div class=3D""><br class=3D""></div><div class=3D""=
><div style=3D"margin:0px;font-size:10px;line-height:normal;font-family:Men=
lo" class=3D""><span style=3D"font-variant-ligatures:no-common-ligatures" c=
lass=3D"">UUID=3Dxxxxx /export &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &n=
bsp; &nbsp; ext4&nbsp; &nbsp; defaults&nbsp; &nbsp; &nbsp; &nbsp; 1 2</span=
></div><div class=3D""><span style=3D"font-variant-ligatures:no-common-liga=
tures" class=3D""><br class=3D""></span></div></div>So what else needs to b=
e done?</div></div></blockquote><div class=3D""><br class=3D""></div><div c=
lass=3D"">One option is to build an RPM using the spec file in the Singular=
ity repo and put that in contrib for your Rocks distro along with a package=
 tag in extend compute. That=E2=80=99s my preference because I don=E2=80=99=
t like serving applications over NFS, especially ones with setuid.</div><di=
v class=3D""><br class=3D""></div><div class=3D"">WARNING: the following wi=
ll allow any executable with a setuid bit in that NFS file system to be run=
.</div><div class=3D""><br class=3D""></div><div class=3D"">You can try cha=
nging defaults to defaults,suid and remounting the file system on a compute=
 node.</div></div></div></div></blockquote><br class=3D""></div></span><div=
 class=3D"">Is this an =E2=80=9Cor=E2=80=9D suggestion? I don=E2=80=99t hav=
e a problem with changing the /etc/fstab. I did that and ran:</div><div cla=
ss=3D""><div style=3D"margin:0px;font-size:10px;line-height:normal;font-fam=
ily:Menlo" class=3D""><span style=3D"font-variant-ligatures:no-common-ligat=
ures" class=3D"">&nbsp;&nbsp;rocks sync config</span></div><div style=3D"ma=
rgin:0px;font-size:10px;line-height:normal;font-family:Menlo" class=3D""><s=
pan style=3D"font-variant-ligatures:no-common-ligatures" class=3D"">&nbsp; =
rocks sync users</span></div><div style=3D"margin:0px;font-size:10px;line-h=
eight:normal;font-family:Menlo" class=3D""><br class=3D""></div></div>Also =
made sure to use the config option as /share/apps (not /export/apps as that=
=E2=80=99s just for the head node)<div class=3D""><br class=3D""></div><div=
 class=3D"">Still getting:</div><div class=3D""><div class=3D""><div style=
=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo" class=
=3D""><span style=3D"font-variant-ligatures:no-common-ligatures" class=3D""=
>/share/apps/bin</span></div></div><div class=3D""><div style=3D"margin:0px=
;font-size:10px;line-height:normal;font-family:Menlo" class=3D""><div style=
=3D"margin:0px;line-height:normal" class=3D""><span style=3D"font-variant-l=
igatures:no-common-ligatures" class=3D"">./singularity shell /share/apps/ub=
untu.simg</span></div><span class=3D""><div style=3D"margin:0px;line-height=
:normal;color:rgb(255,59,29)" class=3D""><span style=3D"font-variant-ligatu=
res:no-common-ligatures" class=3D"">ERROR&nbsp; : Session directory does no=
t exist: /export/apps/var/singularity/m<wbr class=3D"">nt/session</span></d=
iv><div style=3D"margin:0px;line-height:normal;color:rgb(195,55,32)" class=
=3D""><span style=3D"font-variant-ligatures:no-common-ligatures" class=3D""=
>ABORT&nbsp; : Retval =3D 255</span></div></span></div></div></div></div><d=
iv class=3D""><br class=3D"m_-672932233201048330m_9141356409832340507webkit=
-block-placeholder"></div>

-- <br class=3D""><div class=3D"m_-672932233201048330m_9141356409832340507H=
OEnZb"><div class=3D"m_-672932233201048330m_9141356409832340507h5">
You received this message because you are subscribed to the Google Groups "=
singularity" group.<br class=3D"">
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank" class=3D"">si=
ngularity+unsubscribe@lbl.go<wbr class=3D"">v</a>.<br class=3D"">
</div></div></blockquote></div><br class=3D""></div><div class=3D""><br cla=
ss=3D"m_-672932233201048330m_9141356409832340507webkit-block-placeholder"><=
/div>

-- <br class=3D"">
You received this message because you are subscribed to the Google Groups "=
singularity" group.<br class=3D"">
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank" class=3D"">si=
ngularity+unsubscribe@lbl.go<wbr class=3D"">v</a>.<br class=3D"">
</div></blockquote></div><br class=3D""></div></div></div><div class=3D"m_-=
672932233201048330HOEnZb"><div class=3D"m_-672932233201048330h5"><div class=
=3D""><br class=3D"m_-672932233201048330webkit-block-placeholder"></div>

-- <br class=3D"">
You received this message because you are subscribed to the Google Groups "=
singularity" group.<br class=3D"">
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank" class=3D"">si=
ngularity+unsubscribe@lbl.go<wbr class=3D"">v</a>.<br class=3D"">
</div></div></blockquote></div><br class=3D""></div><div class=3D""><br cla=
ss=3D"m_-672932233201048330webkit-block-placeholder"></div>

-- <br class=3D"">
You received this message because you are subscribed to the Google Groups "=
singularity" group.<br class=3D"">
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank" class=3D"">si=
ngularity+unsubscribe@lbl.<wbr class=3D"">gov</a>.<br class=3D"">
</div></blockquote></div><br class=3D""></div></div></div><div class=3D"HOE=
nZb"><div class=3D"h5"><div class=3D""><br class=3D"webkit-block-placeholde=
r"></div>

-- <br class=3D"">
You received this message because you are subscribed to the Google Groups "=
singularity" group.<br class=3D"">
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank" class=3D"">si=
ngularity+unsubscribe@lbl.<wbr class=3D"">gov</a>.<br class=3D"">
</div></div></blockquote></div><br class=3D""></div><div class=3D""><br cla=
ss=3D"webkit-block-placeholder"></div>

-- <br class=3D"">
You received this message because you are subscribed to the Google Groups "=
singularity" group.<br class=3D"">
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" class=3D"">singu...@lbl.gov</a>=
.<br class=3D"">
</div></blockquote></div><br class=3D""></div></body></html>
--Apple-Mail=_E5ABD697-3CD4-4461-B078-280AF4072CC0--
