X-Received: by 10.98.202.72 with SMTP id n69mr10673069pfg.13.1496762310797;
        Tue, 06 Jun 2017 08:18:30 -0700 (PDT)
X-BeenThere: singularity@lbl.gov
Received: by 10.107.164.78 with SMTP id n75ls166278ioe.41.gmail; Tue, 06 Jun
 2017 08:18:29 -0700 (PDT)
X-Received: by 10.98.137.93 with SMTP id v90mr25956035pfd.69.1496762308432;
        Tue, 06 Jun 2017 08:18:28 -0700 (PDT)
ARC-Seal: i=1; a=rsa-sha256; t=1496762308; cv=none;
        d=google.com; s=arc-20160816;
        b=J8NqdrsCGGZYfULT6JsPILjCNmY1R3EZqyPlbnWLuZWZnauvw6iYYsscJfUKHzPBdt
         X7gZH1y2jku+jzPgc0gKU8LNREzwgO04g4p8XQKAAe4FWFT1m4ZXDrgSoY7vprG9o7By
         AREcpvZtoiGvgO2i/mzQfYV615rhnMYxLBWyo8xkpp2zG2l6F1H5aHDUXiq42KWEgT+T
         ceYVFg34p2E0Fvm51NuKgHK5WwAul43Kce+BWO4TP5eh57Wb95i4avf1M8jGkmM4AAPI
         jHkxF619pMBz3KB/yi9QuisuvZdvdtTFtwfTEwEYIxJtotb7gY8EAx76eG3KoLdzJ5ww
         SgxA==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=to:subject:message-id:date:from:references:in-reply-to:mime-version
         :dkim-signature:arc-authentication-results;
        bh=kLe5y1sF5eyR0PPEkIYFwo7e0EztKIqL2LmLOQaoV4E=;
        b=scT1xMvOHj2ecK2G6d/kVm7ABhS3li2vTUqXwdME0aZ8HCJTw5obH9MRZrR7wTtpcC
         YSOND9e2OSAHZDsFb314o0o2DZbDDNIRzco4ztmq3t4i2pIbk4Nw0c+ILwNkPH1OsQUR
         S0D9pBkWrzkvPPQx2zP5XDy3ajFyvy+ET/W8i0L8RE6qeHNiMslSs5QUMLqo477h5Upj
         Ruw1vUVk2Nc3WpKEKM4zC81X2eefu0FRSavqENv7ZFVjLKIgLY+FVywqtPZFkfGKDppf
         Ac9eGH9eSkY1S/NexquOSo2cIrOhaci1W7WD5XTMOQS8iQYNQAN75EEk6Bqoh6VwfsLP
         f7kg==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=pass head...@gmail.com;
       spf=pass (google.com: domain of rem...@gmail.com designates 209.85.216.180 as permitted sender) smtp.mailfrom=rem...@gmail.com
Return-Path: <rem...@gmail.com>
Received: from fe3.lbl.gov (fe3.lbl.gov. [128.3.41.68])
        by mx.google.com with ESMTP id u59si10226150plb.508.2017.06.06.08.18.28
        for <singu...@lbl.gov>;
        Tue, 06 Jun 2017 08:18:28 -0700 (PDT)
Received-SPF: pass (google.com: domain of rem...@gmail.com designates 209.85.216.180 as permitted sender) client-ip=209.85.216.180;
Authentication-Results: mx.google.com;
       dkim=pass head...@gmail.com;
       spf=pass (google.com: domain of rem...@gmail.com designates 209.85.216.180 as permitted sender) smtp.mailfrom=rem...@gmail.com
X-Ironport-SBRS: 3.4
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A2FxAAAnxzZZhrTYVdFeGwEBAQMBAQEJA?=
 =?us-ascii?q?QEBFgEBAQMBAQEJAQEBgkQ8AoENgQ0Hg2QIgQQyiGOSBJV/gTEBGxslAyEBCYV?=
 =?us-ascii?q?5AoJcBz8YAQEBAQEBAQEBAQECEAEBAQgLCwgoL0IMgWUFAgMCHgQERiEFAQIDA?=
 =?us-ascii?q?QEBAQEBAQEBAQEhAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEJAgw?=
 =?us-ascii?q?DHBMSAQEYAQEBAQIBGgkEGQENDhIMAwELBgMCCw0WAQkBCQICIQEBDgMBBQEcD?=
 =?us-ascii?q?gcEARkBAgSIN4E5AQMNCAULjyKRGj+MB4FsGAUBHIMKBYNmChknDVaDXAEKAQE?=
 =?us-ascii?q?BARsCBhKIL4IUgQyCWCklRk8SAUkbAYJJgmEBBIEsAYgWhm2BXYR1hnc5AoFGh?=
 =?us-ascii?q?WCGV1yEW5F/iz6HWxQfgRUfeA0zC1EjWxlag1oqDxAMgWY+NgEBAQWGCH8NFzC?=
 =?us-ascii?q?BaQEBAQ?=
X-IronPort-AV: E=Sophos;i="5.39,306,1493708400"; 
   d="scan'208,217";a="77661126"
Received: from mail-qt0-f180.google.com ([209.85.216.180])
  by fe3.lbl.gov with ESMTP; 06 Jun 2017 08:18:26 -0700
Received: by mail-qt0-f180.google.com with SMTP id c10so78751094qtd.1
        for <singu...@lbl.gov>; Tue, 06 Jun 2017 08:18:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20161025;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to;
        bh=kLe5y1sF5eyR0PPEkIYFwo7e0EztKIqL2LmLOQaoV4E=;
        b=C08YQ+7ZLIO8faIoi9QqkHyKhVYcZlFgHC2RwDyrIS+/qepc+myMMf4HeWQXFxC1Iu
         HoP6QbHmb/V/MBH4NtRoII80p48i34GoqU8XhMMXv+AO4bkDeorMQ7gHFj/4AhPCF+yW
         rhwqgQSV9w6bd6XXS0LuWG4TP/+eEY//qqbjXDgOmvmHHne+iNOVWynBM5UXBQ19NvDZ
         Jl6qzySmV78pw7+YROBbqUK2KT9ob8dr+hSlEGTLfoITiMpQvb2CUS66fnr7Gpi8SEEM
         Pylis82IQ4d0q5y9i06F1s85de+CftbcB8fEalL2C0a62jJVJdAnCzs7Qn72CZEWFPzd
         6xjQ==
X-Gm-Message-State: AODbwcARaacEyURD6Y7ES78NxOCwZEIVtRUOwoR9GF3nWeL/LUaS/UeB
	fnZZdxUQABWVxTz0OEWaboAhIToCjNeT
X-Received: by 10.200.51.172 with SMTP id c41mr30320494qtb.71.1496762305389;
 Tue, 06 Jun 2017 08:18:25 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.200.56.231 with HTTP; Tue, 6 Jun 2017 08:18:24 -0700 (PDT)
In-Reply-To: <BDFE338B-2C36-4DE2-B94E-6AAB75FF2615@fordham.edu>
References: <eb2e5586-6bbb-4764-a155-83aea545ded0@lbl.gov> <CAM=pu+JNZw5WSspqPJhxfvVVa+W4CrUatPOFyJd02uNXK7QGsw@mail.gmail.com>
 <705AFBC5-ABBF-45AB-9A0A-F094AC0A7E07@fordham.edu> <CAM=pu+KwqfXQwbxYwZbAifx-rQjFgCoh-4KNwMPLaw8BD1xidg@mail.gmail.com>
 <C734A832-7C37-424C-BDA8-F3003A088C9A@fordham.edu> <6F6BCBDE-B10D-40F5-8D23-AB3470CA7DAA@gmail.com>
 <672F6430-4C6C-4A66-919B-A9C4E7FE4ECB@fordham.edu> <F0A18C08-400E-4362-AD1B-B9DA736F72AB@gmail.com>
 <59F05D2F-47A7-49BC-9F37-D16F845C159D@fordham.edu> <CAA6Bz=f=191vj-Mx29bsDtmt+vwHFp9E7wE9xse34ak762JxDQ@mail.gmail.com>
 <9CF6424D-BCDB-40E8-830C-81CE2F1C5538@fordham.edu> <CAA6Bz=eFXAstGLM8pm+p_PiaMvo8LNb=TGNJn82K+mLuM2BAFg@mail.gmail.com>
 <BDFE338B-2C36-4DE2-B94E-6AAB75FF2615@fordham.edu>
From: =?UTF-8?B?UsOpbXkgRGVybmF0?= <rem...@gmail.com>
Date: Tue, 6 Jun 2017 17:18:24 +0200
Message-ID: <CAA6Bz=dKY7hicKNuGdea9YyHrd+n_cPTLuSS2SW2vb3xZspmug@mail.gmail.com>
Subject: Re: [Singularity] using Singularity to add Ubuntu to a NPACI Rocks
 Cluster node
To: singularity@lbl.gov
Content-Type: multipart/alternative; boundary="001a11426c9c86aab405514c210e"

--001a11426c9c86aab405514c210e
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable

I think you built your image on a machine with uid "426" which is not
present on the cluster, so, that's normal. You just have to enter in the
container with '-w' flag in root, and edit permissions on your runscript to
fit your user on the cluster side.

BTW, of course, normally, on Rocks, you had to build your image with:
```
./configure --prefix=3D/share/apps/singularity-install
```
Instead of:
```
./configure --prefix=3D/export/apps/singularity-install
```
Specially if some binaries contain the path of some files like
singularity.conf
Sorry for this mistake.

Best,
R=C3=A9my



2017-06-06 16:55 GMT+02:00 Robert Kudyba <rku...@fordham.edu>:

> I was able to delete everything except the var directory:
> rmdir session/
> rmdir: failed to remove `session/': Device or resource busy
> pwd
> /share/apps/var/singularity/mnt
>
> But deleting the source and recloning did get me further. On the head nod=
e
> I can run singularity commands. But again on the desired node we=E2=80=99=
d like to
> run this on we get this:
>
> ./singularity
> Error loading functions: /export/apps/singularity-
> install/libexec/singularity/functions
>
> On the Rocks mailing list I as reminded to do this:
> "You need to reference singularity (or any app for that matter) as
> /share/apps and never /export/apps
>
> /export/apps only exists on the head node. "
>
> So the good news is once I redid everything to use /share/apps I was able
> to get the singularity command to work on the compute node.
>
> So once I tried a command like: ./singularity run /share/apps/ubuntu.simg
> groups: cannot find name for group ID 426
>
> It looks like I=E2=80=99m in a shell:
> ls -l /singularity
> lrwxrwxrwx 1 root root 24 Jun  6 14:46 /singularity ->
> .singularity.d/runscript
>
> But is that error/warning normal?
>
>
> On Jun 6, 2017, at 10:01 AM, R=C3=A9my Dernat <rem...@gmail.com> wrote:
>
> Hi,
>
> Try to remove every previous install and the install src directory. Then,
> logout/login and clone singularity again. Finally, build it from a clean
> environment.
> Let us know if it solves your issue.
>
> Otherwise, it could be a bug. Try to create a symbolic link to
> configuration file where it is searching (/etc/singularity/singularity.
> conf).
>
> Best regards,
> R=C3=A9my
>
> 2017-06-06 15:51 GMT+02:00 Robert Kudyba <rku...@fordham.edu>:
>
>> OK I did that but still getting the bathing error about the conf file. I
>> did find a previous thread mentioning this https://groups.google.com
>> /a/lbl.gov/forum/#!topic/singularity/mTPunMFQF4k
>> <https://urldefense.proofpoint.com/v2/url?u=3Dhttps-3A__groups.google.co=
m_a_lbl.gov_forum_-23-21topic_singularity_mTPunMFQF4k&d=3DDwMFaQ&c=3DaqMfXO=
EvEJQh2iQMCb7Wy8l0sPnURkcqADc2guUW8IM&r=3DX0jL9y0sL4r4iU_qVtR3lLNo4tOL1ry_m=
7-psV3GejY&m=3D6bH1ymxbi1sjYEf1b1I5mFgmrV6i74K8qBLXr92Gwts&s=3D8idh7dZXYflc=
0-GnBBay6ept9BXftZeazG5A09GHiNA&e=3D> but
>> there=E2=80=99s no solution on how to point to an alternative location, =
like a -c
>> option. I updated the init file to add /export/apps/singularity-install
>> to the $PATH.
>>
>>
>> ./singularity --debug create /export/apps/ubuntu.simg
>> Enabling debugging
>> Ending argument loop
>> Singularity version: 2.3-master.gda9cd20
>> Exec'ing: /export/apps/singularity-install/libexec/singularity/cli/
>> create.exec
>> VERBOSE [U=3D0,P=3D17149]      message_init()                           =
 Set
>> messagelevel to: 5
>> VERBOSE [U=3D0,P=3D17149]      singularity_config_parse()
>> Initialize configuration file: /etc/singularity/singularity.conf
>> ERROR   [U=3D0,P=3D17149]      singularity_config_parse()
>> Specified configuration file /etc/singularity/singularity.conf does not
>> appear to be a normal file.
>> ERROR   [U=3D0,P=3D17149]      singularity_config_parse()
>> Could not open configuration file /etc/singularity/singularity.conf: No
>> such file or directory
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_init()
>> Initializing Singularity Registry
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>> Adding value to registry: 'WRITABLE' =3D '1'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>> Returning singularity_registry_set(WRITABLE, 1) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>> Adding value to registry: 'LIBEXECDIR' =3D '/export/apps/singularity-ins=
t
>> all/libexec'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>> Returning singularity_registry_set(libexecdir,
>> /export/apps/singularity-install/libexec) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>> Adding value to registry: 'COMMAND' =3D 'create'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>> Returning singularity_registry_set(COMMAND, create) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>> Adding value to registry: 'MESSAGELEVEL' =3D '5'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>> Returning singularity_registry_set(MESSAGELEVEL, 5) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>> Adding value to registry: 'VERSION' =3D '2.3-master.gda9cd20'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>> Returning singularity_registry_set(version, 2.3-master.gda9cd20) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>> Adding value to registry: 'LOCALSTATEDIR' =3D '/export/apps/singularity-=
inst
>> all/var'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>> Returning singularity_registry_set(localstatedir,
>> /export/apps/singularity-install/var) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>> Adding value to registry: 'SYSCONFDIR' =3D '/export/apps/singularity-ins=
t
>> all/etc'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>> Returning singularity_registry_set(sysconfdir,
>> /export/apps/singularity-install/etc) =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>> Adding value to registry: 'BINDIR' =3D '/export/apps/singularity-inst
>> all/bin'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>> Returning singularity_registry_set(bindir, /export/apps/singularity-inst=
all/bin)
>> =3D 0
>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>> Adding value to registry: 'IMAGE' =3D '/export/apps/ubuntu.simg'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>> Returning singularity_registry_set(IMAGE, /export/apps/ubuntu.simg) =3D =
0
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_get()
>> Returning NULL on 'HOME'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_get()
>> Returning NULL on 'TARGET_UID'
>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_get()
>> Returning NULL on 'TARGET_GID'
>> DEBUG   [U=3D0,P=3D17149]      singularity_priv_init()
>> Initializing user info
>> DEBUG   [U=3D0,P=3D17149]      singularity_priv_init()                  =
 Set
>> the calling user's username to: root
>> DEBUG   [U=3D0,P=3D17149]      singularity_priv_init()
>> Marking uinfo structure as ready
>> DEBUG   [U=3D0,P=3D17149]      singularity_priv_init()
>> Obtaining home directory
>> VERBOSE [U=3D0,P=3D17149]      singularity_priv_init()                  =
 Set
>> home (via getpwuid()) to: /root
>> VERBOSE [U=3D0,P=3D17149]      singularity_suid_init()
>> Running SUID program workflow
>> VERBOSE [U=3D0,P=3D17149]      singularity_suid_init()
>> Checking program has appropriate permissions
>> VERBOSE [U=3D0,P=3D17149]      singularity_suid_init()
>> Checking configuration file is properly owned by root
>> ABORT   [U=3D0,P=3D17149]      singularity_suid_init()
>> Running in privileged mode, root must own the Singularity configuration
>> file: /etc/singularity/singularity.conf
>> ABORT   [U=3D0,P=3D17149]      singularity_suid_init()
>> Retval =3D 255
>>
>>
>> On Jun 6, 2017, at 2:53 AM, R=C3=A9my Dernat <rem...@gmail.com> wrote:
>>
>> Hi Robert,
>>
>> You just have to install singularity on a NFS export; Replace:
>>
>> ```
>>  ./configure --prefix=3D/export/apps/singularity-install --sysconfdir=3D=
/etc
>> ```
>> With:
>> ```
>>  ./configure --prefix=3D/export/apps/singularity-install
>> ```
>>
>> Then, it should works as expected.
>>
>> Do not forget that some singularity commands, like `bootstrap` in 2.3 or
>> many more in previous release need sudo/root privileges.
>>
>> Best regards,
>> R=C3=A9my
>>
>> 2017-06-05 23:09 GMT+02:00 Robert Kudyba <rku...@fordham.edu>:
>>
>>>
>>> On Jun 5, 2017, at 4:30 PM, Rick Wagner <richard...@gmail.com>
>>> wrote:
>>>
>>>
>>> On Jun 5, 2017, at 4:13 PM, Robert Kudyba <rku...@fordham.edu> wrote:
>>>
>>>
>>> On Jun 5, 2017, at 4:08 PM, Rick Wagner <richard...@gmail.com>
>>> wrote:
>>>
>>> Robert,
>>>
>>> That=E2=80=99s an NFS export for the Rocks head node that may be mounte=
d nosuid
>>>
>>>
>>> Right in /etc/fstab for other applications we already have this:
>>>
>>> UUID=3Dxxxxx /export                 ext4    defaults        1 2
>>>
>>> So what else needs to be done?
>>>
>>>
>>> One option is to build an RPM using the spec file in the Singularity
>>> repo and put that in contrib for your Rocks distro along with a package=
 tag
>>> in extend compute. That=E2=80=99s my preference because I don=E2=80=99t=
 like serving
>>> applications over NFS, especially ones with setuid.
>>>
>>> WARNING: the following will allow any executable with a setuid bit in
>>> that NFS file system to be run.
>>>
>>> You can try changing defaults to defaults,suid and remounting the file
>>> system on a compute node.
>>>
>>>
>>> Is this an =E2=80=9Cor=E2=80=9D suggestion? I don=E2=80=99t have a prob=
lem with changing the
>>> /etc/fstab. I did that and ran:
>>>   rocks sync config
>>>   rocks sync users
>>>
>>> Also made sure to use the config option as /share/apps (not /export/app=
s
>>> as that=E2=80=99s just for the head node)
>>>
>>> Still getting:
>>> /share/apps/bin
>>> ./singularity shell /share/apps/ubuntu.simg
>>> ERROR  : Session directory does not exist: /export/apps/var/singularity=
/m
>>> nt/session
>>> ABORT  : Retval =3D 255
>>>
>>> --
>>> You received this message because you are subscribed to the Google
>>> Groups "singularity" group.
>>> To unsubscribe from this group and stop receiving emails from it, send
>>> an email to singu...@lbl.gov.
>>>
>>
>>
>> --
>> You received this message because you are subscribed to the Google Group=
s
>> "singularity" group.
>> To unsubscribe from this group and stop receiving emails from it, send a=
n
>> email to singu...@lbl.gov.
>>
>>
>>
>> --
>> You received this message because you are subscribed to the Google Group=
s
>> "singularity" group.
>> To unsubscribe from this group and stop receiving emails from it, send a=
n
>> email to singu...@lbl.gov.
>>
>
>
> --
> You received this message because you are subscribed to the Google Groups
> "singularity" group.
> To unsubscribe from this group and stop receiving emails from it, send an
> email to singu...@lbl.gov.
>
>
> --
> You received this message because you are subscribed to the Google Groups
> "singularity" group.
> To unsubscribe from this group and stop receiving emails from it, send an
> email to singu...@lbl.gov.
>

--001a11426c9c86aab405514c210e
Content-Type: text/html; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">I think you built your image on a machine with uid &quot;4=
26&quot; which is not present on the cluster, so, that&#39;s normal. You ju=
st have to enter in the container with &#39;-w&#39; flag in root, and edit =
permissions on your runscript to fit your user on the cluster side.<div><br=
></div><div>BTW, of course, normally, on Rocks, you had to build your image=
 with:</div><div>```</div><div><span style=3D"font-family:Menlo;font-size:1=
0px;font-variant-ligatures:no-common-ligatures">./configure --prefix=3D/sha=
re/apps/singular</span><wbr style=3D"font-family:Menlo;font-size:10px;font-=
variant-ligatures:no-common-ligatures"><span style=3D"font-family:Menlo;fon=
t-size:10px;font-variant-ligatures:no-common-ligatures">ity-install</span><=
br></div><div>```</div><div>Instead of:</div><div><div>```</div><div><span =
style=3D"font-family:Menlo;font-size:10px;font-variant-ligatures:no-common-=
ligatures">./configure --prefix=3D/export/apps/singular</span><wbr style=3D=
"font-family:Menlo;font-size:10px;font-variant-ligatures:no-common-ligature=
s"><span style=3D"font-family:Menlo;font-size:10px;font-variant-ligatures:n=
o-common-ligatures">ity-install</span><br></div><div>```</div></div><div>Sp=
ecially if some binaries contain the path of some files like singularity.co=
nf</div><div>Sorry for this mistake.<br></div><div><br></div><div>Best,</di=
v><div>R=C3=A9my</div><div><br></div><div><br></div></div><div class=3D"gma=
il_extra"><br><div class=3D"gmail_quote">2017-06-06 16:55 GMT+02:00 Robert =
Kudyba <span dir=3D"ltr">&lt;<a href=3D"mailto:rku...@fordham.edu" target=
=3D"_blank">rku...@fordham.edu</a>&gt;</span>:<br><blockquote class=3D"gmai=
l_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left=
:1ex"><div style=3D"word-wrap:break-word"><div>I was able to delete everyth=
ing except the var directory:=C2=A0</div><div><div style=3D"margin:0px;font=
-size:10px;line-height:normal;font-family:Menlo"><span style=3D"font-varian=
t-ligatures:no-common-ligatures">rmdir session/</span></div><div style=3D"m=
argin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span style=
=3D"font-variant-ligatures:no-common-ligatures">rmdir: failed to remove `se=
ssion/&#39;: Device or resource busy</span></div><div style=3D"margin:0px;f=
ont-size:10px;line-height:normal;font-family:Menlo"><span style=3D"font-var=
iant-ligatures:no-common-ligatures">pwd</span></div><div style=3D"margin:0p=
x;font-size:10px;line-height:normal;font-family:Menlo"><span style=3D"font-=
variant-ligatures:no-common-ligatures">/share/apps/var/singularity/<wbr>mnt=
</span></div></div><div><span style=3D"font-variant-ligatures:no-common-lig=
atures"><br></span></div><div>But deleting the source and recloning did get=
 me further. On the head node I can run singularity commands. But again on =
the desired node we=E2=80=99d like to run this on we get this:</div><div><b=
r></div><div><div style=3D"margin:0px;font-size:10px;line-height:normal;fon=
t-family:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">=
./singularity=C2=A0</span></div><div style=3D"margin:0px;font-size:10px;lin=
e-height:normal;font-family:Menlo"><span style=3D"font-variant-ligatures:no=
-common-ligatures">Error loading functions: /export/apps/singularity-<wbr>i=
nstall/libexec/singularity/<wbr>functions</span></div></div><div><br></div>=
<div>On the Rocks mailing list I as reminded to do this:</div><div>&quot;Yo=
u need to reference singularity (or any app for that matter) as /share/apps=
 and never /export/apps<br><br>/export/apps only exists on the head node. &=
quot;</div><div><br></div><div>So the good news is once I redid everything =
to use /share/apps I was able to get the singularity command to work on the=
 compute node.</div><div><br></div><div>So once I tried a command like:=C2=
=A0<span style=3D"font-family:Menlo;font-size:10px">./singularity run /shar=
e/apps/ubuntu.simg</span><span style=3D"font-family:Menlo;font-size:10px">=
=C2=A0</span></div><div style=3D"margin:0px;font-size:10px;line-height:norm=
al;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common-ligat=
ures">groups: cannot find name for group ID 426</span></div><div><br></div>=
<div>It looks like I=E2=80=99m in a shell:</div><div><div style=3D"margin:0=
px;font-size:10px;line-height:normal;font-family:Menlo"><span style=3D"font=
-variant-ligatures:no-common-ligatures">ls -l /singularity=C2=A0</span></di=
v><div style=3D"margin:0px;font-size:10px;line-height:normal;font-family:Me=
nlo"><span style=3D"font-variant-ligatures:no-common-ligatures">lrwxrwxrwx =
1 root root 24 Jun=C2=A0 6 14:46 /singularity -&gt; .singularity.d/runscrip=
t</span></div></div><div><br></div><div>But is that error/warning normal?</=
div><div><div class=3D"h5"><div><br></div><br><div><blockquote type=3D"cite=
"><div>On Jun 6, 2017, at 10:01 AM, R=C3=A9my Dernat &lt;<a href=3D"mailto:=
rem...@gmail.com" target=3D"_blank">rem...@gmail.com</a>&gt; wrote:</div><b=
r class=3D"m_-672932233201048330Apple-interchange-newline"><div><div dir=3D=
"ltr">Hi,<div><br></div><div>Try to remove every previous install and the i=
nstall src directory. Then, logout/login and clone singularity again. Final=
ly, build it from a clean environment.</div><div>Let us know if it solves y=
our issue.</div><div><br></div><div>Otherwise, it could be a bug. Try to cr=
eate a symbolic link to configuration file where it is searching (/etc/sing=
ularity/singularity.<wbr>conf).</div><div><br></div><div>Best regards,</div=
><div>R=C3=A9my</div></div><div class=3D"gmail_extra"><br><div class=3D"gma=
il_quote">2017-06-06 15:51 GMT+02:00 Robert Kudyba <span dir=3D"ltr">&lt;<a=
 href=3D"mailto:rku...@fordham.edu" target=3D"_blank">rku...@fordham.edu</a=
>&gt;</span>:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8=
ex;border-left:1px #ccc solid;padding-left:1ex"><div style=3D"word-wrap:bre=
ak-word"><div>OK I did that but still getting the bathing error about the c=
onf file. I did find a previous thread mentioning this=C2=A0<a href=3D"http=
s://urldefense.proofpoint.com/v2/url?u=3Dhttps-3A__groups.google.com_a_lbl.=
gov_forum_-23-21topic_singularity_mTPunMFQF4k&amp;d=3DDwMFaQ&amp;c=3DaqMfXO=
EvEJQh2iQMCb7Wy8l0sPnURkcqADc2guUW8IM&amp;r=3DX0jL9y0sL4r4iU_qVtR3lLNo4tOL1=
ry_m7-psV3GejY&amp;m=3D6bH1ymxbi1sjYEf1b1I5mFgmrV6i74K8qBLXr92Gwts&amp;s=3D=
8idh7dZXYflc0-GnBBay6ept9BXftZeazG5A09GHiNA&amp;e=3D" target=3D"_blank">htt=
ps://groups.google.com<wbr>/a/lbl.gov/forum/#!topic/singu<wbr>larity/mTPunM=
FQF4k</a>=C2=A0but there=E2=80=99s no solution on how to point to an altern=
ative location, like a -c option. I updated the init file to add /export/ap=
ps/singularity-insta<wbr>ll to the $PATH.</div><div><br></div><div><br></di=
v><div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-fami=
ly:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">./sing=
ularity --debug create /export/apps/ubuntu.simg</span></div><div style=3D"m=
argin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span style=
=3D"font-variant-ligatures:no-common-ligatures">Enabling debugging</span></=
div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-family:=
Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">Ending ar=
gument loop</span></div><div style=3D"margin:0px;font-size:10px;line-height=
:normal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common-=
ligatures">Singularity version: 2.3-master.gda9cd20</span></div><div style=
=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span s=
tyle=3D"font-variant-ligatures:no-common-ligatures">Exec&#39;ing: /export/a=
pps/singularity-insta<wbr>ll/libexec/singularity/cli/<wbr>create.exec</span=
></div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-fami=
ly:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">VERBOS=
E [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 message_init()=C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 Set messagelevel to: 5</span></div><div style=3D"margin:0px;font-size:1=
0px;line-height:normal;font-family:Menlo"><span style=3D"font-variant-ligat=
ures:no-common-ligatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 sin=
gularity_config_parse()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 Initialize configuration file: /etc/singularity/singularity.c<wbr>onf</=
span></div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-=
family:Menlo;color:rgb(255,59,29)"><span style=3D"font-variant-ligatures:no=
-common-ligatures">ERROR =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singu=
larity_config_parse()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 Specified configuration file /etc/singularity/singularity.c<wbr>onf doe=
s not appear to be a normal file.</span></div><div style=3D"margin:0px;font=
-size:10px;line-height:normal;font-family:Menlo;color:rgb(255,59,29)"><span=
 style=3D"font-variant-ligatures:no-common-ligatures">ERROR =C2=A0 [U=3D0,P=
=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_config_parse()=C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Could not open configuration file /e=
tc/singularity/singularity.c<wbr>onf: No such file or directory</span></div=
><div style=3D"margin:0px;font-size:10px;line-height:normal;font-family:Men=
lo"><span style=3D"font-variant-ligatures:no-common-ligatures">VERBOSE [U=
=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_init() =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Initializing Singularity Registry</s=
pan></div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-f=
amily:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">VER=
BOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0=
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Adding value to registry:=
 &#39;WRITABLE&#39; =3D &#39;1&#39;</span></div><div style=3D"margin:0px;fo=
nt-size:10px;line-height:normal;font-family:Menlo"><span style=3D"font-vari=
ant-ligatures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=
=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 Returning singularity_registry_set(WRITA<wbr>BLE, 1) =3D =
0</span></div><div style=3D"margin:0px;font-size:10px;line-height:normal;fo=
nt-family:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures"=
>VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Adding value to reg=
istry: &#39;LIBEXECDIR&#39; =3D &#39;/export/apps/singularity-inst<wbr>all/=
libexec&#39;</span></div><div style=3D"margin:0px;font-size:10px;line-heigh=
t:normal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common=
-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_=
registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Retur=
ning singularity_registry_set(libex<wbr>ecdir, /export/apps/singularity-ins=
ta<wbr>ll/libexec) =3D 0</span></div><div style=3D"margin:0px;font-size:10p=
x;line-height:normal;font-family:Menlo"><span style=3D"font-variant-ligatur=
es:no-common-ligatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singu=
larity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 Adding value to registry: &#39;COMMAND&#39; =3D &#39;create&#39;</span>=
</div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-famil=
y:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">DEBUG =
=C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning singularity_=
registry_set(COMMA<wbr>ND, create) =3D 0</span></div><div style=3D"margin:0=
px;font-size:10px;line-height:normal;font-family:Menlo"><span style=3D"font=
-variant-ligatures:no-common-ligatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=
=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 Adding value to registry: &#39;MESSAGELEVEL&#39; =3D &#39=
;5&#39;</span></div><div style=3D"margin:0px;font-size:10px;line-height:nor=
mal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common-liga=
tures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_regis=
try_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning =
singularity_registry_set(MESSA<wbr>GELEVEL, 5) =3D 0</span></div><div style=
=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span s=
tyle=3D"font-variant-ligatures:no-common-ligatures">VERBOSE [U=3D0,P=3D1714=
9]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Adding value to registry: &#39;VERSION&#39;=
 =3D &#39;2.3-master.gda9cd20&#39;</span></div><div style=3D"margin:0px;fon=
t-size:10px;line-height:normal;font-family:Menlo"><span style=3D"font-varia=
nt-ligatures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=
=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 Returning singularity_registry_set(versi<wbr>on, 2.3-mast=
er.gda9cd20) =3D 0</span></div><div style=3D"margin:0px;font-size:10px;line=
-height:normal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-=
common-ligatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity=
_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Addi=
ng value to registry: &#39;LOCALSTATEDIR&#39; =3D &#39;/export/apps/singula=
rity-inst<wbr>all/var&#39;</span></div><div style=3D"margin:0px;font-size:1=
0px;line-height:normal;font-family:Menlo"><span style=3D"font-variant-ligat=
ures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=
=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 Returning singularity_registry_set(local<wbr>statedir, /export/a=
pps/singularity-insta<wbr>ll/var) =3D 0</span></div><div style=3D"margin:0p=
x;font-size:10px;line-height:normal;font-family:Menlo"><span style=3D"font-=
variant-ligatures:no-common-ligatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=
=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 Adding value to registry: &#39;SYSCONFDIR&#39; =3D &#39;/=
export/apps/singularity-inst<wbr>all/etc&#39;</span></div><div style=3D"mar=
gin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span style=3D=
"font-variant-ligatures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=
=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning singularity_registry_set(sysco<wbr>nf=
dir, /export/apps/singularity-insta<wbr>ll/etc) =3D 0</span></div><div styl=
e=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span =
style=3D"font-variant-ligatures:no-common-ligatures">VERBOSE [U=3D0,P=3D171=
49]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Adding value to registry: &#39;BINDIR&#39; =
=3D &#39;/export/apps/singularity-inst<wbr>all/bin&#39;</span></div><div st=
yle=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo"><spa=
n style=3D"font-variant-ligatures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,=
P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning singularity_registry_set(b=
indi<wbr>r, /export/apps/singularity-insta<wbr>ll/bin) =3D 0</span></div><d=
iv style=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo"=
><span style=3D"font-variant-ligatures:no-common-ligatures">VERBOSE [U=3D0,=
P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Adding value to registry: &#39;IMAGE=
&#39; =3D &#39;/export/apps/ubuntu.simg&#39;</span></div><div style=3D"marg=
in:0px;font-size:10px;line-height:normal;font-family:Menlo"><span style=3D"=
font-variant-ligatures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=
=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning singularity_registry_set(IMAGE<wbr>, =
/export/apps/ubuntu.simg) =3D 0</span></div><div style=3D"margin:0px;font-s=
ize:10px;line-height:normal;font-family:Menlo"><span style=3D"font-variant-=
ligatures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =
=C2=A0 singularity_registry_get()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 Returning NULL on &#39;HOME&#39;</span></div><div style=3D"ma=
rgin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span style=
=3D"font-variant-ligatures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D171=
49]=C2=A0 =C2=A0 =C2=A0 singularity_registry_get()=C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning NULL on &#39;TARGET_UID&#39;</spa=
n></div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-fam=
ily:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">DEBUG=
 =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_get()=C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning NULL on &#39=
;TARGET_GID&#39;</span></div><div style=3D"margin:0px;font-size:10px;line-h=
eight:normal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-co=
mmon-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singular=
ity_priv_init() =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 Initializing user info</span></div><div style=3D"margin:0px;font-size:1=
0px;line-height:normal;font-family:Menlo"><span style=3D"font-variant-ligat=
ures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=
=A0 singularity_priv_init() =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 Set the calling user&#39;s username to: root</span></div>=
<div style=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menl=
o"><span style=3D"font-variant-ligatures:no-common-ligatures">DEBUG =C2=A0 =
[U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_priv_init() =C2=A0 =C2=A0=
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Marking uinfo structure a=
s ready</span></div><div style=3D"margin:0px;font-size:10px;line-height:nor=
mal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common-liga=
tures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_priv_=
init() =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Obtai=
ning home directory</span></div><div style=3D"margin:0px;font-size:10px;lin=
e-height:normal;font-family:Menlo"><span style=3D"font-variant-ligatures:no=
-common-ligatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularit=
y_priv_init() =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 Set home (via getpwuid()) to: /root</span></div><div style=3D"margin:0p=
x;font-size:10px;line-height:normal;font-family:Menlo"><span style=3D"font-=
variant-ligatures:no-common-ligatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=
=A0 =C2=A0 singularity_suid_init() =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 Running SUID program workflow</span></div><div sty=
le=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span=
 style=3D"font-variant-ligatures:no-common-ligatures">VERBOSE [U=3D0,P=3D17=
149]=C2=A0 =C2=A0 =C2=A0 singularity_suid_init() =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Checking program has appropriate per=
missions</span></div><div style=3D"margin:0px;font-size:10px;line-height:no=
rmal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common-lig=
atures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_suid_init=
() =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Checking =
configuration file is properly owned by root</span></div><div style=3D"marg=
in:0px;font-size:10px;line-height:normal;font-family:Menlo;color:rgb(195,55=
,32)"><span style=3D"font-variant-ligatures:no-common-ligatures">ABORT =C2=
=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_suid_init() =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Running in privileg=
ed mode, root must own the Singularity configuration file: /etc/singularity=
/singularity.c<wbr>onf</span></div><div style=3D"margin:0px;font-size:10px;=
line-height:normal;font-family:Menlo;color:rgb(195,55,32)"><span style=3D"f=
ont-variant-ligatures:no-common-ligatures">ABORT =C2=A0 [U=3D0,P=3D17149]=
=C2=A0 =C2=A0 =C2=A0 singularity_suid_init() =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Retval =3D 255</span></div></div><div><d=
iv class=3D"m_-672932233201048330h5"><div><span style=3D"font-variant-ligat=
ures:no-common-ligatures"><br></span></div><br><div><blockquote type=3D"cit=
e"><div>On Jun 6, 2017, at 2:53 AM, R=C3=A9my Dernat &lt;<a href=3D"mailto:=
rem...@gmail.com" target=3D"_blank">rem...@gmail.com</a>&gt; wrote:</div><b=
r class=3D"m_-672932233201048330m_9141356409832340507Apple-interchange-newl=
ine"><div><div dir=3D"ltr">Hi Robert,<div><br></div><div>You just have to i=
nstall singularity on a NFS export; Replace:</div><div><br></div><div>```</=
div><div><span style=3D"font-variant-ligatures:no-common-ligatures;font-fam=
ily:Menlo;font-size:10px">=C2=A0</span><span style=3D"font-variant-ligature=
s:no-common-ligatures;font-family:Menlo;font-size:10px">./configure --prefi=
x=3D/export/apps/singular<wbr>ity-install --sysconfdir=3D/etc</span><br></d=
iv><div>```</div><div>With:</div><div>```</div><div><span style=3D"font-var=
iant-ligatures:no-common-ligatures;font-family:Menlo;font-size:10px">=C2=A0=
</span><span style=3D"font-variant-ligatures:no-common-ligatures;font-famil=
y:Menlo;font-size:10px">./configure --prefix=3D/export/apps/singular<wbr>it=
y-install</span><br></div><div>```</div><div><br></div><div>Then, it should=
 works as expected.</div><div><br></div><div>Do not forget that some singul=
arity commands, like `bootstrap` in 2.3 or many more in previous release ne=
ed sudo/root privileges.</div><div><br></div><div>Best regards,<br>R=C3=A9m=
y</div></div><div class=3D"gmail_extra"><br><div class=3D"gmail_quote">2017=
-06-05 23:09 GMT+02:00 Robert Kudyba <span dir=3D"ltr">&lt;<a href=3D"mailt=
o:rku...@fordham.edu" target=3D"_blank">rku...@fordham.edu</a>&gt;</span>:<=
br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left=
:1px #ccc solid;padding-left:1ex"><div style=3D"word-wrap:break-word"><span=
><br><div><blockquote type=3D"cite"><div>On Jun 5, 2017, at 4:30 PM, Rick W=
agner &lt;<a href=3D"mailto:richard...@gmail.com" target=3D"_blank">richard=
...@gmail.com</a>&gt; wrote:</div><br class=3D"m_-672932233201048330m_91413=
56409832340507m_-5619588665609687384Apple-interchange-newline"><div><div st=
yle=3D"word-wrap:break-word"><br><div><blockquote type=3D"cite"><div>On Jun=
 5, 2017, at 4:13 PM, Robert Kudyba &lt;<a href=3D"mailto:rku...@fordham.ed=
u" target=3D"_blank">rku...@fordham.edu</a>&gt; wrote:</div><br class=3D"m_=
-672932233201048330m_9141356409832340507m_-5619588665609687384Apple-interch=
ange-newline"><div><div style=3D"word-wrap:break-word"><br><div><blockquote=
 type=3D"cite"><div>On Jun 5, 2017, at 4:08 PM, Rick Wagner &lt;<a href=3D"=
mailto:richard...@gmail.com" target=3D"_blank">richard...@gmail.com</a>&gt;=
 wrote:</div><br class=3D"m_-672932233201048330m_9141356409832340507m_-5619=
588665609687384Apple-interchange-newline"><div><div style=3D"word-wrap:brea=
k-word"><div>Robert,</div><div><br></div><div>That=E2=80=99s an NFS export =
for the Rocks head node that may be mounted nosuid</div></div></div></block=
quote><br></div><div>Right in /etc/fstab for other applications we already =
have this:</div><div><br></div><div><div style=3D"margin:0px;font-size:10px=
;line-height:normal;font-family:Menlo"><span style=3D"font-variant-ligature=
s:no-common-ligatures">UUID=3Dxxxxx /export =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 ext4=C2=A0 =C2=A0 defaults=C2=A0 =C2=A0 =C2=A0 =C2=
=A0 1 2</span></div><div><span style=3D"font-variant-ligatures:no-common-li=
gatures"><br></span></div></div>So what else needs to be done?</div></div><=
/blockquote><div><br></div><div>One option is to build an RPM using the spe=
c file in the Singularity repo and put that in contrib for your Rocks distr=
o along with a package tag in extend compute. That=E2=80=99s my preference =
because I don=E2=80=99t like serving applications over NFS, especially ones=
 with setuid.</div><div><br></div><div>WARNING: the following will allow an=
y executable with a setuid bit in that NFS file system to be run.</div><div=
><br></div><div>You can try changing defaults to defaults,suid and remounti=
ng the file system on a compute node.</div></div></div></div></blockquote><=
br></div></span><div>Is this an =E2=80=9Cor=E2=80=9D suggestion? I don=E2=
=80=99t have a problem with changing the /etc/fstab. I did that and ran:</d=
iv><div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-fam=
ily:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">=C2=
=A0=C2=A0rocks sync config</span></div><div style=3D"margin:0px;font-size:1=
0px;line-height:normal;font-family:Menlo"><span style=3D"font-variant-ligat=
ures:no-common-ligatures">=C2=A0 rocks sync users</span></div><div style=3D=
"margin:0px;font-size:10px;line-height:normal;font-family:Menlo"><br></div>=
</div>Also made sure to use the config option as /share/apps (not /export/a=
pps as that=E2=80=99s just for the head node)<div><br></div><div>Still gett=
ing:</div><div><div><div style=3D"margin:0px;font-size:10px;line-height:nor=
mal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common-liga=
tures">/share/apps/bin</span></div></div><div><div style=3D"margin:0px;font=
-size:10px;line-height:normal;font-family:Menlo"><div style=3D"margin:0px;l=
ine-height:normal"><span style=3D"font-variant-ligatures:no-common-ligature=
s">./singularity shell /share/apps/ubuntu.simg</span></div><span><div style=
=3D"margin:0px;line-height:normal;color:rgb(255,59,29)"><span style=3D"font=
-variant-ligatures:no-common-ligatures">ERROR=C2=A0 : Session directory doe=
s not exist: /export/apps/var/singularity/m<wbr>nt/session</span></div><div=
 style=3D"margin:0px;line-height:normal;color:rgb(195,55,32)"><span style=
=3D"font-variant-ligatures:no-common-ligatures">ABORT=C2=A0 : Retval =3D 25=
5</span></div></span></div></div></div></div><div><br class=3D"m_-672932233=
201048330m_9141356409832340507webkit-block-placeholder"></div>

-- <br><div class=3D"m_-672932233201048330m_9141356409832340507HOEnZb"><div=
 class=3D"m_-672932233201048330m_9141356409832340507h5">
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singularity+u=
nsubscribe@lbl.go<wbr>v</a>.<br>
</div></div></blockquote></div><br></div><div><br class=3D"m_-6729322332010=
48330m_9141356409832340507webkit-block-placeholder"></div>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singularity+u=
nsubscribe@lbl.go<wbr>v</a>.<br>
</div></blockquote></div><br></div></div></div><div class=3D"m_-67293223320=
1048330HOEnZb"><div class=3D"m_-672932233201048330h5"><div><br class=3D"m_-=
672932233201048330webkit-block-placeholder"></div>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singularity+u=
nsubscribe@lbl.go<wbr>v</a>.<br>
</div></div></blockquote></div><br></div><div><br class=3D"m_-6729322332010=
48330webkit-block-placeholder"></div>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singularity+u=
nsubscribe@lbl.<wbr>gov</a>.<br>
</div></blockquote></div><br></div></div></div><div class=3D"HOEnZb"><div c=
lass=3D"h5">

<p></p>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singularity+u=
nsubscribe@lbl.<wbr>gov</a>.<br>
</div></div></blockquote></div><br></div>

--001a11426c9c86aab405514c210e--
