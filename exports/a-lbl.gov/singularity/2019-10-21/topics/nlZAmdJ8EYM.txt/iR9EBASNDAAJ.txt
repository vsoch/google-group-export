X-Received: by 10.99.173.66 with SMTP id y2mr114156pgo.18.1487903204642;
        Thu, 23 Feb 2017 18:26:44 -0800 (PST)
X-BeenThere: singularity@lbl.gov
Received: by 10.107.131.34 with SMTP id f34ls1570105iod.36.gmail; Thu, 23 Feb
 2017 18:26:42 -0800 (PST)
X-Received: by 10.99.173.6 with SMTP id g6mr450085pgf.75.1487903202318;
        Thu, 23 Feb 2017 18:26:42 -0800 (PST)
Return-Path: <gmku...@lbl.gov>
Received: from fe4.lbl.gov (fe4.lbl.gov. [128.3.41.71])
        by mx.google.com with ESMTP id u5si5922399pgi.223.2017.02.23.18.26.42
        for <singu...@lbl.gov>;
        Thu, 23 Feb 2017 18:26:42 -0800 (PST)
Received-SPF: pass (google.com: domain of gmku...@lbl.gov designates 209.85.161.200 as permitted sender) client-ip=209.85.161.200;
Authentication-Results: mx.google.com;
       spf=pass (google.com: domain of gmku...@lbl.gov designates 209.85.161.200 as permitted sender) smtp.mailfrom=gmku...@lbl.gov
X-Ironport-SBRS: 3.4
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: A2HyAwDrmK9YhsihVdFaAxoBAQEBAgEBAQEIAQEBARUBAQEBAgEBAQEIAQEBAYJDgUN4EQeDTAiBBIkEkV+CZIUoh3yFLIFKGygfAQ6Ba1OCfDoCgx4HPxgBAQEBAQEBAQEBAQIQAQEBCAsLCh0vgjMEAgMZAQQEBD0KAy4BAQEBAQEBAQEBAQEBAQEBGgINIg8DKQEBAQMBIysrBQsLCw0qAgIhAQ8DAQUBHAYIBwQBHASJPAMNCAUJoHk/ilQPgSCCJoc4DYN/AQEBAQEFAQEBAQEBAQEBHxKKIIEJglElgSYKEQE9JoI/gl8FiXmGUoUdhXE6AYZzhxCEIIF7U4RKiXqKRYcdFB6BFQ8QgQIvCBkKN00XBYN2SoIOHzUFAod0R4FnAQEB
X-IronPort-AV: E=Sophos;i="5.35,199,1484035200"; 
   d="scan'208,217";a="65178433"
Received: from mail-yw0-f200.google.com ([209.85.161.200])
  by fe4.lbl.gov with ESMTP; 23 Feb 2017 18:26:40 -0800
Received: by mail-yw0-f200.google.com with SMTP id p77so14881441ywg.3
        for <singu...@lbl.gov>; Thu, 23 Feb 2017 18:26:40 -0800 (PST)
X-Gm-Message-State: AMke39n0/nAQfGl61KDmkWnEAd5vGE7EnGE+pebRI8b0JAUbrEuQR2jdXNXoZ5xFlztJVmdWLar9YPJU4EUXeCsmQ4YdDpNDvEr+4Wawn4e/vBMkZ03Td7G35CrWdj/XgWpcihAe7VxaGyd83OKBztsWuRg=
X-Received: by 10.129.68.26 with SMTP id r26mr233577ywa.164.1487903200283;
        Thu, 23 Feb 2017 18:26:40 -0800 (PST)
X-Received: by 10.129.68.26 with SMTP id r26mr233571ywa.164.1487903200050;
 Thu, 23 Feb 2017 18:26:40 -0800 (PST)
MIME-Version: 1.0
Received: by 10.129.110.69 with HTTP; Thu, 23 Feb 2017 18:26:39 -0800 (PST)
In-Reply-To: <CAM=pu+JwKwNqcfFiX7A-sWdpt=6qCacza-bUdR6RZhbnbuwoaQ@mail.gmail.com>
References: <CAM=pu+J7828-_7exyZg5QQvJxPB6qFLJ0DCjBB+mhDbgmVE_jw@mail.gmail.com>
 <46130B9A-88B6-4F47-9CBA-C1CE858D89ED@ptmx.org> <1B027F24-6738-4881-AA41-61C4BA9F81A0@gmail.com>
 <5E4EE7BE-4346-4D48-B145-99D76ED8C84B@ptmx.org> <CAM=pu++i_aqeaNwWKgZYcsLbBFawGHEOswS-FXvaWsQ84F7H_Q@mail.gmail.com>
 <2AA86F34-1746-4B23-84AF-89CF66A20FAF@ptmx.org> <897F894C-FC3D-401E-A789-9215C6DC7366@gmail.com>
 <95C571DF-32D0-4DCC-9F7C-EED7C3F47721@ptmx.org> <CAM=pu+JwKwNqcfFiX7A-sWdpt=6qCacza-bUdR6RZhbnbuwoaQ@mail.gmail.com>
From: "Gregory M. Kurtzer" <gmku...@lbl.gov>
Date: Thu, 23 Feb 2017 18:26:39 -0800
Message-ID: <CAN7etTw5-srX+x2GybncOz_mKXeHb7io2060unHZHr-1Whjb9A@mail.gmail.com>
Subject: Re: [Singularity] Re: Singularity Hub
To: singularity <singu...@lbl.gov>
Cc: Petar Forai <p...@ptmx.org>
Content-Type: multipart/alternative; boundary=f403045eb55cb320df05493d7534

--f403045eb55cb320df05493d7534
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Hi Petar,

Yes, as Vanessa mentioned, if you could send the --debug output, it will
help us see what is happening.

Thanks!

On Thu, Feb 23, 2017 at 9:35 AM, vanessa s <vso...@gmail.com> wrote:

> Hey Petar,
>
> I am forwarding your question to the list to get the best, and quickest
> answers.
>
>
>> why do I see that singularity still enumerates the hosts=E2=80=99s mount=
 points
>> when hostfs=3Dno is configured in singularity.conf? I see that that a ex=
ec
>> failues due to  a stale NFS handle of a file system it shouldn=E2=80=99t=
 even
>> touch.
>>
>>
> To start, could you run the command with --debug and share the output? Th=
e
> first thing you should see is this line:
>
> https://github.com/singularityware/singularity/blob/
> e90ee1ba4e565a7cf7878780892d3ce3843c69db/src/lib/mount/hostfs/hostfs.c#L5=
2
>
> I'd guess either the command isn't being parsed correctly, there is a
> library conflict with some older version, exec has some dependency on
> accessing local files, or even with the configuration, the mounts are sti=
ll
> sniffed (but not altered).
>
> If you can share the debug output, it will give more insight to the issue=
,
> and then we can go from there! :)
>
> Best,
>
> Vanessa
>
>
>> best,
>> P
>>
>>
>>
>>
>> On 23 Feb 2017, at 17:50, vanessa s <vso...@gmail.com> wrote:
>>
>> Great thank you! For the time being, please direct your users to obtain
>> images via the singularity client.
>>
>> Best,
>>
>> Vanessa
>>
>> On Feb 23, 2017, at 8:26 AM, Petar Forai <p...@ptmx.org> wrote:
>>
>> That=E2=80=99s one example - but it is generally an issue. I have local =
users
>> that observed the same problem with their images.
>>
>> Here=E2=80=99s mine:
>> https://singularity-hub.org/collections/58/
>>
>>
>> Thanks a bunch!
>>
>> P
>>
>> On 23 Feb 2017, at 17:07, vanessa sochat <vso...@stanford.edu> wrote:
>>
>> Ah ok, so it's a problem with the web link. I'll look into this later
>> today - could you point me to the image that you had trouble with?
>>
>> On Thu, Feb 23, 2017 at 8:03 AM, Petar Forai <p...@ptmx.org> wrote:
>>
>>> No, but the image that i downloaded is not a valid image and can=E2=80=
=99t be
>>> executed if just downloaded from the page, if pulled everything is fine=
 and
>>> the sizes differ - both are compressed.
>>>
>>> best,
>>> P
>>>
>>> On 23 Feb 2017, at 16:56, vanessa s <vso...@gmail.com> wrote:
>>>
>>> Hi Petar,
>>>
>>> Ok, so you are saying the sizes are different? The singularity hub imag=
e
>>> is a compressed image format, if that might be what you are asking? Is
>>> there software or function missing from your image?
>>>
>>> Best,
>>>
>>> Vanessa
>>>
>>> On Feb 23, 2017, at 3:58 AM, Petar Forai <p...@ptmx.org> wrote:
>>>
>>> Hi Vanessa,
>>>
>>> I think that downloading the container image from shub is currently not
>>> 100% there. The image runs fine when executed from singularity exec
>>> shub://foo/bar /bin/sh but fails when I first DL the image from shub to
>>> the machine and try running it.
>>>
>>> I can clearly see that the images that I download from shub have size
>>> 52X MB while what I have on the FS when singularity pulls the image is
>>> *much* bigger:
>>>
>>> For example:
>>>
>>> On my FS:
>>>
>>> -rwxrwxrwx  1 petar.forai IS.GRP  2.0G Feb 23 10:26
>>> 5e7fac985f0b0fc24cbb034ab22f84ecc3addc9e.img
>>>
>>> But the downloaded file is only 523MB.
>>>
>>> I do have a working system by running singularity pull and then exec=E2=
=80=99ing
>>> as desired.
>>>
>>> Thanks,
>>> P
>>>
>>>
>>>
>>>
>>> On 13 Feb 2017, at 15:52, vanessa sochat <vso...@stanford.edu> wrote:
>>>
>>> Hey Pitar!
>>>
>>> I saw that you made a container collection on Singularity Hub (woot!)
>>> but that you didn't have any builds. There were a few errors triggered =
last
>>> night, and I wanted to get your feedback on if anything went wrong when=
 you
>>> were trying to create the builds. It might just be that you built the
>>> containers and deleted them (and just need to re-push) but if not, I'd =
like
>>> to help walk through fixing this up. I'm traveling this morning, but wi=
ll
>>> be back later this afternoon. Let me know if I can be of help!
>>>
>>> Best,
>>>
>>> Vanessa
>>>
>>> --
>>> Vanessa Villamia Sochat
>>> Stanford University
>>> (603) 321-0676
>>>
>>>
>>>
>>>
>>
>>
>> --
>> Vanessa Villamia Sochat
>> Stanford University
>> (603) 321-0676
>>
>>
>>
>>
>
>
> --
> Vanessa Villamia Sochat
> Stanford University '16
> (603) 321-0676
>
> --
> You received this message because you are subscribed to the Google Groups
> "singularity" group.
> To unsubscribe from this group and stop receiving emails from it, send an
> email to singu...@lbl.gov.
>



--=20
Gregory M. Kurtzer
HPC Systems Architect and Technology Developer
Lawrence Berkeley National Laboratory HPCS
University of California Berkeley Research IT
Singularity Linux Containers (http://singularity.lbl.gov/)
Warewulf Cluster Management (http://warewulf.lbl.gov/)
GitHub: https://github.com/gmkurtzer, Twitter: https://twitter.com/gmkurtze=
r

--f403045eb55cb320df05493d7534
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">Hi Petar,<div><br></div><div>Yes, as Vanessa mentioned, if=
 you could send the --debug output, it will help us see what is happening.<=
/div><div><br></div><div>Thanks!</div></div><div class=3D"gmail_extra"><br>=
<div class=3D"gmail_quote">On Thu, Feb 23, 2017 at 9:35 AM, vanessa s <span=
 dir=3D"ltr">&lt;<a href=3D"mailto:vso...@gmail.com" target=3D"_blank">vso.=
..@gmail.com</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" sty=
le=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div d=
ir=3D"ltr">Hey Petar,<div><br></div><div>I am forwarding your question to t=
he list to get the best, and quickest answers.=C2=A0</div><div><br></div><d=
iv class=3D"gmail_extra"><div class=3D"gmail_quote"><blockquote class=3D"gm=
ail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,=
204,204);padding-left:1ex"><div style=3D"word-wrap:break-word"><div><br></d=
iv><div>why do I see that singularity still enumerates the hosts=E2=80=99s =
mount points when hostfs=3Dno is configured in singularity.conf? I see that=
 that a exec failues due to =C2=A0a stale NFS handle of a file system it sh=
ouldn=E2=80=99t even touch.=C2=A0</div><div><br></div></div></blockquote><d=
iv><br></div><div>To start, could you run the command with --debug and shar=
e the output? The first thing you should see is this line:</div><div><br></=
div><div><a href=3D"https://github.com/singularityware/singularity/blob/e90=
ee1ba4e565a7cf7878780892d3ce3843c69db/src/lib/mount/hostfs/hostfs.c#L52" ta=
rget=3D"_blank">https://github.com/<wbr>singularityware/singularity/<wbr>bl=
ob/<wbr>e90ee1ba4e565a7cf7878780892d3c<wbr>e3843c69db/src/lib/mount/<wbr>ho=
stfs/hostfs.c#L52</a><br></div><div><br></div><div>I&#39;d guess either the=
 command isn&#39;t being parsed correctly, there is a library conflict with=
 some older version, exec has some dependency on accessing local files, or =
even with the configuration, the mounts are still sniffed (but not altered)=
.</div><div><br></div><div>If you can share the debug output, it will give =
more insight to the issue, and then we can go from there! :)</div><div><br>=
</div><div>Best,</div><div><br></div><div>Vanessa</div><div>=C2=A0</div><bl=
ockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-lef=
t:1px solid rgb(204,204,204);padding-left:1ex"><div style=3D"word-wrap:brea=
k-word"><div></div><div>best,</div><div>P<div><div class=3D"m_5196899198189=
442020gmail-h5"><br><div><br></div><div><br></div><div><br><div><blockquote=
 type=3D"cite"><div>On 23 Feb 2017, at 17:50, vanessa s &lt;<a href=3D"mail=
to:vso...@gmail.com" target=3D"_blank">vso...@gmail.com</a>&gt; wrote:</div=
><br class=3D"m_5196899198189442020gmail-m_-5046545257001472313Apple-interc=
hange-newline"><div><div dir=3D"auto"><div>Great thank you! For the time be=
ing, please direct your users to obtain images via the singularity client.<=
br><br>Best,<div><br></div><div>Vanessa</div></div><div><br>On Feb 23, 2017=
, at 8:26 AM, Petar Forai &lt;<a href=3D"mailto:p...@ptmx.org" target=3D"_b=
lank">p...@ptmx.org</a>&gt; wrote:<br><br></div><blockquote type=3D"cite"><=
div><div style=3D"word-wrap:break-word">That=E2=80=99s one example - but it=
 is generally an issue. I have local users that observed the same problem w=
ith their images.=C2=A0<div><br></div><div>Here=E2=80=99s mine:</div><div><=
a href=3D"https://singularity-hub.org/collections/58/" target=3D"_blank">ht=
tps://singularity-hub.org/co<wbr>llections/58/</a></div><div><br></div><div=
><br></div><div>Thanks a bunch!</div><div><br></div><div>P</div><div><br><d=
iv><blockquote type=3D"cite"><div>On 23 Feb 2017, at 17:07, vanessa sochat =
&lt;<a href=3D"mailto:vso...@stanford.edu" target=3D"_blank">vso...@stanfor=
d.edu</a>&gt; wrote:</div><br class=3D"m_5196899198189442020gmail-m_-504654=
5257001472313Apple-interchange-newline"><div><div dir=3D"ltr">Ah ok, so it&=
#39;s a problem with the web link. I&#39;ll look into this later today - co=
uld you point me to the image that you had trouble with?</div><div class=3D=
"gmail_extra"><br><div class=3D"gmail_quote">On Thu, Feb 23, 2017 at 8:03 A=
M, Petar Forai <span dir=3D"ltr">&lt;<a href=3D"mailto:p...@ptmx.org" targe=
t=3D"_blank">p...@ptmx.org</a>&gt;</span> wrote:<br><blockquote class=3D"gm=
ail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,=
204,204);padding-left:1ex"><div style=3D"word-wrap:break-word"><div style=
=3D"word-wrap:break-word">No, but the image that i downloaded is not a vali=
d image and can=E2=80=99t be executed if just downloaded from the page, if =
pulled everything is fine and the sizes differ - both are compressed.<div><=
br></div><div>best,</div><div>P<div><div class=3D"m_5196899198189442020gmai=
l-m_-5046545257001472313h5"><br><div><blockquote type=3D"cite"><div>On 23 F=
eb 2017, at 16:56, vanessa s &lt;<a href=3D"mailto:vso...@gmail.com" target=
=3D"_blank">vso...@gmail.com</a>&gt; wrote:</div><br class=3D"m_51968991981=
89442020gmail-m_-5046545257001472313m_8328919070272559881Apple-interchange-=
newline"><div><div dir=3D"auto"><div>Hi Petar,</div><div><br></div><div>Ok,=
 so you are saying the sizes are different? The singularity hub image is a =
compressed image format, if that might be what you are asking? Is there sof=
tware or function missing from your image?<br><br>Best,<div><br></div><div>=
Vanessa</div></div><div><br>On Feb 23, 2017, at 3:58 AM, Petar Forai &lt;<a=
 href=3D"mailto:p...@ptmx.org" target=3D"_blank">p...@ptmx.org</a>&gt; wrot=
e:<br><br></div><blockquote type=3D"cite"><div><div style=3D"word-wrap:brea=
k-word">Hi Vanessa,<div><br></div><div>I think that downloading the contain=
er image from shub is currently not 100% there. The image runs fine when ex=
ecuted from singularity exec <a>shub://foo/bar</a>=C2=A0/bin/sh but fails w=
hen I first DL the image from shub to the machine and try running it.=C2=A0=
</div><div><br></div><div>I can clearly see that the images that I download=
 from shub have size 52X MB while what I have on the FS when singularity pu=
lls the image is *much* bigger:</div><div><br></div><div>For example:</div>=
<div><br></div><div>On my FS:</div><div><br></div><div><div>-rwxrwxrwx =C2=
=A01 petar.forai IS.GRP =C2=A02.0G Feb 23 10:26 5e7fac985f0b0fc24cbb034ab22=
f84<wbr>ecc3addc9e.img</div></div><div><br></div><div>But the downloaded fi=
le is only 523MB.=C2=A0</div><div><br></div><div>I do have a working system=
 by running singularity pull and then exec=E2=80=99ing as desired.</div><di=
v><br></div><div>Thanks,</div><div>P</div><div><br></div><div><br></div><di=
v><br></div><div><br><div><blockquote type=3D"cite"><div>On 13 Feb 2017, at=
 15:52, vanessa sochat &lt;<a href=3D"mailto:vso...@stanford.edu" target=3D=
"_blank">vso...@stanford.edu</a>&gt; wrote:</div><br class=3D"m_51968991981=
89442020gmail-m_-5046545257001472313m_8328919070272559881Apple-interchange-=
newline"><div><div dir=3D"ltr">Hey Pitar!<div><br></div><div>I saw that you=
 made a container collection on Singularity Hub (woot!) but that you didn&#=
39;t have any builds. There were a few errors triggered last night, and I w=
anted to get your feedback on if anything went wrong when you were trying t=
o create the builds. It might just be that you built the containers and del=
eted them (and just need to re-push) but if not, I&#39;d like to help walk =
through fixing this up. I&#39;m traveling this morning, but will be back la=
ter this afternoon. Let me know if I can be of help!</div><div><br></div><d=
iv>Best,</div><div><br></div><div>Vanessa<br clear=3D"all"><div><br></div>-=
- <br><div class=3D"m_5196899198189442020gmail-m_-5046545257001472313m_8328=
919070272559881gmail_signature">Vanessa Villamia Sochat<br>Stanford Univers=
ity<br><div><div><div><a href=3D"tel:(603)%20321-0676" value=3D"+1603321067=
6" target=3D"_blank">(603) 321-0676</a></div></div></div></div>
</div></div>
</div></blockquote></div><br></div></div></div></blockquote></div></div></b=
lockquote></div><br></div></div></div></div></div></blockquote></div><br><b=
r clear=3D"all"><div><br></div>-- <br><div class=3D"m_5196899198189442020gm=
ail-m_-5046545257001472313gmail_signature">Vanessa Villamia Sochat<br>Stanf=
ord University<br><div><div><div><a href=3D"tel:(603)%20321-0676" value=3D"=
+16033210676" target=3D"_blank">(603) 321-0676</a></div></div></div></div>
</div>
</div></blockquote></div><br></div></div></div></blockquote></div></div></b=
lockquote></div><br></div></div></div></div></div></blockquote></div><span =
class=3D"HOEnZb"><font color=3D"#888888"><br><br clear=3D"all"><div><br></d=
iv>-- <br><div class=3D"m_5196899198189442020gmail_signature">Vanessa Villa=
mia Sochat<br>Stanford University &#39;16<br><div><div><div><a href=3D"tel:=
(603)%20321-0676" value=3D"+16033210676" target=3D"_blank">(603) 321-0676</=
a></div></div></div></div>
</font></span></div></div><span class=3D"HOEnZb"><font color=3D"#888888">

<p></p>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singularity+u=
nsubscribe@lbl.<wbr>gov</a>.<br>
</font></span></blockquote></div><br><br clear=3D"all"><div><br></div>-- <b=
r><div class=3D"gmail_signature" data-smartmail=3D"gmail_signature"><div di=
r=3D"ltr"><div><div dir=3D"ltr"><div><div dir=3D"ltr"><div><div dir=3D"ltr"=
><div dir=3D"ltr"><div dir=3D"ltr"><div>Gregory M. Kurtzer</div><div>HPC Sy=
stems Architect and Technology Developer</div><div>Lawrence Berkeley Nation=
al Laboratory HPCS<br>University of California Berkeley Research IT<br>Sing=
ularity Linux Containers=C2=A0(<a href=3D"http://singularity.lbl.gov/" targ=
et=3D"_blank">http://singularity.lbl.gov/</a>)</div><div>Warewulf Cluster M=
anagement=C2=A0(<a href=3D"http://warewulf.lbl.gov/" target=3D"_blank">http=
://warewulf.lbl.gov/</a>)</div><div>GitHub:=C2=A0<a href=3D"https://github.=
com/gmkurtzer" target=3D"_blank">https://github.com/gmkurtzer</a>,=C2=A0<sp=
an style=3D"font-size:12.8px">Twitter:=C2=A0</span><a href=3D"https://twitt=
er.com/gmkurtzer" style=3D"font-size:12.8px" target=3D"_blank">https://twit=
ter.com/gmkurtzer</a></div></div></div></div></div></div></div></div></div>=
</div></div>
</div>

--f403045eb55cb320df05493d7534--
