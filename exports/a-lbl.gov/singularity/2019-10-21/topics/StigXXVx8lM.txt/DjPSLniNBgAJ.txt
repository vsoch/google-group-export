X-Received: by 10.107.133.221 with SMTP id p90mr12412524ioi.12.1496770759765;
        Tue, 06 Jun 2017 10:39:19 -0700 (PDT)
X-BeenThere: singularity@lbl.gov
Received: by 10.107.164.193 with SMTP id d62ls999277ioj.17.gmail; Tue, 06 Jun
 2017 10:39:19 -0700 (PDT)
X-Received: by 10.99.113.74 with SMTP id b10mr27933843pgn.139.1496770758825;
        Tue, 06 Jun 2017 10:39:18 -0700 (PDT)
ARC-Seal: i=1; a=rsa-sha256; t=1496770758; cv=none;
        d=google.com; s=arc-20160816;
        b=hRlClisz1p3/nkEwAtNw64Pjgi2YxVF+raghxy/vO9WlY3dBonT5VCx6ny69J/PkCk
         d7i8MHbKGz0GZ5FEsL6S8jBbx3hbsp/FnYHsc+Wk/nZ1VOQR7KUEKtEbdb3uDUvg9f7q
         Ex1GydtfUnYsV6w1D3CHOdKn3Z7Ih52ExrvhRMz3ASOoddEWe65CCrNpyxf+Ywp1BCkf
         SPqaLh4CnybKFdY/T7rgbfEqvw4GrUwzdwDm3UQsjIo38s2Q1aMPAMAaojFauWqD1Ucx
         BrhDQoebcglp1rbF+MXxjfMZ1KC8j8ITX1IF3sgSxN5dfkHYbNF6XQziZGMeQDY4rUIV
         pfGg==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=to:subject:message-id:date:from:references:in-reply-to:mime-version
         :dkim-signature:arc-authentication-results;
        bh=sDxc1h4ldZa8EG6XkimdhoK/bNsRAsIa5VwECSjKod0=;
        b=OkGwuhHZmkGjqIpPFZyXJWS3+FQXiCXlzUzMdgX8CUEJkAPY8fgFzVDp38pgr9lYcG
         T0EfmTDCs/GW8cZxSowPePCJDKhsH0B7eYbjjOH0Lv4/iTkH90hi9q+3P7mvFKkJQ3/+
         Fx/XSaryQ9lnJIDbXkJSQWFERiokv4XGLT5wAP4+gqpxL7rSVs00TYi9ks8fcBpJ1Q2J
         uE/odSvdwDUnhLhmGf2wuKcuHz8ohsRpVVD0tsxGpK8YVrVcvHiAurjBNKmvtij1HHK5
         FshuAprMNdFOSmtAbHAmTYVbnQq/dOuMmKEgv3iEXImgnv74L1m03CRVtXnZ+P3J8VRr
         61Tg==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=pass head...@gmail.com;
       spf=pass (google.com: domain of vso...@gmail.com designates 209.85.217.177 as permitted sender) smtp.mailfrom=vso...@gmail.com
Return-Path: <vso...@gmail.com>
Received: from fe4.lbl.gov (fe4.lbl.gov. [128.3.41.71])
        by mx.google.com with ESMTP id g11si34066050pfk.50.2017.06.06.10.39.18
        for <singu...@lbl.gov>;
        Tue, 06 Jun 2017 10:39:18 -0700 (PDT)
Received-SPF: pass (google.com: domain of vso...@gmail.com designates 209.85.217.177 as permitted sender) client-ip=209.85.217.177;
Authentication-Results: mx.google.com;
       dkim=pass head...@gmail.com;
       spf=pass (google.com: domain of vso...@gmail.com designates 209.85.217.177 as permitted sender) smtp.mailfrom=vso...@gmail.com
X-Ironport-SBRS: 3.4
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A2FZAABK6DZZhrHZVdFbAxsBAQEDAQEBC?=
 =?us-ascii?q?QEBARYBAQEDAQEBCQEBAYJEPAKBDYENB4NkCIEEMohjkgWVf4ExARsbJQMhAQm?=
 =?us-ascii?q?FeQKCXQc/GAEBAQEBAQEBAQEBAhABAQEICwsIKC+CMwUCAwIeBARGIQUBAgMBA?=
 =?us-ascii?q?QEBAQEBAQEBASEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQkCDAM?=
 =?us-ascii?q?cExIBARgBAQEBAgEaCQQZAQ0OEgwDAQsGAwILDRYBCQEJAgIhAQEOAwEFARwOB?=
 =?us-ascii?q?wQBGQECBIg3gTkBAw0IBQuPVJEaP4wHgWwYBQEcgwoFg2MKGScNVoNcAQEBBwE?=
 =?us-ascii?q?BAQEBAQEBGAIGEogvghSBDIJYKSVGTxIBPQwaAQGCSYJhBYlAA4ZtgQlUhHWGd?=
 =?us-ascii?q?zuHJoZXXIRbkX+LPodbFB+BFR94DTMLdBVGGYQ0Kg8QDIIEIDYBAQEFhwcNFzC?=
 =?us-ascii?q?BaQEBAQ?=
X-IronPort-AV: E=Sophos;i="5.39,307,1493708400"; 
   d="scan'208,217";a="77105369"
Received: from mail-ua0-f177.google.com ([209.85.217.177])
  by fe4.lbl.gov with ESMTP; 06 Jun 2017 10:38:39 -0700
Received: by mail-ua0-f177.google.com with SMTP id q15so12368499uaa.2
        for <singu...@lbl.gov>; Tue, 06 Jun 2017 10:38:39 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20161025;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to;
        bh=sDxc1h4ldZa8EG6XkimdhoK/bNsRAsIa5VwECSjKod0=;
        b=D+u7ucKiuZbIDvf1q6rVyrAcHiWaNEFcB7tXuV7W3pv/vjzcpne3l6tw2fiEaNfl2K
         uaBNoBT4SvoYpBepjn9MKSrAoM1Tu54au/qHO0BkAEkwRwuU6o+wnpiGt7zJziMN7aif
         4WhxjjKo9ZZyiNxk8JFQPwc9LYcA5m2AYZD+e7Hy76LpQdxiLAzr66+K4T/KXXobQ/bz
         JtmN/ye1rc2NirhaVfrRgO/H1t2QLbMkyuAbzfxa1mnzB/vTmAVMZEuvx9JCd1KcdgCA
         qB0t1iI8Vxqp43i7Dw/3oKHrmrDspJh37p6AQ3xOA4GUOaDlqDuKioCqzydMQKZ3g8uE
         DqDw==
X-Gm-Message-State: AODbwcDMFkmLM140rPM2osV2R4NxiY7dRarZIE8Ig5IIk1esb7nMNSYc
	bM05APA8WAwt+ZontiExk9PY0c/jm0VAzJk=
X-Received: by 10.176.81.232 with SMTP id h37mr16365852uaa.60.1496770718681;
 Tue, 06 Jun 2017 10:38:38 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.103.49.67 with HTTP; Tue, 6 Jun 2017 10:38:18 -0700 (PDT)
In-Reply-To: <CAM=pu+LZ3+pmkdrZG2Epa59FXTh55=_frfb_rJLGmoW-ugdYnw@mail.gmail.com>
References: <eb2e5586-6bbb-4764-a155-83aea545ded0@lbl.gov> <CAM=pu+JNZw5WSspqPJhxfvVVa+W4CrUatPOFyJd02uNXK7QGsw@mail.gmail.com>
 <705AFBC5-ABBF-45AB-9A0A-F094AC0A7E07@fordham.edu> <CAM=pu+KwqfXQwbxYwZbAifx-rQjFgCoh-4KNwMPLaw8BD1xidg@mail.gmail.com>
 <C734A832-7C37-424C-BDA8-F3003A088C9A@fordham.edu> <6F6BCBDE-B10D-40F5-8D23-AB3470CA7DAA@gmail.com>
 <672F6430-4C6C-4A66-919B-A9C4E7FE4ECB@fordham.edu> <F0A18C08-400E-4362-AD1B-B9DA736F72AB@gmail.com>
 <59F05D2F-47A7-49BC-9F37-D16F845C159D@fordham.edu> <CAA6Bz=f=191vj-Mx29bsDtmt+vwHFp9E7wE9xse34ak762JxDQ@mail.gmail.com>
 <9CF6424D-BCDB-40E8-830C-81CE2F1C5538@fordham.edu> <CAA6Bz=eFXAstGLM8pm+p_PiaMvo8LNb=TGNJn82K+mLuM2BAFg@mail.gmail.com>
 <BDFE338B-2C36-4DE2-B94E-6AAB75FF2615@fordham.edu> <CAA6Bz=dKY7hicKNuGdea9YyHrd+n_cPTLuSS2SW2vb3xZspmug@mail.gmail.com>
 <F920964C-A347-41C8-A231-12A9167A2546@fordham.edu> <CAM=pu+LZ3+pmkdrZG2Epa59FXTh55=_frfb_rJLGmoW-ugdYnw@mail.gmail.com>
From: vanessa s <vso...@gmail.com>
Date: Tue, 6 Jun 2017 10:38:18 -0700
Message-ID: <CAM=pu+Lo+TnjqrcScC3ptiH4Yx-JULHZmXxv9DUS9vCSwHCqfw@mail.gmail.com>
Subject: Re: [Singularity] using Singularity to add Ubuntu to a NPACI Rocks
 Cluster node
To: singularity@lbl.gov
Content-Type: multipart/alternative; boundary="94eb2c18eddaff50d905514e1661"

--94eb2c18eddaff50d905514e1661
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable

And if you want to shell inside (and run doesn't open a shell) you should
just use shell instead:

sudo singularity shell --writable /share/apps/ubuntu.simg

On Tue, Jun 6, 2017 at 10:37 AM, vanessa s <vso...@gmail.com> wrote:

> Almost! To use -w you need to run as root:
>
> sudo singularity run -w /share/apps/ubuntu.simg
>
> On Tue, Jun 6, 2017 at 9:04 AM, Robert Kudyba <rku...@fordham.edu> wrote:
>
>> is this the correct usage of -w?
>>
>> ./singularity run -w /share/apps/ubuntu.simg
>> ERROR  : Could not open image /share/apps/ubuntu.simg: Permission denied
>> ABORT  : Retval =3D 255
>>
>>
>>
>> On Jun 6, 2017, at 11:18 AM, R=C3=A9my Dernat <rem...@gmail.com> wrote:
>>
>> I think you built your image on a machine with uid "426" which is not
>> present on the cluster, so, that's normal. You just have to enter in the
>> container with '-w' flag in root, and edit permissions on your runscript=
 to
>> fit your user on the cluster side.
>>
>> BTW, of course, normally, on Rocks, you had to build your image with:
>> ```
>> ./configure --prefix=3D/share/apps/singularity-install
>> ```
>> Instead of:
>> ```
>> ./configure --prefix=3D/export/apps/singularity-install
>> ```
>> Specially if some binaries contain the path of some files like
>> singularity.conf
>> Sorry for this mistake.
>>
>> Best,
>> R=C3=A9my
>>
>>
>>
>> 2017-06-06 16:55 GMT+02:00 Robert Kudyba <rku...@fordham.edu>:
>>
>>> I was able to delete everything except the var directory:
>>> rmdir session/
>>> rmdir: failed to remove `session/': Device or resource busy
>>> pwd
>>> /share/apps/var/singularity/mnt
>>>
>>> But deleting the source and recloning did get me further. On the head
>>> node I can run singularity commands. But again on the desired node we=
=E2=80=99d
>>> like to run this on we get this:
>>>
>>> ./singularity
>>> Error loading functions: /export/apps/singularity-insta
>>> ll/libexec/singularity/functions
>>>
>>> On the Rocks mailing list I as reminded to do this:
>>> "You need to reference singularity (or any app for that matter) as
>>> /share/apps and never /export/apps
>>>
>>> /export/apps only exists on the head node. "
>>>
>>> So the good news is once I redid everything to use /share/apps I was
>>> able to get the singularity command to work on the compute node.
>>>
>>> So once I tried a command like: ./singularity run
>>> /share/apps/ubuntu.simg
>>> groups: cannot find name for group ID 426
>>>
>>> It looks like I=E2=80=99m in a shell:
>>> ls -l /singularity
>>> lrwxrwxrwx 1 root root 24 Jun  6 14:46 /singularity ->
>>> .singularity.d/runscript
>>>
>>> But is that error/warning normal?
>>>
>>>
>>> On Jun 6, 2017, at 10:01 AM, R=C3=A9my Dernat <rem...@gmail.com> wrote:
>>>
>>> Hi,
>>>
>>> Try to remove every previous install and the install src directory.
>>> Then, logout/login and clone singularity again. Finally, build it from =
a
>>> clean environment.
>>> Let us know if it solves your issue.
>>>
>>> Otherwise, it could be a bug. Try to create a symbolic link to
>>> configuration file where it is searching (/etc/singularity/singularity.
>>> conf).
>>>
>>> Best regards,
>>> R=C3=A9my
>>>
>>> 2017-06-06 15:51 GMT+02:00 Robert Kudyba <rku...@fordham.edu>:
>>>
>>>> OK I did that but still getting the bathing error about the conf file.
>>>> I did find a previous thread mentioning this https://groups.google.com
>>>> /a/lbl.gov/forum/#!topic/singularity/mTPunMFQF4k
>>>> <https://urldefense.proofpoint.com/v2/url?u=3Dhttps-3A__groups.google.=
com_a_lbl.gov_forum_-23-21topic_singularity_mTPunMFQF4k&d=3DDwMFaQ&c=3DaqMf=
XOEvEJQh2iQMCb7Wy8l0sPnURkcqADc2guUW8IM&r=3DX0jL9y0sL4r4iU_qVtR3lLNo4tOL1ry=
_m7-psV3GejY&m=3D6bH1ymxbi1sjYEf1b1I5mFgmrV6i74K8qBLXr92Gwts&s=3D8idh7dZXYf=
lc0-GnBBay6ept9BXftZeazG5A09GHiNA&e=3D> but
>>>> there=E2=80=99s no solution on how to point to an alternative location=
, like a -c
>>>> option. I updated the init file to add /export/apps/singularity-instal=
l
>>>> to the $PATH.
>>>>
>>>>
>>>> ./singularity --debug create /export/apps/ubuntu.simg
>>>> Enabling debugging
>>>> Ending argument loop
>>>> Singularity version: 2.3-master.gda9cd20
>>>> Exec'ing: /export/apps/singularity-install/libexec/singularity/cli/cre
>>>> ate.exec
>>>> VERBOSE [U=3D0,P=3D17149]      message_init()
>>>> Set messagelevel to: 5
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_config_parse()
>>>> Initialize configuration file: /etc/singularity/singularity.conf
>>>> ERROR   [U=3D0,P=3D17149]      singularity_config_parse()
>>>> Specified configuration file /etc/singularity/singularity.conf does
>>>> not appear to be a normal file.
>>>> ERROR   [U=3D0,P=3D17149]      singularity_config_parse()
>>>> Could not open configuration file /etc/singularity/singularity.conf:
>>>> No such file or directory
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_init()
>>>> Initializing Singularity Registry
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Adding value to registry: 'WRITABLE' =3D '1'
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Returning singularity_registry_set(WRITABLE, 1) =3D 0
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Adding value to registry: 'LIBEXECDIR' =3D '/export/apps/singularity-i=
nst
>>>> all/libexec'
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Returning singularity_registry_set(libexecdir,
>>>> /export/apps/singularity-install/libexec) =3D 0
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Adding value to registry: 'COMMAND' =3D 'create'
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Returning singularity_registry_set(COMMAND, create) =3D 0
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Adding value to registry: 'MESSAGELEVEL' =3D '5'
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Returning singularity_registry_set(MESSAGELEVEL, 5) =3D 0
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Adding value to registry: 'VERSION' =3D '2.3-master.gda9cd20'
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Returning singularity_registry_set(version, 2.3-master.gda9cd20) =3D 0
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Adding value to registry: 'LOCALSTATEDIR' =3D '/export/apps/singularit=
y-inst
>>>> all/var'
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Returning singularity_registry_set(localstatedir,
>>>> /export/apps/singularity-install/var) =3D 0
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Adding value to registry: 'SYSCONFDIR' =3D '/export/apps/singularity-i=
nst
>>>> all/etc'
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Returning singularity_registry_set(sysconfdir,
>>>> /export/apps/singularity-install/etc) =3D 0
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Adding value to registry: 'BINDIR' =3D '/export/apps/singularity-inst
>>>> all/bin'
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Returning singularity_registry_set(bindir,
>>>> /export/apps/singularity-install/bin) =3D 0
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Adding value to registry: 'IMAGE' =3D '/export/apps/ubuntu.simg'
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_set()
>>>> Returning singularity_registry_set(IMAGE, /export/apps/ubuntu.simg) =
=3D 0
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_get()
>>>> Returning NULL on 'HOME'
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_get()
>>>> Returning NULL on 'TARGET_UID'
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_registry_get()
>>>> Returning NULL on 'TARGET_GID'
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_priv_init()
>>>> Initializing user info
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_priv_init()
>>>> Set the calling user's username to: root
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_priv_init()
>>>> Marking uinfo structure as ready
>>>> DEBUG   [U=3D0,P=3D17149]      singularity_priv_init()
>>>> Obtaining home directory
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_priv_init()
>>>> Set home (via getpwuid()) to: /root
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_suid_init()
>>>> Running SUID program workflow
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_suid_init()
>>>> Checking program has appropriate permissions
>>>> VERBOSE [U=3D0,P=3D17149]      singularity_suid_init()
>>>> Checking configuration file is properly owned by root
>>>> ABORT   [U=3D0,P=3D17149]      singularity_suid_init()
>>>> Running in privileged mode, root must own the Singularity configuratio=
n
>>>> file: /etc/singularity/singularity.conf
>>>> ABORT   [U=3D0,P=3D17149]      singularity_suid_init()
>>>> Retval =3D 255
>>>>
>>>>
>>>> On Jun 6, 2017, at 2:53 AM, R=C3=A9my Dernat <rem...@gmail.com> wrote:
>>>>
>>>> Hi Robert,
>>>>
>>>> You just have to install singularity on a NFS export; Replace:
>>>>
>>>> ```
>>>>  ./configure --prefix=3D/export/apps/singularity-install
>>>> --sysconfdir=3D/etc
>>>> ```
>>>> With:
>>>> ```
>>>>  ./configure --prefix=3D/export/apps/singularity-install
>>>> ```
>>>>
>>>> Then, it should works as expected.
>>>>
>>>> Do not forget that some singularity commands, like `bootstrap` in 2.3
>>>> or many more in previous release need sudo/root privileges.
>>>>
>>>> Best regards,
>>>> R=C3=A9my
>>>>
>>>> 2017-06-05 23:09 GMT+02:00 Robert Kudyba <rku...@fordham.edu>:
>>>>
>>>>>
>>>>> On Jun 5, 2017, at 4:30 PM, Rick Wagner <richard...@gmail.com>
>>>>> wrote:
>>>>>
>>>>>
>>>>> On Jun 5, 2017, at 4:13 PM, Robert Kudyba <rku...@fordham.edu> wrote:
>>>>>
>>>>>
>>>>> On Jun 5, 2017, at 4:08 PM, Rick Wagner <richard...@gmail.com>
>>>>> wrote:
>>>>>
>>>>> Robert,
>>>>>
>>>>> That=E2=80=99s an NFS export for the Rocks head node that may be moun=
ted nosuid
>>>>>
>>>>>
>>>>> Right in /etc/fstab for other applications we already have this:
>>>>>
>>>>> UUID=3Dxxxxx /export                 ext4    defaults        1 2
>>>>>
>>>>> So what else needs to be done?
>>>>>
>>>>>
>>>>> One option is to build an RPM using the spec file in the Singularity
>>>>> repo and put that in contrib for your Rocks distro along with a packa=
ge tag
>>>>> in extend compute. That=E2=80=99s my preference because I don=E2=80=
=99t like serving
>>>>> applications over NFS, especially ones with setuid.
>>>>>
>>>>> WARNING: the following will allow any executable with a setuid bit in
>>>>> that NFS file system to be run.
>>>>>
>>>>> You can try changing defaults to defaults,suid and remounting the fil=
e
>>>>> system on a compute node.
>>>>>
>>>>>
>>>>> Is this an =E2=80=9Cor=E2=80=9D suggestion? I don=E2=80=99t have a pr=
oblem with changing the
>>>>> /etc/fstab. I did that and ran:
>>>>>   rocks sync config
>>>>>   rocks sync users
>>>>>
>>>>> Also made sure to use the config option as /share/apps (not
>>>>> /export/apps as that=E2=80=99s just for the head node)
>>>>>
>>>>> Still getting:
>>>>> /share/apps/bin
>>>>> ./singularity shell /share/apps/ubuntu.simg
>>>>> ERROR  : Session directory does not exist:
>>>>> /export/apps/var/singularity/mnt/session
>>>>> ABORT  : Retval =3D 255
>>>>>
>>>>> --
>>>>> You received this message because you are subscribed to the Google
>>>>> Groups "singularity" group.
>>>>> To unsubscribe from this group and stop receiving emails from it, sen=
d
>>>>> an email to singu...@lbl.gov.
>>>>>
>>>>
>>>>
>>>> --
>>>> You received this message because you are subscribed to the Google
>>>> Groups "singularity" group.
>>>> To unsubscribe from this group and stop receiving emails from it, send
>>>> an email to singu...@lbl.gov.
>>>>
>>>>
>>>>
>>>> --
>>>> You received this message because you are subscribed to the Google
>>>> Groups "singularity" group.
>>>> To unsubscribe from this group and stop receiving emails from it, send
>>>> an email to singu...@lbl.gov.
>>>>
>>>
>>>
>>> --
>>> You received this message because you are subscribed to the Google
>>> Groups "singularity" group.
>>> To unsubscribe from this group and stop receiving emails from it, send
>>> an email to singu...@lbl.gov.
>>>
>>>
>>>
>>> --
>>> You received this message because you are subscribed to the Google
>>> Groups "singularity" group.
>>> To unsubscribe from this group and stop receiving emails from it, send
>>> an email to singu...@lbl.gov.
>>>
>>
>>
>> --
>> You received this message because you are subscribed to the Google Group=
s
>> "singularity" group.
>> To unsubscribe from this group and stop receiving emails from it, send a=
n
>> email to singu...@lbl.gov.
>>
>>
>> --
>> You received this message because you are subscribed to the Google Group=
s
>> "singularity" group.
>> To unsubscribe from this group and stop receiving emails from it, send a=
n
>> email to singu...@lbl.gov.
>>
>
>
>
> --
> Vanessa Villamia Sochat
> Stanford University '16
> (603) 321-0676
>



--=20
Vanessa Villamia Sochat
Stanford University '16
(603) 321-0676

--94eb2c18eddaff50d905514e1661
Content-Type: text/html; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">And if you want to shell inside (and run doesn&#39;t open =
a shell) you should just use shell instead:<div><br></div><div><span style=
=3D"font-size:12.8px">sudo singularity shell --writable /share/apps/ubuntu.=
simg</span><br></div></div><div class=3D"gmail_extra"><br><div class=3D"gma=
il_quote">On Tue, Jun 6, 2017 at 10:37 AM, vanessa s <span dir=3D"ltr">&lt;=
<a href=3D"mailto:vso...@gmail.com" target=3D"_blank">vso...@gmail.com</a>&=
gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 =
0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir=3D"ltr">Almost=
! To use -w you need to run as root:<div><br></div><div>sudo singularity ru=
n -w /share/apps/ubuntu.simg</div></div><div class=3D"gmail_extra"><div><di=
v class=3D"h5"><br><div class=3D"gmail_quote">On Tue, Jun 6, 2017 at 9:04 A=
M, Robert Kudyba <span dir=3D"ltr">&lt;<a href=3D"mailto:rku...@fordham.edu=
" target=3D"_blank">rku...@fordham.edu</a>&gt;</span> wrote:<br><blockquote=
 class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc soli=
d;padding-left:1ex"><div style=3D"word-wrap:break-word">is this the correct=
 usage of -w?<div><br></div><div><div style=3D"margin:0px;font-size:10px;li=
ne-height:normal;font-family:Menlo"><span style=3D"font-variant-ligatures:n=
o-common-ligatures">./singularity run -w /share/apps/ubuntu.simg=C2=A0</spa=
n></div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-fam=
ily:Menlo;color:rgb(255,59,29)"><span style=3D"font-variant-ligatures:no-co=
mmon-ligatures">ERROR=C2=A0 : Could not open image /share/apps/ubuntu.simg:=
 Permission denied</span></div><div style=3D"margin:0px;font-size:10px;line=
-height:normal;font-family:Menlo;color:rgb(195,55,32)"><span style=3D"font-=
variant-ligatures:no-common-ligatures">ABORT=C2=A0 : Retval =3D 255</span><=
/div><div><div class=3D"m_7931771655240770118h5"><div><span style=3D"font-v=
ariant-ligatures:no-common-ligatures"><br></span></div><div><span style=3D"=
font-variant-ligatures:no-common-ligatures"><br></span></div><div><span sty=
le=3D"font-variant-ligatures:no-common-ligatures"><br></span></div><div><bl=
ockquote type=3D"cite"><div>On Jun 6, 2017, at 11:18 AM, R=C3=A9my Dernat &=
lt;<a href=3D"mailto:rem...@gmail.com" target=3D"_blank">rem...@gmail.com</=
a>&gt; wrote:</div><br class=3D"m_7931771655240770118m_1840847850162928191A=
pple-interchange-newline"><div><div dir=3D"ltr">I think you built your imag=
e on a machine with uid &quot;426&quot; which is not present on the cluster=
, so, that&#39;s normal. You just have to enter in the container with &#39;=
-w&#39; flag in root, and edit permissions on your runscript to fit your us=
er on the cluster side.<div><br></div><div>BTW, of course, normally, on Roc=
ks, you had to build your image with:</div><div>```</div><div><span style=
=3D"font-family:Menlo;font-size:10px;font-variant-ligatures:no-common-ligat=
ures">./configure --prefix=3D/share/apps/singular</span><span style=3D"font=
-family:Menlo;font-size:10px;font-variant-ligatures:no-common-ligatures">i<=
wbr>ty-install</span><br></div><div>```</div><div>Instead of:</div><div><di=
v>```</div><div><span style=3D"font-family:Menlo;font-size:10px;font-varian=
t-ligatures:no-common-ligatures">./configure --prefix=3D/export/apps/singul=
ar</span><span style=3D"font-family:Menlo;font-size:10px;font-variant-ligat=
ures:no-common-ligatures"><wbr>ity-install</span><br></div><div>```</div></=
div><div>Specially if some binaries contain the path of some files like sin=
gularity.conf</div><div>Sorry for this mistake.<br></div><div><br></div><di=
v>Best,</div><div>R=C3=A9my</div><div><br></div><div><br></div></div><div c=
lass=3D"gmail_extra"><br><div class=3D"gmail_quote">2017-06-06 16:55 GMT+02=
:00 Robert Kudyba <span dir=3D"ltr">&lt;<a href=3D"mailto:rku...@fordham.ed=
u" target=3D"_blank">rku...@fordham.edu</a>&gt;</span>:<br><blockquote clas=
s=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;pad=
ding-left:1ex"><div style=3D"word-wrap:break-word"><div>I was able to delet=
e everything except the var directory:=C2=A0</div><div><div style=3D"margin=
:0px;font-size:10px;line-height:normal;font-family:Menlo"><span style=3D"fo=
nt-variant-ligatures:no-common-ligatures">rmdir session/</span></div><div s=
tyle=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo"><sp=
an style=3D"font-variant-ligatures:no-common-ligatures">rmdir: failed to re=
move `session/&#39;: Device or resource busy</span></div><div style=3D"marg=
in:0px;font-size:10px;line-height:normal;font-family:Menlo"><span style=3D"=
font-variant-ligatures:no-common-ligatures">pwd</span></div><div style=3D"m=
argin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span style=
=3D"font-variant-ligatures:no-common-ligatures">/share/apps/var/singularity=
/mn<wbr>t</span></div></div><div><span style=3D"font-variant-ligatures:no-c=
ommon-ligatures"><br></span></div><div>But deleting the source and reclonin=
g did get me further. On the head node I can run singularity commands. But =
again on the desired node we=E2=80=99d like to run this on we get this:</di=
v><div><br></div><div><div style=3D"margin:0px;font-size:10px;line-height:n=
ormal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common-li=
gatures">./singularity=C2=A0</span></div><div style=3D"margin:0px;font-size=
:10px;line-height:normal;font-family:Menlo"><span style=3D"font-variant-lig=
atures:no-common-ligatures">Error loading functions: /export/apps/singulari=
ty-insta<wbr>ll/libexec/singularity/functio<wbr>ns</span></div></div><div><=
br></div><div>On the Rocks mailing list I as reminded to do this:</div><div=
>&quot;You need to reference singularity (or any app for that matter) as /s=
hare/apps and never /export/apps<br><br>/export/apps only exists on the hea=
d node. &quot;</div><div><br></div><div>So the good news is once I redid ev=
erything to use /share/apps I was able to get the singularity command to wo=
rk on the compute node.</div><div><br></div><div>So once I tried a command =
like:=C2=A0<span style=3D"font-family:Menlo;font-size:10px">./singularity r=
un /share/apps/ubuntu.simg</span><span style=3D"font-family:Menlo;font-size=
:10px">=C2=A0</span></div><div style=3D"margin:0px;font-size:10px;line-heig=
ht:normal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-commo=
n-ligatures">groups: cannot find name for group ID 426</span></div><div><br=
></div><div>It looks like I=E2=80=99m in a shell:</div><div><div style=3D"m=
argin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span style=
=3D"font-variant-ligatures:no-common-ligatures">ls -l /singularity=C2=A0</s=
pan></div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-f=
amily:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">lrw=
xrwxrwx 1 root root 24 Jun=C2=A0 6 14:46 /singularity -&gt; .singularity.d/=
runscript</span></div></div><div><br></div><div>But is that error/warning n=
ormal?</div><div><div class=3D"m_7931771655240770118m_1840847850162928191h5=
"><div><br></div><br><div><blockquote type=3D"cite"><div>On Jun 6, 2017, at=
 10:01 AM, R=C3=A9my Dernat &lt;<a href=3D"mailto:rem...@gmail.com" target=
=3D"_blank">rem...@gmail.com</a>&gt; wrote:</div><br class=3D"m_79317716552=
40770118m_1840847850162928191m_-672932233201048330Apple-interchange-newline=
"><div><div dir=3D"ltr">Hi,<div><br></div><div>Try to remove every previous=
 install and the install src directory. Then, logout/login and clone singul=
arity again. Finally, build it from a clean environment.</div><div>Let us k=
now if it solves your issue.</div><div><br></div><div>Otherwise, it could b=
e a bug. Try to create a symbolic link to configuration file where it is se=
arching (/etc/singularity/singularity.<wbr>conf).</div><div><br></div><div>=
Best regards,</div><div>R=C3=A9my</div></div><div class=3D"gmail_extra"><br=
><div class=3D"gmail_quote">2017-06-06 15:51 GMT+02:00 Robert Kudyba <span =
dir=3D"ltr">&lt;<a href=3D"mailto:rku...@fordham.edu" target=3D"_blank">rku=
...@fordham.edu</a>&gt;</span>:<br><blockquote class=3D"gmail_quote" style=
=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div sty=
le=3D"word-wrap:break-word"><div>OK I did that but still getting the bathin=
g error about the conf file. I did find a previous thread mentioning this=
=C2=A0<a href=3D"https://urldefense.proofpoint.com/v2/url?u=3Dhttps-3A__gro=
ups.google.com_a_lbl.gov_forum_-23-21topic_singularity_mTPunMFQF4k&amp;d=3D=
DwMFaQ&amp;c=3DaqMfXOEvEJQh2iQMCb7Wy8l0sPnURkcqADc2guUW8IM&amp;r=3DX0jL9y0s=
L4r4iU_qVtR3lLNo4tOL1ry_m7-psV3GejY&amp;m=3D6bH1ymxbi1sjYEf1b1I5mFgmrV6i74K=
8qBLXr92Gwts&amp;s=3D8idh7dZXYflc0-GnBBay6ept9BXftZeazG5A09GHiNA&amp;e=3D" =
target=3D"_blank">https://groups.google.com<wbr>/a/lbl.gov/forum/#!topic/si=
ngu<wbr>larity/mTPunMFQF4k</a>=C2=A0but there=E2=80=99s no solution on how =
to point to an alternative location, like a -c option. I updated the init f=
ile to add /export/apps/singularity-insta<wbr>ll to the $PATH.</div><div><b=
r></div><div><br></div><div><div style=3D"margin:0px;font-size:10px;line-he=
ight:normal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-com=
mon-ligatures">./singularity --debug create /export/apps/ubuntu.simg</span>=
</div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-famil=
y:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">Enablin=
g debugging</span></div><div style=3D"margin:0px;font-size:10px;line-height=
:normal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common-=
ligatures">Ending argument loop</span></div><div style=3D"margin:0px;font-s=
ize:10px;line-height:normal;font-family:Menlo"><span style=3D"font-variant-=
ligatures:no-common-ligatures">Singularity version: 2.3-master.gda9cd20</sp=
an></div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-fa=
mily:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">Exec=
&#39;ing: /export/apps/singularity-insta<wbr>ll/libexec/singularity/cli/cre=
<wbr>ate.exec</span></div><div style=3D"margin:0px;font-size:10px;line-heig=
ht:normal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-commo=
n-ligatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 message_init()=
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 Set messagelevel to: 5</span></div><div style=3D"m=
argin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span style=
=3D"font-variant-ligatures:no-common-ligatures">VERBOSE [U=3D0,P=3D17149]=
=C2=A0 =C2=A0 =C2=A0 singularity_config_parse()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 Initialize configuration file: /etc/singularity=
/singularity.c<wbr>onf</span></div><div style=3D"margin:0px;font-size:10px;=
line-height:normal;font-family:Menlo;color:rgb(255,59,29)"><span style=3D"f=
ont-variant-ligatures:no-common-ligatures">ERROR =C2=A0 [U=3D0,P=3D17149]=
=C2=A0 =C2=A0 =C2=A0 singularity_config_parse()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 Specified configuration file /etc/singularity/s=
ingularity.c<wbr>onf does not appear to be a normal file.</span></div><div =
style=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo;col=
or:rgb(255,59,29)"><span style=3D"font-variant-ligatures:no-common-ligature=
s">ERROR =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_config_pa=
rse()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Could not open=
 configuration file /etc/singularity/singularity.c<wbr>onf: No such file or=
 directory</span></div><div style=3D"margin:0px;font-size:10px;line-height:=
normal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common-l=
igatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registr=
y_init() =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Initializing Sing=
ularity Registry</span></div><div style=3D"margin:0px;font-size:10px;line-h=
eight:normal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-co=
mmon-ligatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_r=
egistry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Adding=
 value to registry: &#39;WRITABLE&#39; =3D &#39;1&#39;</span></div><div sty=
le=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span=
 style=3D"font-variant-ligatures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=
=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning singularity_registry_set(W=
RITA<wbr>BLE, 1) =3D 0</span></div><div style=3D"margin:0px;font-size:10px;=
line-height:normal;font-family:Menlo"><span style=3D"font-variant-ligatures=
:no-common-ligatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singula=
rity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
Adding value to registry: &#39;LIBEXECDIR&#39; =3D &#39;/export/apps/singul=
arity-inst<wbr>all/libexec&#39;</span></div><div style=3D"margin:0px;font-s=
ize:10px;line-height:normal;font-family:Menlo"><span style=3D"font-variant-=
ligatures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =
=C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 Returning singularity_registry_set(libex<wbr>ecdir, /export/a=
pps/singularity-insta<wbr>ll/libexec) =3D 0</span></div><div style=3D"margi=
n:0px;font-size:10px;line-height:normal;font-family:Menlo"><span style=3D"f=
ont-variant-ligatures:no-common-ligatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =
=C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 Adding value to registry: &#39;COMMAND&#39; =3D &#39;c=
reate&#39;</span></div><div style=3D"margin:0px;font-size:10px;line-height:=
normal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common-l=
igatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_re=
gistry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Returni=
ng singularity_registry_set(COMMA<wbr>ND, create) =3D 0</span></div><div st=
yle=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo"><spa=
n style=3D"font-variant-ligatures:no-common-ligatures">VERBOSE [U=3D0,P=3D1=
7149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Adding value to registry: &#39;MESSAGELE=
VEL&#39; =3D &#39;5&#39;</span></div><div style=3D"margin:0px;font-size:10p=
x;line-height:normal;font-family:Menlo"><span style=3D"font-variant-ligatur=
es:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 =
singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 Returning singularity_registry_set(MESSA<wbr>GELEVEL, 5) =3D 0</span=
></div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-fami=
ly:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">VERBOS=
E [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Adding value to registry: =
&#39;VERSION&#39; =3D &#39;2.3-master.gda9cd20&#39;</span></div><div style=
=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span s=
tyle=3D"font-variant-ligatures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=
=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning singularity_registry_set(v=
ersi<wbr>on, 2.3-master.gda9cd20) =3D 0</span></div><div style=3D"margin:0p=
x;font-size:10px;line-height:normal;font-family:Menlo"><span style=3D"font-=
variant-ligatures:no-common-ligatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=
=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 Adding value to registry: &#39;LOCALSTATEDIR&#39; =3D &#3=
9;/export/apps/singularity-inst<wbr>all/var&#39;</span></div><div style=3D"=
margin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span style=
=3D"font-variant-ligatures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D171=
49]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning singularity_registry_set(local<wb=
r>statedir, /export/apps/singularity-insta<wbr>ll/var) =3D 0</span></div><d=
iv style=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo"=
><span style=3D"font-variant-ligatures:no-common-ligatures">VERBOSE [U=3D0,=
P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Adding value to registry: &#39;SYSCO=
NFDIR&#39; =3D &#39;/export/apps/singularity-inst<wbr>all/etc&#39;</span></=
div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-family:=
Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">DEBUG =C2=
=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning singularity_regi=
stry_set(sysco<wbr>nfdir, /export/apps/singularity-insta<wbr>ll/etc) =3D 0<=
/span></div><div style=3D"margin:0px;font-size:10px;line-height:normal;font=
-family:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">V=
ERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Adding value to regist=
ry: &#39;BINDIR&#39; =3D &#39;/export/apps/singularity-inst<wbr>all/bin&#39=
;</span></div><div style=3D"margin:0px;font-size:10px;line-height:normal;fo=
nt-family:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures"=
>DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_se=
t()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning singul=
arity_registry_set(bindi<wbr>r, /export/apps/singularity-insta<wbr>ll/bin) =
=3D 0</span></div><div style=3D"margin:0px;font-size:10px;line-height:norma=
l;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatu=
res">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set=
()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Adding value to r=
egistry: &#39;IMAGE&#39; =3D &#39;/export/apps/ubuntu.simg&#39;</span></div=
><div style=3D"margin:0px;font-size:10px;line-height:normal;font-family:Men=
lo"><span style=3D"font-variant-ligatures:no-common-ligatures">DEBUG =C2=A0=
 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_set()=C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning singularity_registr=
y_set(IMAGE<wbr>, /export/apps/ubuntu.simg) =3D 0</span></div><div style=3D=
"margin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span styl=
e=3D"font-variant-ligatures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17=
149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_get()=C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning NULL on &#39;HOME&#39;</span></di=
v><div style=3D"margin:0px;font-size:10px;line-height:normal;font-family:Me=
nlo"><span style=3D"font-variant-ligatures:no-common-ligatures">DEBUG =C2=
=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_registry_get()=C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Returning NULL on &#39;TAR=
GET_UID&#39;</span></div><div style=3D"margin:0px;font-size:10px;line-heigh=
t:normal;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common=
-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_=
registry_get()=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Retur=
ning NULL on &#39;TARGET_GID&#39;</span></div><div style=3D"margin:0px;font=
-size:10px;line-height:normal;font-family:Menlo"><span style=3D"font-varian=
t-ligatures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=
=A0 =C2=A0 singularity_priv_init() =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 Initializing user info</span></div><div style=3D"m=
argin:0px;font-size:10px;line-height:normal;font-family:Menlo"><span style=
=3D"font-variant-ligatures:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D171=
49]=C2=A0 =C2=A0 =C2=A0 singularity_priv_init() =C2=A0 =C2=A0 =C2=A0 =C2=A0=
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Set the calling user&#39;s username to:=
 root</span></div><div style=3D"margin:0px;font-size:10px;line-height:norma=
l;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatu=
res">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_priv_in=
it() =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Marking=
 uinfo structure as ready</span></div><div style=3D"margin:0px;font-size:10=
px;line-height:normal;font-family:Menlo"><span style=3D"font-variant-ligatu=
res:no-common-ligatures">DEBUG =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0=
 singularity_priv_init() =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 Obtaining home directory</span></div><div style=3D"margin:0px=
;font-size:10px;line-height:normal;font-family:Menlo"><span style=3D"font-v=
ariant-ligatures:no-common-ligatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=
=A0 =C2=A0 singularity_priv_init() =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 Set home (via getpwuid()) to: /root</span></div><d=
iv style=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo"=
><span style=3D"font-variant-ligatures:no-common-ligatures">VERBOSE [U=3D0,=
P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_suid_init() =C2=A0 =C2=A0 =C2=A0=
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Running SUID program workflow</s=
pan></div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-f=
amily:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">VER=
BOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_suid_init() =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Checking program ha=
s appropriate permissions</span></div><div style=3D"margin:0px;font-size:10=
px;line-height:normal;font-family:Menlo"><span style=3D"font-variant-ligatu=
res:no-common-ligatures">VERBOSE [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 sing=
ularity_suid_init() =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0=
 =C2=A0 Checking configuration file is properly owned by root</span></div><=
div style=3D"margin:0px;font-size:10px;line-height:normal;font-family:Menlo=
;color:rgb(195,55,32)"><span style=3D"font-variant-ligatures:no-common-liga=
tures">ABORT =C2=A0 [U=3D0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_suid_=
init() =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Runni=
ng in privileged mode, root must own the Singularity configuration file: /e=
tc/singularity/singularity.c<wbr>onf</span></div><div style=3D"margin:0px;f=
ont-size:10px;line-height:normal;font-family:Menlo;color:rgb(195,55,32)"><s=
pan style=3D"font-variant-ligatures:no-common-ligatures">ABORT =C2=A0 [U=3D=
0,P=3D17149]=C2=A0 =C2=A0 =C2=A0 singularity_suid_init() =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Retval =3D 255</span></div></=
div><div><div class=3D"m_7931771655240770118m_1840847850162928191m_-6729322=
33201048330h5"><div><span style=3D"font-variant-ligatures:no-common-ligatur=
es"><br></span></div><br><div><blockquote type=3D"cite"><div>On Jun 6, 2017=
, at 2:53 AM, R=C3=A9my Dernat &lt;<a href=3D"mailto:rem...@gmail.com" targ=
et=3D"_blank">rem...@gmail.com</a>&gt; wrote:</div><br class=3D"m_793177165=
5240770118m_1840847850162928191m_-672932233201048330m_9141356409832340507Ap=
ple-interchange-newline"><div><div dir=3D"ltr">Hi Robert,<div><br></div><di=
v>You just have to install singularity on a NFS export; Replace:</div><div>=
<br></div><div>```</div><div><span style=3D"font-variant-ligatures:no-commo=
n-ligatures;font-family:Menlo;font-size:10px">=C2=A0</span><span style=3D"f=
ont-variant-ligatures:no-common-ligatures;font-family:Menlo;font-size:10px"=
>./configure --prefix=3D/export/apps/singular<wbr>ity-install --sysconfdir=
=3D/etc</span><br></div><div>```</div><div>With:</div><div>```</div><div><s=
pan style=3D"font-variant-ligatures:no-common-ligatures;font-family:Menlo;f=
ont-size:10px">=C2=A0</span><span style=3D"font-variant-ligatures:no-common=
-ligatures;font-family:Menlo;font-size:10px">./configure --prefix=3D/export=
/apps/singular<wbr>ity-install</span><br></div><div>```</div><div><br></div=
><div>Then, it should works as expected.</div><div><br></div><div>Do not fo=
rget that some singularity commands, like `bootstrap` in 2.3 or many more i=
n previous release need sudo/root privileges.</div><div><br></div><div>Best=
 regards,<br>R=C3=A9my</div></div><div class=3D"gmail_extra"><br><div class=
=3D"gmail_quote">2017-06-05 23:09 GMT+02:00 Robert Kudyba <span dir=3D"ltr"=
>&lt;<a href=3D"mailto:rku...@fordham.edu" target=3D"_blank">rku...@fordham=
.edu</a>&gt;</span>:<br><blockquote class=3D"gmail_quote" style=3D"margin:0=
 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div style=3D"word-w=
rap:break-word"><span><br><div><blockquote type=3D"cite"><div>On Jun 5, 201=
7, at 4:30 PM, Rick Wagner &lt;<a href=3D"mailto:richard...@gmail.com" targ=
et=3D"_blank">richard...@gmail.com</a>&gt; wrote:</div><br class=3D"m_79317=
71655240770118m_1840847850162928191m_-672932233201048330m_91413564098323405=
07m_-5619588665609687384Apple-interchange-newline"><div><div style=3D"word-=
wrap:break-word"><br><div><blockquote type=3D"cite"><div>On Jun 5, 2017, at=
 4:13 PM, Robert Kudyba &lt;<a href=3D"mailto:rku...@fordham.edu" target=3D=
"_blank">rku...@fordham.edu</a>&gt; wrote:</div><br class=3D"m_793177165524=
0770118m_1840847850162928191m_-672932233201048330m_9141356409832340507m_-56=
19588665609687384Apple-interchange-newline"><div><div style=3D"word-wrap:br=
eak-word"><br><div><blockquote type=3D"cite"><div>On Jun 5, 2017, at 4:08 P=
M, Rick Wagner &lt;<a href=3D"mailto:richard...@gmail.com" target=3D"_blank=
">richard...@gmail.com</a>&gt; wrote:</div><br class=3D"m_79317716552407701=
18m_1840847850162928191m_-672932233201048330m_9141356409832340507m_-5619588=
665609687384Apple-interchange-newline"><div><div style=3D"word-wrap:break-w=
ord"><div>Robert,</div><div><br></div><div>That=E2=80=99s an NFS export for=
 the Rocks head node that may be mounted nosuid</div></div></div></blockquo=
te><br></div><div>Right in /etc/fstab for other applications we already hav=
e this:</div><div><br></div><div><div style=3D"margin:0px;font-size:10px;li=
ne-height:normal;font-family:Menlo"><span style=3D"font-variant-ligatures:n=
o-common-ligatures">UUID=3Dxxxxx /export =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0=
 =C2=A0 =C2=A0 =C2=A0 ext4=C2=A0 =C2=A0 defaults=C2=A0 =C2=A0 =C2=A0 =C2=A0=
 1 2</span></div><div><span style=3D"font-variant-ligatures:no-common-ligat=
ures"><br></span></div></div>So what else needs to be done?</div></div></bl=
ockquote><div><br></div><div>One option is to build an RPM using the spec f=
ile in the Singularity repo and put that in contrib for your Rocks distro a=
long with a package tag in extend compute. That=E2=80=99s my preference bec=
ause I don=E2=80=99t like serving applications over NFS, especially ones wi=
th setuid.</div><div><br></div><div>WARNING: the following will allow any e=
xecutable with a setuid bit in that NFS file system to be run.</div><div><b=
r></div><div>You can try changing defaults to defaults,suid and remounting =
the file system on a compute node.</div></div></div></div></blockquote><br>=
</div></span><div>Is this an =E2=80=9Cor=E2=80=9D suggestion? I don=E2=80=
=99t have a problem with changing the /etc/fstab. I did that and ran:</div>=
<div><div style=3D"margin:0px;font-size:10px;line-height:normal;font-family=
:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatures">=C2=A0=
=C2=A0rocks sync config</span></div><div style=3D"margin:0px;font-size:10px=
;line-height:normal;font-family:Menlo"><span style=3D"font-variant-ligature=
s:no-common-ligatures">=C2=A0 rocks sync users</span></div><div style=3D"ma=
rgin:0px;font-size:10px;line-height:normal;font-family:Menlo"><br></div></d=
iv>Also made sure to use the config option as /share/apps (not /export/apps=
 as that=E2=80=99s just for the head node)<div><br></div><div>Still getting=
:</div><div><div><div style=3D"margin:0px;font-size:10px;line-height:normal=
;font-family:Menlo"><span style=3D"font-variant-ligatures:no-common-ligatur=
es">/share/apps/bin</span></div></div><div><div style=3D"margin:0px;font-si=
ze:10px;line-height:normal;font-family:Menlo"><div style=3D"margin:0px;line=
-height:normal"><span style=3D"font-variant-ligatures:no-common-ligatures">=
./singularity shell /share/apps/ubuntu.simg</span></div><span><div style=3D=
"margin:0px;line-height:normal;color:rgb(255,59,29)"><span style=3D"font-va=
riant-ligatures:no-common-ligatures">ERROR=C2=A0 : Session directory does n=
ot exist: /export/apps/var/singularity/m<wbr>nt/session</span></div><div st=
yle=3D"margin:0px;line-height:normal;color:rgb(195,55,32)"><span style=3D"f=
ont-variant-ligatures:no-common-ligatures">ABORT=C2=A0 : Retval =3D 255</sp=
an></div></span></div></div></div></div><div><br class=3D"m_793177165524077=
0118m_1840847850162928191m_-672932233201048330m_9141356409832340507webkit-b=
lock-placeholder"></div>

-- <br><div class=3D"m_7931771655240770118m_1840847850162928191m_-672932233=
201048330m_9141356409832340507HOEnZb"><div class=3D"m_7931771655240770118m_=
1840847850162928191m_-672932233201048330m_9141356409832340507h5">
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singularity+u=
nsubscribe@lbl.go<wbr>v</a>.<br>
</div></div></blockquote></div><br></div><div><br class=3D"m_79317716552407=
70118m_1840847850162928191m_-672932233201048330m_9141356409832340507webkit-=
block-placeholder"></div>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singularity+u=
nsubscribe@lbl.go<wbr>v</a>.<br>
</div></blockquote></div><br></div></div></div><div class=3D"m_793177165524=
0770118m_1840847850162928191m_-672932233201048330HOEnZb"><div class=3D"m_79=
31771655240770118m_1840847850162928191m_-672932233201048330h5"><div><br cla=
ss=3D"m_7931771655240770118m_1840847850162928191m_-672932233201048330webkit=
-block-placeholder"></div>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singularity+u=
nsubscribe@lbl.go<wbr>v</a>.<br>
</div></div></blockquote></div><br></div><div><br class=3D"m_79317716552407=
70118m_1840847850162928191m_-672932233201048330webkit-block-placeholder"></=
div>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singularity+u=
nsubscribe@lbl.go<wbr>v</a>.<br>
</div></blockquote></div><br></div></div></div><div class=3D"m_793177165524=
0770118m_1840847850162928191HOEnZb"><div class=3D"m_7931771655240770118m_18=
40847850162928191h5"><div><br class=3D"m_7931771655240770118m_1840847850162=
928191webkit-block-placeholder"></div>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singularity+u=
nsubscribe@lbl.go<wbr>v</a>.<br>
</div></div></blockquote></div><br></div><div><br class=3D"m_79317716552407=
70118m_1840847850162928191webkit-block-placeholder"></div>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singularity+u=
nsubscribe@lbl.go<wbr>v</a>.<br>
</div></blockquote></div><br></div></div></div></div><div class=3D"m_793177=
1655240770118HOEnZb"><div class=3D"m_7931771655240770118h5">

<p></p>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singularity+u=
nsubscribe@lbl.go<wbr>v</a>.<br>
</div></div></blockquote></div><br><br clear=3D"all"><div><br></div></div><=
/div><span class=3D"">-- <br><div class=3D"m_7931771655240770118gmail_signa=
ture" data-smartmail=3D"gmail_signature">Vanessa Villamia Sochat<br>Stanfor=
d University &#39;16<br><div><div><div><a href=3D"tel:(603)%20321-0676" val=
ue=3D"+16033210676" target=3D"_blank">(603) 321-0676</a></div></div></div><=
/div>
</span></div>
</blockquote></div><br><br clear=3D"all"><div><br></div>-- <br><div class=
=3D"gmail_signature" data-smartmail=3D"gmail_signature">Vanessa Villamia So=
chat<br>Stanford University &#39;16<br><div><div><div>(603) 321-0676</div><=
/div></div></div>
</div>

--94eb2c18eddaff50d905514e1661--
