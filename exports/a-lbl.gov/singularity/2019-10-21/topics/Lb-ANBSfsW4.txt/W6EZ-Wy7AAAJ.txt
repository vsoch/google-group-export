X-Received: by 10.99.55.22 with SMTP id e22mr3314458pga.58.1498576264204;
        Tue, 27 Jun 2017 08:11:04 -0700 (PDT)
X-BeenThere: singularity@lbl.gov
Received: by 10.107.48.16 with SMTP id w16ls3815840iow.24.gmail; Tue, 27 Jun
 2017 08:11:03 -0700 (PDT)
X-Received: by 10.99.5.82 with SMTP id 79mr5716350pgf.134.1498576262744;
        Tue, 27 Jun 2017 08:11:02 -0700 (PDT)
ARC-Seal: i=1; a=rsa-sha256; t=1498576262; cv=none;
        d=google.com; s=arc-20160816;
        b=SrA3qEEiOJo4IYyclZ/CzltmTwOqVb2S1CDbpsPAPRC6qfxQn9KmI9c9hZFtaw8EXg
         BxBONuiwNMEyLcXpADfeXJQ6tqxwVxIkkq8Qam1ocQUwRN1ZtzcjUiV6w/9WCu5HMHDj
         1Rxbqzy00E3G3fT0HZ1tCaVV37Z1DmDnVPuxUkYnYRtBa/0HHaLgRY+zh9RR00KUOeZB
         ebZJ1qDPTN36XynOi04gW3zXzmZn4f3iOiYb3Xa5D0FTX6CgprPaTD8BG/q5ZAZV2pgH
         3Fvjy7ocx/CaXyR2MNp8KIzzMVZfEe0lnfAdZ3qXdhCVbM79c+6/QCm0RY5LaLgagRkl
         FKiw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=to:subject:message-id:date:from:references:in-reply-to:mime-version
         :dkim-signature:arc-authentication-results;
        bh=n3+pCvp0aLeZ3rnFSsUJl5L7A/Nr/Vy24oiU6LCANwg=;
        b=snaNnHrva1//jTQm4XHT3KWB8/wrB7iv83HK6Dx6K3xkFF0veIlQMlgImszfJcliza
         mfxt3I8m34heF+OZ4kc/hRSLu2R16G5QKtxxt/TdbNCiSz80w6wbbByoahO/PwsvAEBU
         VY0e00PP3AFww5kM93SiAdcNmaTTTl8L1ldZ0wC3TtapAoR1lh10eErpOpdFSZYspPLp
         dsZYmBBOf+WiuGKG5nk9nXRo9Wm4HjRWIO4n6cKY6D6FO0wBa+Fd00kaH/orUSXr3DuH
         aH/IM5Nit6DvtPEdkmgAx7e9cCAxwPDKo60w9ragMaYJnK0MQpzrOXuutBnkgnmQV363
         wTVA==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=pass head...@gmail.com header.b=JvOWHpAb;
       spf=pass (google.com: domain of vso...@gmail.com designates 209.85.213.45 as permitted sender) smtp.mailfrom=vso...@gmail.com
Return-Path: <vso...@gmail.com>
Received: from fe4.lbl.gov (fe4.lbl.gov. [128.3.41.71])
        by mx.google.com with ESMTP id z44si2268828plh.218.2017.06.27.08.11.02
        for <singu...@lbl.gov>;
        Tue, 27 Jun 2017 08:11:02 -0700 (PDT)
Received-SPF: pass (google.com: domain of vso...@gmail.com designates 209.85.213.45 as permitted sender) client-ip=209.85.213.45;
Authentication-Results: mx.google.com;
       dkim=pass head...@gmail.com header.b=JvOWHpAb;
       spf=pass (google.com: domain of vso...@gmail.com designates 209.85.213.45 as permitted sender) smtp.mailfrom=vso...@gmail.com
X-Ironport-SBRS: 3.4
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A2GZAAAwdFJZhi3VVdFZAxwBAQQBAQoBA?=
 =?us-ascii?q?RcBAQQBAQoBAYJEPoEOgQ4Hg10IgTaIY5FmgmuPVoM8gU4bKCEBCoFvU4M7AoJ?=
 =?us-ascii?q?1Bz8YAQEBAQEBAQEBAQECEAEBAQgLCwgoL4IzBQIDGgYEBEYmAy4BAQEBAQEBA?=
 =?us-ascii?q?QEBAQEBAQEBGgINHgQPEgEBGAEBAQECARoBCAQZAQ0OHgMMBgULCgMgAQkCAiE?=
 =?us-ascii?q?BAQ4DAQUBCxEOBwQBHASIPYE5AQMNCAULo28/jAmBbBgFARyDCAWDXgoZJw1Wg?=
 =?us-ascii?q?0ABAQEHAQEBAQEBAQEYAgYSgxWFLYIYgQyCV4FkDAYBPQwagkyCYQWJTXqHB1S?=
 =?us-ascii?q?MEjuHNocDS4RnggoZPYhhhlOJK4IOL4d0FB+BFQ8QgQUzC3QVSRmEPyoPEAyCB?=
 =?us-ascii?q?iA2AQeGVQEOFwQsgWkBAQE?=
X-IronPort-AV: E=Sophos;i="5.39,401,1493708400"; 
   d="scan'208,217";a="79839727"
Received: from mail-vk0-f45.google.com ([209.85.213.45])
  by fe4.lbl.gov with ESMTP; 27 Jun 2017 08:10:32 -0700
Received: by mail-vk0-f45.google.com with SMTP id y70so17587006vky.3
        for <singu...@lbl.gov>; Tue, 27 Jun 2017 08:10:32 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20161025;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to;
        bh=n3+pCvp0aLeZ3rnFSsUJl5L7A/Nr/Vy24oiU6LCANwg=;
        b=JvOWHpAbDKJ3l82xJfUD3ZbBFogqAASdh7FrnFg2KiCoBWgQHIoqZ/fit3aWOHPBXB
         EBIAp9LNtg3/GAHWEZ/Yz7bdjMAQz73qX8bublwTr2lHpOz9/c/wvTihO2zXPtiz1TUd
         UtuSIqGWzciPoZzsQjF9WgDjypPTqDNDI/C9dL5kwjhPNPUYm7TYLDB4h7znR4tvUG/z
         FaW12E//K7sj5ZssAMaW88OCa4wHvMa8r/ni5TT+95ItDTl0PSiPj0+bh0ONaCdkh1WD
         43fV7o89XvHpB9seGHaubfkLN+9GunSQQse7zEPswzKJscMg/hA/QMYB9EQxUNf2zNaj
         5Qqg==
X-Gm-Message-State: AKS2vOweILxT6Ki+w+QjDfqHQuOli9wciUSLXQ+qNxQdzYsynz7zsbmq
	ddCGC2VeZm5DvSld17kn6JhJv5T0q9hy
X-Received: by 10.31.150.195 with SMTP id y186mr2965362vkd.149.1498576231569;
 Tue, 27 Jun 2017 08:10:31 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.103.46.150 with HTTP; Tue, 27 Jun 2017 08:10:11 -0700 (PDT)
In-Reply-To: <144de14f-4399-4c7c-a04f-61a6a3ab830f@lbl.gov>
References: <e8c29047-8a78-4ddb-8635-f702910dbc51@lbl.gov> <CAM=pu++FZofp5z=40+dvmgcVmdmmHna4dUyQwcXsEY6TdW602g@mail.gmail.com>
 <5fba31e6-c9e1-4953-9a32-aa7498f84fdb@lbl.gov> <CAM=pu+JpmeSmSZ-Xg==+j6zRgQS6bdOS185BxWKVX0fRdDvh0w@mail.gmail.com>
 <144de14f-4399-4c7c-a04f-61a6a3ab830f@lbl.gov>
From: vanessa s <vso...@gmail.com>
Date: Tue, 27 Jun 2017 08:10:11 -0700
Message-ID: <CAM=pu+LSsAO2To3S0hjkYk8f1jKxDDN-=1mF3tBSih9Yn_jQrg@mail.gmail.com>
Subject: Re: [Singularity] Basic question
To: singularity@lbl.gov
Content-Type: multipart/alternative; boundary="001a1141dedaf3a4580552f27753"

--001a1141dedaf3a4580552f27753
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable

Hi Charles,

Does that software exist inside the image? I don't see a line to install
anything called xenome, and it looks like you are binding. Does shell work?
You might try shell, and if it works, then try looking in /usr/local/bin to
see what is there. If you need software on your host in the container you
can either install it in the container (more reproducible) or bind the
directory it is in.

Best,

Vanessa

On Tue, Jun 27, 2017 at 7:56 AM, Charles Murphy <murphy....@gmail.com>
wrote:

>
>
> chm2059@cannes chm2059 $ singularity --debug exec gossamer.img /usr/local=
/bin/xenome -h
> Enabling debugging
> Ending argument loop
> Singularity version: 2.3-dist
> Exec'ing: /usr/libexec/singularity/cli/exec.exec
> Evaluating args: 'gossamer.img /usr/local/bin/xenome -h'
> VERBOSE [U=3D0,P=3D79809]      message_init()                            =
Set messagelevel to: 5
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Initialize configuration file: /etc/singularity/singularity.conf
> DEBUG   [U=3D0,P=3D79809]      singularity_config_parse()                =
Starting parse of configuration file /etc/singularity/singularity.conf
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key allow setuid =3D 'yes'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key allow pid ns =3D 'no'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key allow user image =3D 'yes'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key protected image mode =3D 'none'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key enable overlay =3D 'no'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key config passwd =3D 'yes'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key config group =3D 'yes'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key config resolv_conf =3D 'yes'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key mount proc =3D 'yes'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key mount sys =3D 'yes'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key mount dev =3D 'yes'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key mount home =3D 'yes'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key mount tmp =3D 'yes'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key mount hostfs =3D 'yes'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key bind path =3D '/etc/hosts'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key user bind control =3D 'yes'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key mount slave =3D 'yes'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key container dir =3D '/var/lib/singularity/mnt'
> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                =
Got config key singularity user =3D 'singularity'
> DEBUG   [U=3D0,P=3D79809]      singularity_config_parse()                =
Finished parsing configuration file '/etc/singularity/singularity.conf'
> VERBOSE [U=3D0,P=3D79809]      singularity_registry_init()               =
Initializing Singularity Registry
> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                =
Adding value to registry: 'SHELL' =3D '/bin/bash --norc'
> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                =
Returning singularity_registry_set(SHELL, /bin/bash --norc) =3D 0
> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                =
Adding value to registry: 'LIBEXECDIR' =3D '/usr/libexec'
> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                =
Returning singularity_registry_set(libexecdir, /usr/libexec) =3D 0
> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                =
Adding value to registry: 'COMMAND' =3D 'exec'
> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                =
Returning singularity_registry_set(COMMAND, exec) =3D 0
> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                =
Adding value to registry: 'MESSAGELEVEL' =3D '5'
> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                =
Returning singularity_registry_set(MESSAGELEVEL, 5) =3D 0
> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                =
Adding value to registry: 'VERSION' =3D '2.3-dist'
> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                =
Returning singularity_registry_set(version, 2.3-dist) =3D 0
> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                =
Adding value to registry: 'LOCALSTATEDIR' =3D '/var'
> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                =
Returning singularity_registry_set(localstatedir, /var) =3D 0
> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                =
Adding value to registry: 'SYSCONFDIR' =3D '/etc'
> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                =
Returning singularity_registry_set(sysconfdir, /etc) =3D 0
> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                =
Adding value to registry: 'BINDIR' =3D '/usr/bin'
> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                =
Returning singularity_registry_set(bindir, /usr/bin) =3D 0
> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                =
Adding value to registry: 'IMAGE' =3D 'gossamer.img'
> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                =
Returning singularity_registry_set(IMAGE, gossamer.img) =3D 0
> DEBUG   [U=3D0,P=3D79809]      singularity_registry_get()                =
Returning NULL on 'HOME'
> DEBUG   [U=3D0,P=3D79809]      singularity_registry_get()                =
Returning NULL on 'TARGET_UID'
> DEBUG   [U=3D0,P=3D79809]      singularity_registry_get()                =
Returning NULL on 'TARGET_GID'
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_init()                   =
Initializing user info
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_init()                   =
Set the calling user's username to: chm2059
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_init()                   =
Marking uinfo structure as ready
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_init()                   =
Obtaining home directory
> VERBOSE [U=3D0,P=3D79809]      singularity_priv_init()                   =
Set home (via getpwuid()) to: /home/chm2059
> VERBOSE [U=3D0,P=3D79809]      singularity_suid_init()                   =
Running SUID program workflow
> VERBOSE [U=3D0,P=3D79809]      singularity_suid_init()                   =
Checking program has appropriate permissions
> VERBOSE [U=3D0,P=3D79809]      singularity_suid_init()                   =
Checking configuration file is properly owned by root
> VERBOSE [U=3D0,P=3D79809]      singularity_suid_init()                   =
Checking if singularity.conf allows us to run as suid
> DEBUG   [U=3D0,P=3D79809]      singularity_config_get_bool_char_impl()   =
Called singularity_config_get_bool(allow setuid, yes)
> DEBUG   [U=3D0,P=3D79809]      singularity_config_get_value_impl()       =
Returning configuration value allow setuid=3D'yes'
> DEBUG   [U=3D0,P=3D79809]      singularity_config_get_bool_char_impl()   =
Return singularity_config_get_bool(allow setuid, yes) =3D 1
> DEBUG   [U=3D0,P=3D79809]      singularity_registry_get()                =
Returning NULL on 'NOSUID'
> VERBOSE [U=3D0,P=3D79809]      singularity_priv_userns()                 =
Invoking the user namespace
> DEBUG   [U=3D0,P=3D79809]      singularity_config_get_bool_char_impl()   =
Called singularity_config_get_bool(allow user ns, yes)
> DEBUG   [U=3D0,P=3D79809]      singularity_config_get_value_impl()       =
No configuration entry found for 'allow user ns'; returning default value '=
yes'
> DEBUG   [U=3D0,P=3D79809]      singularity_config_get_bool_char_impl()   =
Return singularity_config_get_bool(allow user ns, yes) =3D 1
> VERBOSE [U=3D0,P=3D79809]      singularity_priv_userns()                 =
Not virtualizing USER namespace: running as SUID
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_userns()                 =
Returning singularity_priv_init(void)
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   =
Dropping privileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   =
Restoring supplementary groups
> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_drop()                   =
Confirming we have correct UID/GID
> DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_ns()                  =
Calling: _singularity_runtime_ns_pid()
> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_char_impl()   =
Called singularity_config_get_bool(allow pid ns, yes)
> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_impl()       =
Returning configuration value allow pid ns=3D'no'
> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_char_impl()   =
Return singularity_config_get_bool(allow pid ns, yes) =3D 0
> VERBOSE [U=3D8693,P=3D79809]   singularity_runtime_ns_pid()              =
Not virtualizing PID namespace by configuration
> DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_ns()                  =
Calling: _singularity_runtime_ns_ipc()
> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_char_impl()   =
Called singularity_config_get_bool(allow ipc ns, yes)
> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_impl()       =
No configuration entry found for 'allow ipc ns'; returning default value 'y=
es'
> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_char_impl()   =
Return singularity_config_get_bool(allow ipc ns, yes) =3D 1
> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                =
Returning NULL on 'UNSHARE_IPC'
> VERBOSE [U=3D8693,P=3D79809]   singularity_runtime_ns_ipc()              =
Not virtualizing IPC namespace on user request
> DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_ns()                  =
Calling: _singularity_runtime_ns_mnt()
> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_char_impl()   =
Called singularity_config_get_bool(mount slave, yes)
> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_impl()       =
Returning configuration value mount slave=3D'yes'
> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_char_impl()   =
Return singularity_config_get_bool(mount slave, yes) =3D 1
> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_escalate()               =
Temporarily escalating privileges (U=3D8693)
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_escalate()               =
Clearing supplementary GIDs.
> DEBUG   [U=3D0,P=3D79809]      singularity_runtime_ns_mnt()              =
Virtualizing FS namespace
> DEBUG   [U=3D0,P=3D79809]      singularity_runtime_ns_mnt()              =
Virtualizing mount namespace
> DEBUG   [U=3D0,P=3D79809]      singularity_runtime_ns_mnt()              =
Making mounts slave
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   =
Dropping privileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   =
Restoring supplementary groups
> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_drop()                   =
Confirming we have correct UID/GID
> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  =
Setting sessiondir
> VERBOSE [U=3D8693,P=3D79809]   singularity_sessiondir()                  =
Using session directory: /var/singularity/mnt/session
> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  =
Checking for session directory: /var/singularity/mnt/session
> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  =
Obtaining the default sessiondir size
> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_impl()       =
No configuration entry found for 'sessiondir max size'; returning default v=
alue '16'
> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  =
Converted sessiondir size to: 16
> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  =
Creating the sessiondir size mount option length
> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  =
Got size length of: 9
> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  =
Creating the sessiondir size mount option string
> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  =
Checking to make sure the string was allocated correctly
> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_escalate()               =
Temporarily escalating privileges (U=3D8693)
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_escalate()               =
Clearing supplementary GIDs.
> DEBUG   [U=3D0,P=3D79809]      singularity_sessiondir()                  =
Mounting sessiondir tmpfs: /var/singularity/mnt/session
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   =
Dropping privileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   =
Restoring supplementary groups
> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_drop()                   =
Confirming we have correct UID/GID
> VERBOSE [U=3D8693,P=3D79809]   singularity_registry_set()                =
Adding value to registry: 'SESSIONDIR' =3D '/var/singularity/mnt/session'
> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_set()                =
Returning singularity_registry_set(SESSIONDIR, /var/singularity/mnt/session=
) =3D 0
> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                =
Returning NULL on 'CLEANUPDIR'
> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                =
Returning NULL on 'NOSESSIONCLEANUP'
> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                =
Returning NULL on 'NOCLEANUP'
> DEBUG   [U=3D8693,P=3D79809]   singularity_cleanupd()                    =
Not running a cleanup thread, no 'SINGULARITY_CLEANUPDIR' defined
> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                =
Returning value from registry: 'IMAGE' =3D 'gossamer.img'
> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                =
Returning NULL on 'WRITABLE'
> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_impl()       =
No configuration entry found for 'limit container owners'; returning defaul=
t value 'NULL'
> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_impl()       =
No configuration entry found for 'limit container paths'; returning default=
 value 'NULL'
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_open()                  =
Opening file descriptor to image: gossamer.img
> VERBOSE [U=3D8693,P=3D79809]   singularity_image_check()                 =
Checking that file pointer is a Singularity image
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_check()                 =
First line of image(fd=3D6): #!/usr/bin/env run-singularity
>
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_check()                 =
Checking if first line matches key
> VERBOSE [U=3D8693,P=3D79809]   singularity_image_check()                 =
File is not a valid Singularity image
> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_impl()       =
No configuration entry found for 'max loop devices'; returning default valu=
e '256'
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  =
Entered singularity_image_bind()
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  =
Converting max_loop_devs_string to int: '256'
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  =
Converted max_loop_devs_string to int: '256' -> 256
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  =
Checking if this image has been properly opened
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  =
Checking if image is valid file
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  =
Checking if image is already bound to a loop device
> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                =
Returning NULL on 'WRITABLE'
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  =
Setting loopdev open to: O_RDONLY
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  =
Setting LO_FLAGS_AUTOCLEAR
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  =
Calculating image offset
> VERBOSE [U=3D8693,P=3D79809]   singularity_image_check()                 =
Checking that file pointer is a Singularity image
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_check()                 =
First line of image(fd=3D6): #!/usr/bin/env run-singularity
>
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_check()                 =
Checking if first line matches key
> VERBOSE [U=3D8693,P=3D79809]   singularity_image_check()                 =
File is not a valid Singularity image
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_offset()                =
File is not a Singularity image, returning zero offset
> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_escalate()               =
Temporarily escalating privileges (U=3D8693)
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_escalate()               =
Clearing supplementary GIDs.
> DEBUG   [U=3D0,P=3D79809]      singularity_image_bind()                  =
Finding next available loop device...
> VERBOSE [U=3D0,P=3D79809]      singularity_image_bind()                  =
Found available loop device: /dev/loop0
> DEBUG   [U=3D0,P=3D79809]      singularity_image_bind()                  =
Setting loop device flags
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   =
Dropping privileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   =
Restoring supplementary groups
> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_drop()                   =
Confirming we have correct UID/GID
> VERBOSE [U=3D8693,P=3D79809]   singularity_image_bind()                  =
Using loop device: /dev/loop0
> VERBOSE [U=3D8693,P=3D79809]   singularity_runtime_rootfs()              =
Set container directory to: /var/singularity/mnt/container
> DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_rootfs()              =
Checking for container directory
> DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_rootfs()              =
Returning container_directory: /var/singularity/mnt/container
> DEBUG   [U=3D8693,P=3D79809]   chk_mode()                                =
Checking exact mode (40755) on: /var/singularity/mnt/container
> DEBUG   [U=3D8693,P=3D79809]   chk_mode()                                =
Found appropriate mode on file: /var/singularity/mnt/container
> VERBOSE [U=3D8693,P=3D79809]   singularity_image_mount()                 =
Checking what kind of image we are mounting
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_mount_squashfs_check()  =
Image does not appear to be of type '.sqsh': gossamer.img
> DEBUG   [U=3D8693,P=3D79809]   singularity_image_mount_dir_check()       =
Checking if image is a directory
> VERBOSE [U=3D8693,P=3D79809]   singularity_image_mount_dir_check()       =
Source path is not a directory: gossamer.img
> VERBOSE [U=3D8693,P=3D79809]   singularity_image_mount()                 =
Attempting to mount as singularity image
> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                =
Returning NULL on 'WRITABLE'
> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_escalate()               =
Temporarily escalating privileges (U=3D8693)
> DEBUG   [U=3D0,P=3D79809]      singularity_priv_escalate()               =
Clearing supplementary GIDs.
> VERBOSE [U=3D0,P=3D79809]      singularity_image_mount_image_mount()     =
Mounting /dev/loop0 in read/only to: /var/singularity/mnt/container
> ERROR   [U=3D0,P=3D79809]      singularity_image_mount_image_mount()     =
Failed to mount image in (read only): Invalid argument
> ABORT   [U=3D0,P=3D79809]      singularity_image_mount_image_mount()     =
Retval =3D 255
>
> On Tuesday, June 27, 2017 at 10:54:11 AM UTC-4, vanessa wrote:
>>
>> Could you provide the --debug output?
>>
>> On Tue, Jun 27, 2017 at 7:48 AM, Charles Murphy <mur...@gmail.com>
>> wrote:
>>
>>> Great! Thanks for your detailed response. I=E2=80=99ve been trying to r=
un my
>>> singularity image on my cluster, but hit an error. Here are my steps:
>>>
>>> 1. I setup an ubuntu (v16.4) on my Mac via vagrant/virtualbox
>>>
>>> 2. Install singularity (v2.3)
>>>
>>> 3. Ran the following:
>>>
>>> singularity create --size 2500 --force gossamer.img
>>>
>>> 4. Then ran the following:
>>>
>>> sudo singularity bootstrap gossamer.img Singularity
>>>
>>> My Singularity bootstrap file:
>>>
>>> Bootstrap: docker
>>> From: ubuntu:16.04
>>>
>>> %setup
>>>
>>>     mkdir -p /scratchLocal
>>>     mkdir -p /pbtech_mounts
>>>     mkdir -p /athena
>>>     mkdir -p /cluster001
>>>     mkdir -p /scratch
>>>
>>> %post
>>>    apt-get update
>>>    apt-get -y install curl git g++ cmake libboost-all-dev pandoc zlib1g=
-dev libbz2-dev libsqlite3-dev
>>>    git clone https://github.com/data61/gossamer
>>>    cd gossamer
>>>    mkdir build
>>>    cd build
>>>    cmake ..
>>>    make && make install
>>>
>>> The mkdir are for my particular cluster setup which I=E2=80=99 am told =
I need to
>>> include.
>>>
>>> 5. I copied gossamer.img to my cluster and get the following error afte=
r
>>> trying to run it:
>>>
>>> chm2059@cannes chm2059 $ singularity exec gossamer.img /usr/local/bin/x=
enome -h
>>> ERROR  : Failed to mount image in (read only): Invalid argument
>>> ABORT  : Retval =3D 255
>>>
>>> Note if I run that same command on my vagrant/virtualbox machine it
>>> works fine. Any ideas on what the issue is? My cluster is running
>>> singularity (v2.3-dist)
>>>
>>> On Wednesday, June 21, 2017 at 4:08:49 PM UTC-4, vanessa wrote:
>>>>
>>>> Hey Charles!
>>>>
>>>> Here is some quick guidance:
>>>>
>>>>>
>>>>> 1. Create the singularity image on an ubuntu GCE machine.
>>>>>
>>>>
>>>> This would definitely work, or you could use your own computer (or a
>>>> virtual machine on it) - see http://singularity.lbl.gov/install-mac.
>>>> You could also just define the build specification file (called
>>>> "Singularity") and put it in a Github repo, and have singularity hub b=
uild
>>>> it for you (guide is here https://github.com/singul
>>>> arityhub/singularityhub.github.io/wiki) The pull command would be
>>>> something like:
>>>>
>>>> singularity pull shub://username/reponame
>>>>
>>>>
>>>>
>>>> 2. Copy the image to my cluster.
>>>>>
>>>>
>>>> Yes you could do this, or use Singularity Hub. Many ways to skin a cat=
!
>>>>
>>>>
>>>>> 3. Run the image and point it to the data on the cluster filesystem
>>>>> for it to run on. Then get it's output and save to the cluster filesy=
stem.
>>>>>
>>>>> You would want to bind the data directory to the container (don't put
>>>> the data in the container!) Like:
>>>>
>>>>>
>>>>> singularity exec  -B /scratch/data:/scratch username-reponame.img
>>>>> /path/to/python script.py
>>>>
>>>>
>>>> Notice in the above I am binding /scratch/data on the host to /scratch
>>>> in the container. If your cluster doesn't support overlay fs you shoul=
d be
>>>> sure to create /scratch in the container.
>>>>
>>>> Sorry I think this is a basic question, but if anyone could help.
>>>>> Thanks!
>>>>>
>>>>> --
>>>>>
>>>> No worries! That's why we have the list :O)
>>>>
>>>> Best,
>>>>
>>>> Vanessa
>>>>
>>>>
>>>>> You received this message because you are subscribed to the Google
>>>>> Groups "singularity" group.
>>>>> To unsubscribe from this group and stop receiving emails from it, sen=
d
>>>>> an email to singu...@lbl.gov.
>>>>>
>>>>
>>>>
>>>>
>>>> --
>>>> Vanessa Villamia Sochat
>>>> Stanford University '16
>>>> (603) 321-0676
>>>>
>>> --
>>> You received this message because you are subscribed to the Google
>>> Groups "singularity" group.
>>> To unsubscribe from this group and stop receiving emails from it, send
>>> an email to singu...@lbl.gov.
>>>
>>
>>
>>
>> --
>> Vanessa Villamia Sochat
>> Stanford University '16
>> (603) 321-0676
>>
> --
> You received this message because you are subscribed to the Google Groups
> "singularity" group.
> To unsubscribe from this group and stop receiving emails from it, send an
> email to singu...@lbl.gov.
>



--=20
Vanessa Villamia Sochat
Stanford University '16
(603) 321-0676

--001a1141dedaf3a4580552f27753
Content-Type: text/html; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">Hi Charles,<div><br></div><div>Does that software exist in=
side the image? I don&#39;t see a line to install anything called xenome, a=
nd it looks like you are binding. Does shell work? You might try shell, and=
 if it works, then try looking in /usr/local/bin to see what is there. If y=
ou need software on your host in the container you can either install it in=
 the container (more reproducible) or bind the directory it is in.</div><di=
v><br></div><div>Best,</div><div><br></div><div>Vanessa</div></div><div cla=
ss=3D"gmail_extra"><br><div class=3D"gmail_quote">On Tue, Jun 27, 2017 at 7=
:56 AM, Charles Murphy <span dir=3D"ltr">&lt;<a href=3D"mailto:murphy....@g=
mail.com" target=3D"_blank">murphy....@gmail.com</a>&gt;</span> wrote:<br><=
blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px=
 #ccc solid;padding-left:1ex"><div dir=3D"ltr"><div><br></div><br><pre styl=
e=3D"margin-top:15px;margin-bottom:15px;background-color:rgb(248,248,248);b=
order:1px solid rgb(204,204,204);line-height:19px;overflow:auto;padding:6px=
 10px;border-top-left-radius:3px;border-top-right-radius:3px;border-bottom-=
right-radius:3px;border-bottom-left-radius:3px;color:rgb(0,0,0)"><code clas=
s=3D"m_-2686507072177257261language-none" style=3D"border-style:none;backgr=
ound-color:transparent;border-top-left-radius:3px;border-top-right-radius:3=
px;border-bottom-right-radius:3px;border-bottom-left-radius:3px">chm2059@ca=
nnes chm2059 $ singularity --debug exec gossamer.img /usr/local/bin/xenome =
-h
Enabling debugging
Ending argument loop
Singularity version: 2.3-dist
Exec&#39;ing: /usr/libexec/singularity/cli/<wbr>exec.exec
Evaluating args: &#39;gossamer.img /usr/local/bin/xenome -h&#39;
VERBOSE [U=3D0,P=3D79809]      message_init()                            Se=
t messagelevel to: 5
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                In=
itialize configuration file: /etc/singularity/singularity.<wbr>conf
DEBUG   [U=3D0,P=3D79809]      singularity_config_parse()                St=
arting parse of configuration file /etc/singularity/singularity.<wbr>conf
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key allow setuid =3D &#39;yes&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key allow pid ns =3D &#39;no&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key allow user image =3D &#39;yes&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key protected image mode =3D &#39;none&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key enable overlay =3D &#39;no&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key config passwd =3D &#39;yes&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key config group =3D &#39;yes&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key config resolv_conf =3D &#39;yes&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key mount proc =3D &#39;yes&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key mount sys =3D &#39;yes&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key mount dev =3D &#39;yes&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key mount home =3D &#39;yes&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key mount tmp =3D &#39;yes&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key mount hostfs =3D &#39;yes&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key bind path =3D &#39;/etc/hosts&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key user bind control =3D &#39;yes&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key mount slave =3D &#39;yes&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key container dir =3D &#39;/var/lib/singularity/mnt&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()                Go=
t config key singularity user =3D &#39;singularity&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_config_parse()                Fi=
nished parsing configuration file &#39;/etc/singularity/singularity.<wbr>co=
nf&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_registry_init()               In=
itializing Singularity Registry
VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                Ad=
ding value to registry: &#39;SHELL&#39; =3D &#39;/bin/bash --norc&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                Re=
turning singularity_registry_set(<wbr>SHELL, /bin/bash --norc) =3D 0
VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                Ad=
ding value to registry: &#39;LIBEXECDIR&#39; =3D &#39;/usr/libexec&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                Re=
turning singularity_registry_set(<wbr>libexecdir, /usr/libexec) =3D 0
VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                Ad=
ding value to registry: &#39;COMMAND&#39; =3D &#39;exec&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                Re=
turning singularity_registry_set(<wbr>COMMAND, exec) =3D 0
VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                Ad=
ding value to registry: &#39;MESSAGELEVEL&#39; =3D &#39;5&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                Re=
turning singularity_registry_set(<wbr>MESSAGELEVEL, 5) =3D 0
VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                Ad=
ding value to registry: &#39;VERSION&#39; =3D &#39;2.3-dist&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                Re=
turning singularity_registry_set(<wbr>version, 2.3-dist) =3D 0
VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                Ad=
ding value to registry: &#39;LOCALSTATEDIR&#39; =3D &#39;/var&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                Re=
turning singularity_registry_set(<wbr>localstatedir, /var) =3D 0
VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                Ad=
ding value to registry: &#39;SYSCONFDIR&#39; =3D &#39;/etc&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                Re=
turning singularity_registry_set(<wbr>sysconfdir, /etc) =3D 0
VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                Ad=
ding value to registry: &#39;BINDIR&#39; =3D &#39;/usr/bin&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                Re=
turning singularity_registry_set(<wbr>bindir, /usr/bin) =3D 0
VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()                Ad=
ding value to registry: &#39;IMAGE&#39; =3D &#39;gossamer.img&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()                Re=
turning singularity_registry_set(<wbr>IMAGE, gossamer.img) =3D 0
DEBUG   [U=3D0,P=3D79809]      singularity_registry_get()                Re=
turning NULL on &#39;HOME&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_registry_get()                Re=
turning NULL on &#39;TARGET_UID&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_registry_get()                Re=
turning NULL on &#39;TARGET_GID&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_priv_init()                   In=
itializing user info
DEBUG   [U=3D0,P=3D79809]      singularity_priv_init()                   Se=
t the calling user&#39;s username to: chm2059
DEBUG   [U=3D0,P=3D79809]      singularity_priv_init()                   Ma=
rking uinfo structure as ready
DEBUG   [U=3D0,P=3D79809]      singularity_priv_init()                   Ob=
taining home directory
VERBOSE [U=3D0,P=3D79809]      singularity_priv_init()                   Se=
t home (via getpwuid()) to: /home/chm2059
VERBOSE [U=3D0,P=3D79809]      singularity_suid_init()                   Ru=
nning SUID program workflow
VERBOSE [U=3D0,P=3D79809]      singularity_suid_init()                   Ch=
ecking program has appropriate permissions
VERBOSE [U=3D0,P=3D79809]      singularity_suid_init()                   Ch=
ecking configuration file is properly owned by root
VERBOSE [U=3D0,P=3D79809]      singularity_suid_init()                   Ch=
ecking if singularity.conf allows us to run as suid
DEBUG   [U=3D0,P=3D79809]      singularity_config_get_bool_<wbr>char_impl()=
   Called singularity_config_get_bool(<wbr>allow setuid, yes)
DEBUG   [U=3D0,P=3D79809]      singularity_config_get_value_<wbr>impl()    =
   Returning configuration value allow setuid=3D&#39;yes&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_config_get_bool_<wbr>char_impl()=
   Return singularity_config_get_bool(<wbr>allow setuid, yes) =3D 1
DEBUG   [U=3D0,P=3D79809]      singularity_registry_get()                Re=
turning NULL on &#39;NOSUID&#39;
VERBOSE [U=3D0,P=3D79809]      singularity_priv_userns()                 In=
voking the user namespace
DEBUG   [U=3D0,P=3D79809]      singularity_config_get_bool_<wbr>char_impl()=
   Called singularity_config_get_bool(<wbr>allow user ns, yes)
DEBUG   [U=3D0,P=3D79809]      singularity_config_get_value_<wbr>impl()    =
   No configuration entry found for &#39;allow user ns&#39;; returning defa=
ult value &#39;yes&#39;
DEBUG   [U=3D0,P=3D79809]      singularity_config_get_bool_<wbr>char_impl()=
   Return singularity_config_get_bool(<wbr>allow user ns, yes) =3D 1
VERBOSE [U=3D0,P=3D79809]      singularity_priv_userns()                 No=
t virtualizing USER namespace: running as SUID
DEBUG   [U=3D0,P=3D79809]      singularity_priv_userns()                 Re=
turning singularity_priv_init(void)
DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   Dr=
opping privileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)
DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   Re=
storing supplementary groups
DEBUG   [U=3D8693,P=3D79809]   singularity_priv_drop()                   Co=
nfirming we have correct UID/GID
DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_ns()                  Ca=
lling: _singularity_runtime_ns_pid()
DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_<wbr>char_impl()=
   Called singularity_config_get_bool(<wbr>allow pid ns, yes)
DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_<wbr>impl()    =
   Returning configuration value allow pid ns=3D&#39;no&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_<wbr>char_impl()=
   Return singularity_config_get_bool(<wbr>allow pid ns, yes) =3D 0
VERBOSE [U=3D8693,P=3D79809]   singularity_runtime_ns_pid()              No=
t virtualizing PID namespace by configuration
DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_ns()                  Ca=
lling: _singularity_runtime_ns_ipc()
DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_<wbr>char_impl()=
   Called singularity_config_get_bool(<wbr>allow ipc ns, yes)
DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_<wbr>impl()    =
   No configuration entry found for &#39;allow ipc ns&#39;; returning defau=
lt value &#39;yes&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_<wbr>char_impl()=
   Return singularity_config_get_bool(<wbr>allow ipc ns, yes) =3D 1
DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                Re=
turning NULL on &#39;UNSHARE_IPC&#39;
VERBOSE [U=3D8693,P=3D79809]   singularity_runtime_ns_ipc()              No=
t virtualizing IPC namespace on user request
DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_ns()                  Ca=
lling: _singularity_runtime_ns_mnt()
DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_<wbr>char_impl()=
   Called singularity_config_get_bool(<wbr>mount slave, yes)
DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_<wbr>impl()    =
   Returning configuration value mount slave=3D&#39;yes&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_<wbr>char_impl()=
   Return singularity_config_get_bool(<wbr>mount slave, yes) =3D 1
DEBUG   [U=3D8693,P=3D79809]   singularity_priv_escalate()               Te=
mporarily escalating privileges (U=3D8693)
DEBUG   [U=3D0,P=3D79809]      singularity_priv_escalate()               Cl=
earing supplementary GIDs.
DEBUG   [U=3D0,P=3D79809]      singularity_runtime_ns_mnt()              Vi=
rtualizing FS namespace
DEBUG   [U=3D0,P=3D79809]      singularity_runtime_ns_mnt()              Vi=
rtualizing mount namespace
DEBUG   [U=3D0,P=3D79809]      singularity_runtime_ns_mnt()              Ma=
king mounts slave
DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   Dr=
opping privileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)
DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   Re=
storing supplementary groups
DEBUG   [U=3D8693,P=3D79809]   singularity_priv_drop()                   Co=
nfirming we have correct UID/GID
DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  Se=
tting sessiondir
VERBOSE [U=3D8693,P=3D79809]   singularity_sessiondir()                  Us=
ing session directory: /var/singularity/mnt/session
DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  Ch=
ecking for session directory: /var/singularity/mnt/session
DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  Ob=
taining the default sessiondir size
DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_<wbr>impl()    =
   No configuration entry found for &#39;sessiondir max size&#39;; returnin=
g default value &#39;16&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  Co=
nverted sessiondir size to: 16
DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  Cr=
eating the sessiondir size mount option length
DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  Go=
t size length of: 9
DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  Cr=
eating the sessiondir size mount option string
DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()                  Ch=
ecking to make sure the string was allocated correctly
DEBUG   [U=3D8693,P=3D79809]   singularity_priv_escalate()               Te=
mporarily escalating privileges (U=3D8693)
DEBUG   [U=3D0,P=3D79809]      singularity_priv_escalate()               Cl=
earing supplementary GIDs.
DEBUG   [U=3D0,P=3D79809]      singularity_sessiondir()                  Mo=
unting sessiondir tmpfs: /var/singularity/mnt/session
DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   Dr=
opping privileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)
DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   Re=
storing supplementary groups
DEBUG   [U=3D8693,P=3D79809]   singularity_priv_drop()                   Co=
nfirming we have correct UID/GID
VERBOSE [U=3D8693,P=3D79809]   singularity_registry_set()                Ad=
ding value to registry: &#39;SESSIONDIR&#39; =3D &#39;/var/singularity/mnt/=
session&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_registry_set()                Re=
turning singularity_registry_set(<wbr>SESSIONDIR, /var/singularity/mnt/sess=
ion) =3D 0
DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                Re=
turning NULL on &#39;CLEANUPDIR&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                Re=
turning NULL on &#39;NOSESSIONCLEANUP&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                Re=
turning NULL on &#39;NOCLEANUP&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_cleanupd()                    No=
t running a cleanup thread, no &#39;SINGULARITY_CLEANUPDIR&#39; defined
DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                Re=
turning value from registry: &#39;IMAGE&#39; =3D &#39;gossamer.img&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                Re=
turning NULL on &#39;WRITABLE&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_<wbr>impl()    =
   No configuration entry found for &#39;limit container owners&#39;; retur=
ning default value &#39;NULL&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_<wbr>impl()    =
   No configuration entry found for &#39;limit container paths&#39;; return=
ing default value &#39;NULL&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_image_open()                  Op=
ening file descriptor to image: gossamer.img
VERBOSE [U=3D8693,P=3D79809]   singularity_image_check()                 Ch=
ecking that file pointer is a Singularity image
DEBUG   [U=3D8693,P=3D79809]   singularity_image_check()                 Fi=
rst line of image(fd=3D6): #!/usr/bin/env run-singularity

DEBUG   [U=3D8693,P=3D79809]   singularity_image_check()                 Ch=
ecking if first line matches key
VERBOSE [U=3D8693,P=3D79809]   singularity_image_check()                 Fi=
le is not a valid Singularity image
DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_<wbr>impl()    =
   No configuration entry found for &#39;max loop devices&#39;; returning d=
efault value &#39;256&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  En=
tered singularity_image_bind()
DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  Co=
nverting max_loop_devs_string to int: &#39;256&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  Co=
nverted max_loop_devs_string to int: &#39;256&#39; -&gt; 256
DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  Ch=
ecking if this image has been properly opened
DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  Ch=
ecking if image is valid file
DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  Ch=
ecking if image is already bound to a loop device
DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                Re=
turning NULL on &#39;WRITABLE&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  Se=
tting loopdev open to: O_RDONLY
DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  Se=
tting LO_FLAGS_AUTOCLEAR
DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()                  Ca=
lculating image offset
VERBOSE [U=3D8693,P=3D79809]   singularity_image_check()                 Ch=
ecking that file pointer is a Singularity image
DEBUG   [U=3D8693,P=3D79809]   singularity_image_check()                 Fi=
rst line of image(fd=3D6): #!/usr/bin/env run-singularity

DEBUG   [U=3D8693,P=3D79809]   singularity_image_check()                 Ch=
ecking if first line matches key
VERBOSE [U=3D8693,P=3D79809]   singularity_image_check()                 Fi=
le is not a valid Singularity image
DEBUG   [U=3D8693,P=3D79809]   singularity_image_offset()                Fi=
le is not a Singularity image, returning zero offset
DEBUG   [U=3D8693,P=3D79809]   singularity_priv_escalate()               Te=
mporarily escalating privileges (U=3D8693)
DEBUG   [U=3D0,P=3D79809]      singularity_priv_escalate()               Cl=
earing supplementary GIDs.
DEBUG   [U=3D0,P=3D79809]      singularity_image_bind()                  Fi=
nding next available loop device...
VERBOSE [U=3D0,P=3D79809]      singularity_image_bind()                  Fo=
und available loop device: /dev/loop0
DEBUG   [U=3D0,P=3D79809]      singularity_image_bind()                  Se=
tting loop device flags
DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   Dr=
opping privileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)
DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()                   Re=
storing supplementary groups
DEBUG   [U=3D8693,P=3D79809]   singularity_priv_drop()                   Co=
nfirming we have correct UID/GID
VERBOSE [U=3D8693,P=3D79809]   singularity_image_bind()                  Us=
ing loop device: /dev/loop0
VERBOSE [U=3D8693,P=3D79809]   singularity_runtime_rootfs()              Se=
t container directory to: /var/singularity/mnt/container
DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_rootfs()              Ch=
ecking for container directory
DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_rootfs()              Re=
turning container_directory: /var/singularity/mnt/container
DEBUG   [U=3D8693,P=3D79809]   chk_mode()                                Ch=
ecking exact mode (40755) on: /var/singularity/mnt/container
DEBUG   [U=3D8693,P=3D79809]   chk_mode()                                Fo=
und appropriate mode on file: /var/singularity/mnt/container
VERBOSE [U=3D8693,P=3D79809]   singularity_image_mount()                 Ch=
ecking what kind of image we are mounting
DEBUG   [U=3D8693,P=3D79809]   singularity_image_mount_<wbr>squashfs_check(=
)  Image does not appear to be of type &#39;.sqsh&#39;: gossamer.img
DEBUG   [U=3D8693,P=3D79809]   singularity_image_mount_dir_<wbr>check()    =
   Checking if image is a directory
VERBOSE [U=3D8693,P=3D79809]   singularity_image_mount_dir_<wbr>check()    =
   Source path is not a directory: gossamer.img
VERBOSE [U=3D8693,P=3D79809]   singularity_image_mount()                 At=
tempting to mount as singularity image
DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()                Re=
turning NULL on &#39;WRITABLE&#39;
DEBUG   [U=3D8693,P=3D79809]   singularity_priv_escalate()               Te=
mporarily escalating privileges (U=3D8693)
DEBUG   [U=3D0,P=3D79809]      singularity_priv_escalate()               Cl=
earing supplementary GIDs.
VERBOSE [U=3D0,P=3D79809]      singularity_image_mount_image_<wbr>mount()  =
   Mounting /dev/loop0 in read/only to: /var/singularity/mnt/container
ERROR   [U=3D0,P=3D79809]      singularity_image_mount_image_<wbr>mount()  =
   Failed to mount image in (read only): Invalid argument
ABORT   [U=3D0,P=3D79809]      singularity_image_mount_image_<wbr>mount()  =
   Retval =3D 255</code></pre><span class=3D"">On Tuesday, June 27, 2017 at=
 10:54:11 AM UTC-4, vanessa wrote:</span><blockquote class=3D"gmail_quote" =
style=3D"margin:0;margin-left:0.8ex;border-left:1px #ccc solid;padding-left=
:1ex"><span class=3D""><div dir=3D"ltr">Could you provide the --debug outpu=
t?</div></span><div><div class=3D"h5"><div><br><div class=3D"gmail_quote">O=
n Tue, Jun 27, 2017 at 7:48 AM, Charles Murphy <span dir=3D"ltr">&lt;<a rel=
=3D"nofollow">mur...@gmail.com</a>&gt;</span> wrote:<br><blockquote class=
=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padd=
ing-left:1ex"><div dir=3D"ltr"><span style=3D"color:rgb(0,0,0);font-family:=
Helvetica;font-size:12px">Great! Thanks for your detailed response. I=E2=80=
=99ve been trying to run my singularity image on my cluster, but hit an err=
or. Here are my steps:</span><div style=3D"color:rgb(0,0,0);font-family:Hel=
vetica;font-size:12px"><br></div><div style=3D"color:rgb(0,0,0);font-family=
:Helvetica;font-size:12px">1. I setup an ubuntu (v16.4) on my Mac via vagra=
nt/virtualbox</div><div style=3D"color:rgb(0,0,0);font-family:Helvetica;fon=
t-size:12px"><br></div><div style=3D"color:rgb(0,0,0);font-family:Helvetica=
;font-size:12px">2. Install singularity (v2.3)</div><div style=3D"color:rgb=
(0,0,0);font-family:Helvetica;font-size:12px"><br></div><div style=3D"color=
:rgb(0,0,0);font-family:Helvetica;font-size:12px">3. Ran the following:</di=
v><div style=3D"color:rgb(0,0,0);font-family:Helvetica;font-size:12px"><br>=
</div><div style=3D"color:rgb(0,0,0);font-family:Helvetica;font-size:12px">=
<pre style=3D"margin-top:15px;margin-bottom:15px;background-color:rgb(248,2=
48,248);border:1px solid rgb(204,204,204);font-size:13px;line-height:19px;o=
verflow:auto;padding:6px 10px;border-top-left-radius:3px;border-top-right-r=
adius:3px;border-bottom-right-radius:3px;border-bottom-left-radius:3px"><co=
de style=3D"border-style:none;background-color:transparent;border-top-left-=
radius:3px;border-top-right-radius:3px;border-bottom-right-radius:3px;borde=
r-bottom-left-radius:3px">singularity create --size 2500 --force gossamer.i=
mg</code></pre><div>4. Then ran the following:</div><div><br></div><div><pr=
e style=3D"margin-top:15px;margin-bottom:15px;background-color:rgb(248,248,=
248);border:1px solid rgb(204,204,204);font-size:13px;line-height:19px;over=
flow:auto;padding:6px 10px;border-top-left-radius:3px;border-top-right-radi=
us:3px;border-bottom-right-radius:3px;border-bottom-left-radius:3px"><code =
style=3D"border-style:none;background-color:transparent;border-top-left-rad=
ius:3px;border-top-right-radius:3px;border-bottom-right-radius:3px;border-b=
ottom-left-radius:3px">sudo singularity bootstrap gossamer.img Singularity<=
/code></pre><div>My Singularity bootstrap file:</div></div><div><br></div><=
div><pre style=3D"margin-top:15px;margin-bottom:15px;background-color:rgb(2=
48,248,248);border:1px solid rgb(204,204,204);font-size:13px;line-height:19=
px;overflow:auto;padding:6px 10px;border-top-left-radius:3px;border-top-rig=
ht-radius:3px;border-bottom-right-radius:3px;border-bottom-left-radius:3px"=
><code style=3D"border-style:none;background-color:transparent;border-top-l=
eft-radius:3px;border-top-right-radius:3px;border-bottom-right-radius:3px;b=
order-bottom-left-radius:3px">Bootstrap: docker
From: ubuntu:16.04

%setup

    mkdir -p /scratchLocal
    mkdir -p /pbtech_mounts
    mkdir -p /athena
    mkdir -p /cluster001
    mkdir -p /scratch

%post
   apt-get update
   apt-get -y install curl git g++ cmake libboost-all-dev pandoc zlib1g-dev=
 libbz2-dev libsqlite3-dev
   git clone <a href=3D"https://github.com/data61/gossamer" rel=3D"nofollow=
" target=3D"_blank">https://github.com/data61/goss<wbr>amer</a>
   cd gossamer
   mkdir build
   cd build
   cmake ..
   make &amp;&amp; make install</code></pre><div>The mkdir are for my parti=
cular cluster setup which I=E2=80=99 am told I need to include.</div></div>=
<div><br></div><div>5. I copied gossamer.img to my cluster and get the foll=
owing error after trying to run it:</div><div><br></div><div><pre style=3D"=
margin-top:15px;margin-bottom:15px;background-color:rgb(248,248,248);border=
:1px solid rgb(204,204,204);font-size:13px;line-height:19px;overflow:auto;p=
adding:6px 10px;border-top-left-radius:3px;border-top-right-radius:3px;bord=
er-bottom-right-radius:3px;border-bottom-left-radius:3px"><code style=3D"bo=
rder-style:none;background-color:transparent;border-top-left-radius:3px;bor=
der-top-right-radius:3px;border-bottom-right-radius:3px;border-bottom-left-=
radius:3px">chm2059@cannes chm2059 $ singularity exec gossamer.img /usr/loc=
al/bin/xenome -h
ERROR  : Failed to mount image in (read only): Invalid argument
ABORT  : Retval =3D 255</code></pre><div>Note if I run that same command on=
 my vagrant/virtualbox machine it works fine. Any ideas on what the issue i=
s? My cluster is running singularity (v2.3-dist)</div></div></div><span><br=
>On Wednesday, June 21, 2017 at 4:08:49 PM UTC-4, vanessa wrote:</span><blo=
ckquote class=3D"gmail_quote" style=3D"margin:0;margin-left:0.8ex;border-le=
ft:1px #ccc solid;padding-left:1ex"><div dir=3D"ltr"><span>Hey Charles!=C2=
=A0<div><br></div><div>Here is some quick guidance:</div></span><div><div c=
lass=3D"gmail_quote"><span><blockquote class=3D"gmail_quote" style=3D"margi=
n:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex=
"><div dir=3D"ltr"><div><br></div><div>1. Create the singularity image on a=
n ubuntu GCE machine.</div></div></blockquote><div><br></div><div>This woul=
d definitely work, or you could use your own computer (or a virtual machine=
 on it) - see=C2=A0<a href=3D"http://singularity.lbl.gov/install-mac" rel=
=3D"nofollow" target=3D"_blank">http://singularity.lbl.gov<wbr>/install-mac=
</a>. You could also just define the build specification file (called &quot=
;Singularity&quot;) and put it in a Github repo, and have singularity hub b=
uild it for you (guide is here=C2=A0<a href=3D"https://github.com/singulari=
tyhub/singularityhub.github.io/wiki" rel=3D"nofollow" target=3D"_blank">htt=
ps://github.com/singul<wbr>arityhub/singularityhub.github<wbr>.io/wiki</a>)=
 The pull command would be something like:</div><div><br></div><blockquote =
class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left:1px sol=
id rgb(204,204,204);padding-left:1ex">singularity pull shub://username/repo=
name</blockquote><div><br></div><div><br></div><blockquote class=3D"gmail_q=
uote" style=3D"margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,2=
04);padding-left:1ex"><div dir=3D"ltr"><div>2. Copy the image to my cluster=
.</div></div></blockquote><div><br></div><div>Yes you could do this, or use=
 Singularity Hub. Many ways to skin a cat!</div><div>=C2=A0</div><blockquot=
e class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left:1px s=
olid rgb(204,204,204);padding-left:1ex"><div dir=3D"ltr"><div>3. Run the im=
age and point it to the data on the cluster filesystem for it to run on. Th=
en get it&#39;s output and save to the cluster filesystem.</div><div><br></=
div></div></blockquote><div>You would want to bind the data directory to th=
e container (don&#39;t put the data in the container!) Like:</div><blockquo=
te class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left:1px =
solid rgb(204,204,204);padding-left:1ex"><br>singularity exec =C2=A0-B /scr=
atch/data:/scratch username-reponame.img /path/to/python script.py</blockqu=
ote><div>=C2=A0</div><div>Notice in the above I am binding /scratch/data on=
 the host to /scratch in the container. If your cluster doesn&#39;t support=
 overlay fs you should be sure to create /scratch in the container.</div><d=
iv><br></div><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px =
0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div dir=3D"=
ltr"><div></div><div>Sorry I think this is a basic question, but if anyone =
could help. Thanks!</div></div><span><font color=3D"#888888">

<p></p>

-- <br></font></span></blockquote><div>No worries! That&#39;s why we have t=
he list :O)</div><div><br></div><div>Best,</div><div><br></div><div>Vanessa=
</div><div>=C2=A0</div></span><blockquote class=3D"gmail_quote" style=3D"ma=
rgin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:=
1ex"><span><font color=3D"#888888"><span>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br></span>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a rel=3D"nofollow">singu...@lbl.gov</a>.<br>
</font></span></blockquote></div><span><br><br clear=3D"all"><div><br></div=
>-- <br><div>Vanessa Villamia Sochat<br>Stanford University &#39;16<br><div=
><div><div><a value=3D"+16033210676">(603) 321-0676</a></div></div></div></=
div>
</span></div></div>
</blockquote></div>

<p></p>

-- <br><div><div>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a rel=3D"nofollow">singu...@lbl.gov</a>.<br>
</div></div></blockquote></div><br><br clear=3D"all"><div><br></div>-- <br>=
<div>Vanessa Villamia Sochat<br>Stanford University &#39;16<br><div><div><d=
iv><a href=3D"tel:(603)%20321-0676" value=3D"+16033210676" target=3D"_blank=
">(603) 321-0676</a></div></div></div></div>
</div>
</div></div></blockquote></div><div class=3D"HOEnZb"><div class=3D"h5">

<p></p>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singularity+u=
nsubscribe@lbl.<wbr>gov</a>.<br>
</div></div></blockquote></div><br><br clear=3D"all"><div><br></div>-- <br>=
<div class=3D"gmail_signature" data-smartmail=3D"gmail_signature">Vanessa V=
illamia Sochat<br>Stanford University &#39;16<br><div><div><div>(603) 321-0=
676</div></div></div></div>
</div>

--001a1141dedaf3a4580552f27753--
