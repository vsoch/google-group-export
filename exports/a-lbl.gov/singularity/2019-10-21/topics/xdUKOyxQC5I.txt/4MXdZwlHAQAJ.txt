X-Received: by 2002:a17:902:563:: with SMTP id 90mr529395plf.22.1542884240358;
        Thu, 22 Nov 2018 02:57:20 -0800 (PST)
X-BeenThere: singularity@lbl.gov
Received: by 2002:a63:b946:: with SMTP id v6ls15114pgo.9.gmail; Thu, 22 Nov
 2018 02:57:19 -0800 (PST)
X-Received: by 2002:a62:520b:: with SMTP id g11mr11068795pfb.53.1542884238921;
        Thu, 22 Nov 2018 02:57:18 -0800 (PST)
ARC-Seal: i=1; a=rsa-sha256; t=1542884238; cv=none;
        d=google.com; s=arc-20160816;
        b=eQxiBWTBxqQ+QLrQZNKNyjCUXiDGwRcnOckp91aRE7TMdrfunBJu6bD10n8/1KelaO
         A33T8FawlZzs+BW5E03pGMdm0S+BbN6K0K0/EfXkS9nI3xrL8mQ4XVqaMm2Tx5l2bdbD
         qRhLWN7BsuNfj7evrDHS/zbMcRS9qzRJdFIxTcY9Q7wla89cPMjmKpLrpG0ClB+F3Rhn
         cl5m0kt4N5fYezPA4z2IuUz0xvX0xYxC62spCbhxMEbD0oMr8wJxAOjyW+N2vEDPVK9i
         TwSZaM1yW3qskWsdx/ZGE5bMXn0RWD+Hb4DtHeQJUaVAeR8ToU1MzGiEfBEXt2PyQZkM
         Fwtg==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=to:subject:message-id:date:from:in-reply-to:references:mime-version
         :dkim-signature;
        bh=xyP3Y+TmnTTAQkJsKYVQxRCi4z0/uo5GKCgb+lJbs14=;
        b=kCZcA56DVRbPiCMXvm2wyjoMiQhFyuXQHTIKk9DaqPaGDCLIsIlxhnX9JiAGjPEsOm
         dUaxBlwVPJxOp37SyhucoI/Tr8GKHTFgdcdt+dsdaROZY52w78yhoQZ1F9fP5kWP5w6X
         g6AMpRR17ejVdhu1+rTgopFN195O68AcmsmtN5iel18mTQRm9HWVadP0Q3hzTXqGD1KH
         jGSgA+jU1u1AkXvjoN76mxnVufmPWsMjC4UraQjvlWAYQmhcoHaL7CHmNri9gFHdqTmS
         FUDt6Q0h0XbKN5uSTgGapwu5fMVk5z5iMUrAA3tAerPgfmhMO5MbKiz+uC62QfxoJaHi
         saBw==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=pass head...@googlemail.com header.s=20161025 header.b="e/pAXjli";
       spf=pass (google.com: domain of hea...@googlemail.com designates 209.85.222.171 as permitted sender) smtp.mailfrom=hea...@googlemail.com
Return-Path: <hea...@googlemail.com>
Received: from fe4.lbl.gov (fe4.lbl.gov. [128.3.41.71])
        by mx.google.com with ESMTP id h16si48095696pgj.203.2018.11.22.02.57.18
        for <singu...@lbl.gov>;
        Thu, 22 Nov 2018 02:57:18 -0800 (PST)
Received-SPF: pass (google.com: domain of hea...@googlemail.com designates 209.85.222.171 as permitted sender) client-ip=209.85.222.171;
Authentication-Results: mx.google.com;
       dkim=pass head...@googlemail.com header.s=20161025 header.b="e/pAXjli";
       spf=pass (google.com: domain of hea...@googlemail.com designates 209.85.222.171 as permitted sender) smtp.mailfrom=hea...@googlemail.com
X-Ironport-SBRS: 3.5
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A2FGAACfivZbh6veVdFgAx0BAQUBBwUBg?=
 =?us-ascii?q?VIHAQsBgQ0BTIEPD0AzJ4NyBlJLgi0xkiuJCo4wFIErOAMlAQoLgQKDPAKEECI?=
 =?us-ascii?q?1CA0BAwEBAgEBAgEBAhABAQEIDQkIKSMMgjYFAgMCHwUETRAfCQEBAQMBAQEBA?=
 =?us-ascii?q?QEBAQEjAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEHAg0gBiM?=
 =?us-ascii?q?BARgBAQEBAgEaCQQZAQ0sAwELBgMCCwYEAQEBIAEJAgIhAQ8DAQUBCwMBBQgOB?=
 =?us-ascii?q?wQBGwEEgwABKAGBPwEDDQgFCo4akAc8iVkRgSN8M4J3BXU8ARNAgjYKQA2CEQI?=
 =?us-ascii?q?GEot3F4F/gRGDEoF+WEUCAQEBgSsBEgE+Agwagj2CVwKJDhUJI06GQYRYiXcnL?=
 =?us-ascii?q?gmGO0GHCIMrGIFZhQuGJYN/iW2DVoEKhh4BgzUwgSYBazBxMwEZCBsVOzGCBwE?=
 =?us-ascii?q?zCYISDA4JEoM4gmSCMIE9hAFCMAEBDotiR4F3AQE?=
X-IronPort-AV: E=Sophos;i="5.56,265,1539673200"; 
   d="scan'208,217";a="43256828"
Received: from mail-qk1-f171.google.com ([209.85.222.171])
  by fe4.lbl.gov with ESMTP; 22 Nov 2018 02:57:16 -0800
Received: by mail-qk1-f171.google.com with SMTP id a132so6638813qkg.1
        for <singu...@lbl.gov>; Thu, 22 Nov 2018 02:57:16 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=20161025;
        h=mime-version:references:in-reply-to:from:date:message-id:subject:to;
        bh=xyP3Y+TmnTTAQkJsKYVQxRCi4z0/uo5GKCgb+lJbs14=;
        b=e/pAXjli0YkxwvOY2GiG52W+RK4d3//eU78vxmwkqSkavUivdO0+VB07yhmfPpMxY8
         CX+yb19C40mWYEOiKH4P/afzSqclr+5+DrF9sY+YUQ/MiOn1fGHHkmPpA8jX0NuCzJkS
         WFnp45kVtr9snWnM/cL/ovy6PSyyil+K5PoKc5S5pPMf6+zEuEx6q3jxnkoiTZgxmztJ
         YFLyFk0mC27DRNa7TpuUI9WPRH2KXJTRG/tkm8m1+uundYKiD0fwcQLTcnusDRykajC1
         G8t4uQW0XEjneFt7/Xj4wR/sZnrdzGRVg9do/fmLT2QlqWIq4CL0uEONmx+ny0WumnlK
         LFNw==
X-Gm-Message-State: AA+aEWZL3WW5lviOehjmQh8CZRAxMrmO6+beBIE7OTIXCtB1msrg7wUf
	uQyHCB133bDm7RasdG9d+pNsHWphtzBLnKMWOOE0K16a
X-Received: by 2002:ae9:ee02:: with SMTP id i2mr8975489qkg.179.1542884235311;
 Thu, 22 Nov 2018 02:57:15 -0800 (PST)
MIME-Version: 1.0
References: <e8911f2b-d946-4940-9da1-9f840ddcf234@lbl.gov> <d54833bb-c680-4fd0-9527-219e406d2e1d@lbl.gov>
 <CAM=pu+KAnzcSYwEkfGex6RW3H3EA12BpPdwQW8T0F07=_Zhw1w@mail.gmail.com>
 <9eeb9ad3-e5c6-4f18-8818-ac7b0bab64c7@lbl.gov> <CAM=pu+KbFvEaA01WLJLW6S2XbtvedEcoF1x_sOxN5C5=hi1Nfg@mail.gmail.com>
 <CAPqNE2WGKJpBDLnY=uVK6MrOnRTnM7RguAsb6DC0EWOEMb1AUA@mail.gmail.com>
 <CAPqNE2XSuV+w+CmCBgXZYuCSL+W2aaf=HjPiuk8MA-tk07OhKA@mail.gmail.com>
 <CAPqNE2Wqsk_0Nd7FD9sRmiyzm+FEx506Q1Eu6eZTRPE2zDHm9A@mail.gmail.com>
 <CAPqNE2XL4eKN8rK7tjwj2HvqvAy-tMPuQatFYFtT7DoYtW3zMw@mail.gmail.com>
 <BYAPR04MB3814F954EE24CC250C26A521DCDA0@BYAPR04MB3814.namprd04.prod.outlook.com>
 <CAPqNE2X+zqWGj2gsZGsy=Qm4F2GNC7fnoZBeabHBKme6Xs-Y1w@mail.gmail.com> <CAPqNE2XAQ9eTk+s=h+Be2gWuVtR_bBSySFkskfrtRz4_F3B-0g@mail.gmail.com>
In-Reply-To: <CAPqNE2XAQ9eTk+s=h+Be2gWuVtR_bBSySFkskfrtRz4_F3B-0g@mail.gmail.com>
From: John Hearns <hea...@googlemail.com>
Date: Thu, 22 Nov 2018 11:56:48 +0000
Message-ID: <CAPqNE2WHLapWY6eAp+Q+Uj1o1-Po_2Drz-gSQuGY-UdyEQixqg@mail.gmail.com>
Subject: Re: [Singularity] Re: pull NVIDIA Tensorflow container in Singularity
 without token
To: singularity@lbl.gov
Content-Type: multipart/alternative; boundary="000000000000c68518057b3eba5e"

--000000000000c68518057b3eba5e
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable

In the Department of teaching your grandmother to suck egs, I see that
there were Vagrant boxes for the 2.4 series. Stupid me.
https://app.vagrantup.com/singularityware

Still I think it might be worth asking Hashicorp about using Singularity as
a native provider.


On Thu, 22 Nov 2018 at 11:33, John Hearns <hea...@googlemail.com> wrote:

> ps. Off topic for this list, but making people aware. If you have Windows
> 10, there is Docker available. Which uses Hyper-V.
> On Windows 10 Home this is not available. Grrrrrr.
> Easy to dual boot into Linux of course, but it stops my laptop from being
> an all round development environment.
>
> On Thu, 22 Nov 2018 at 11:31, John Hearns <hea...@googlemail.com> wrote:
>
>> Martin has made a very good answer to the query.
>> Worth saying Vagrant is a configuration layer above VirtualBox, VMware,
>> Hyper-V or Docker!
>> I am not that familiar with Vagrantfiles and Docker but a lightbulb come=
s
>> on in my head -
>> Should the Singularity Team be talking to Hashicorp re. Singularity as a
>> provider?
>> I guess that is not a high priority, but many many people have
>> Vagrant/Terraform/Vault skills out there, and they are good tools.
>>
>> Longer:
>> Vagrant is a layer about VirtualBox. It is an orchestration layer which
>> configures VMs for you in
>> VirtualBox, VMware, AWS etc.
>> It is really easy to use - no more GUI work with VirtualBox - you have a
>> Vagrantfile for each machine, which is like a Singularity recipe.
>> This creates a 'box'. You can bring boxes (VMs) up and down, provision
>> them, configure networks etc.
>> Then the same Vagrantfile can be used eg. on AWS.
>>
>> The interesting thing is that Docker is one of the providers:
>> https://www.vagrantup.com/docs/docker/
>>
>> While Vagrant ships out of the box with support for VirtualBox
>> <https://www.virtualbox.org/>, Hyper-V
>> <https://www.microsoft.com/hyper-v>, and Docker <https://www.docker.io/>=
,
>> Vagrant has the ability to manage other types of machines as well. This =
is
>> done by using other *providers* with Vagrant.
>>
>> Alternate providers can offer different features that make more sense in
>> your use case. For example, if you are using Vagrant for any real work,
>> VMware <https://www.vmware.com/> providers are recommended since they're
>> well supported and generally more stable and performant than VirtualBox.
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>> On Wed, 21 Nov 2018 at 14:49, Kandes, Martin <mka...@sdsc.edu> wrote:
>>
>>> Rutu,
>>>
>>>
>>> John is correct. I was merely suggesting you take one of our TensorFlow
>>> definition files (e.g., [1]) and modify it to suit your needs. Then you=
 can
>>> simply do a 'singularity build' to make your version of the container.
>>>
>>>
>>> There are really only two things you might want to / need to change in
>>> this base definition file. First, you might want to change the NVIDIA
>>> driver version we install. We bake in the matching version into the
>>> container for users on our systems just to make it a bit easier for the=
m
>>> [3]. However, you don't necessarily need to do this if you just want to=
 use
>>> the --nv option instead to import the correct drivers for the container
>>> from the host system at runtime. Second, you should change the CUDA com=
pute
>>> capability line [4] to build TensorFlow for the types of GPUs you plan =
to
>>> run on (we run K80s and P100s). After that, all other changes can be yo=
ur
>>> own to customize the container further. These are the simply the two
>>> changes that I think you need to start with.
>>>
>>>
>>> Marty
>>>
>>>
>>> P.S. Sorry, I haven't used Vagrant myself. So I'm not much help there. =
I
>>> use/recommend VirtualBox when working with Singularity on a non-Linux
>>> system.
>>>
>>>
>>> [1]
>>>
>>>
>>> naked-singularity/definition-files/comet/tensorflow/tensorflow-gpu.def
>>>
>>>
>>> [2]
>>>
>>>
>>> sudo singularity build tensorflow-gpu.simg tensorflow-gpu.def
>>>
>>>
>>> [3]
>>>
>>>
>>> # Download NVIDIA drivers, libraries, and packages
>>> wget --wait=3D10 "${CUDA_REPO_URL}/nvidia-396_396.26-0ubuntu1_amd64.deb=
"
>>> wget --wait=3D10 "${CUDA_REPO_URL}/nvidia-396-dev_396.26-0ubuntu1_amd64=
.deb"
>>> wget --wait=3D10 "${CUDA_REPO_URL}/nvidia-modprobe_396.26-0ubuntu1_amd6=
4.deb"
>>> wget --wait=3D10 "${CUDA_REPO_URL}/libcuda1-396_396.26-0ubuntu1_amd64.d=
eb"
>>> wget --wait=3D10 "${CUDA_REPO_URL}/nvidia-libopencl1-396_396.26-0ubuntu=
1_amd64.deb"
>>> wget --wait=3D10 "${CUDA_REPO_URL}/nvidia-opencl-icd-396_396.26-0ubuntu=
1_amd64.deb"
>>> wget --wait=3D10 "${CUDA_REPO_URL}/libxnvctrl0_396.26-0ubuntu1_amd64.de=
b"
>>> wget --wait=3D10 "${CUDA_REPO_URL}/nvidia-settings_396.26-0ubuntu1_amd6=
4.deb"
>>> wget --wait=3D10 "${CUDA_REPO_URL}/cuda-drivers_396.26-1_amd64.deb"
>>>
>>> ...
>>>
>>> # Install NVIDIA drivers, libraries, and packages
>>> dpkg -i nvidia-396_396.26-0ubuntu1_amd64.deb
>>> dpkg -i nvidia-396-dev_396.26-0ubuntu1_amd64.deb
>>> dpkg -i nvidia-modprobe_396.26-0ubuntu1_amd64.deb
>>> dpkg -i libcuda1-396_396.26-0ubuntu1_amd64.deb
>>> dpkg -i nvidia-libopencl1-396_396.26-0ubuntu1_amd64.deb
>>> dpkg -i nvidia-opencl-icd-396_396.26-0ubuntu1_amd64.deb
>>> dpkg -i libxnvctrl0_396.26-0ubuntu1_amd64.deb
>>> dpkg -i nvidia-settings_396.26-0ubuntu1_amd64.deb
>>> dpkg -i cuda-drivers_396.26-1_amd64.deb
>>>
>>> [4]
>>>
>>>
>>> echo 'expect "Please note that each additional compute capability signi=
ficantly increases your build time and binary size. \[Default is: 3.5,7.0\]=
"' >> install-tensorflow-python.exp
>>> echo 'send "3.7,6.0\r"' >> install-tensorflow-python.exp
>>>
>>>
>>> ------------------------------
>>> *From:* 'John Hearns' via singularity <singu...@lbl.gov>
>>> *Sent:* Wednesday, November 21, 2018 1:22:19 AM
>>> *To:* singu...@lbl.gov
>>> *Subject:* Re: [Singularity] Re: pull NVIDIA Tensorflow container in
>>> Singularity without token
>>>
>>> Rutu, sorry if I appear to be slightly unhelpful. I in fact have spent =
a
>>> few hours setting up the same Ubuntu version as you under VirtualBox.
>>> If you can explain to the list what you are trying to achieve precisely=
,
>>> I think that would help.
>>>
>>> On Wed, 21 Nov 2018 at 09:04, John Hearns <hea...@googlemail.com>
>>> wrote:
>>>
>>> And a rather stupid question from me - you are running Ubuntu in a
>>> virtual environment - VirtaullBox - on Windows.
>>> All will be good for training I suppose - but is your intention to then
>>> use the Singularity container on a system with a real GPU?
>>>
>>> PCI passthrough seems only for Linux hosts
>>> https://www.virtualbox.org/manual/ch09.html#pcipassthrough
>>>
>>>
>>> On Wed, 21 Nov 2018 at 08:58, John Hearns <hea...@googlemail.com>
>>> wrote:
>>>
>>> Rutu, my advice would be to either:
>>> Copy the
>>> file ~/naked-singularity/definition-files/comet/tensorflow/tensorflow-g=
pu.def
>>> and adapt it to fit your needs.
>>> Note that there are specific CUDA versions
>>>
>>> Or try the Nvidia container download again. As Vanessa says we need the
>>> exact command you use.
>>>
>>> I now see I have started a circular dependence - Martin Kandes already
>>> suggested you base your container on the tensorflor def file from
>>> naked-singularity.
>>> Not that you build a complete environment for comet.
>>>
>>>
>>>
>>>
>>>
>>>
>>> On Wed, 21 Nov 2018 at 08:37, John Hearns <hea...@googlemail.com>
>>> wrote:
>>>
>>> Rutu, I am trying to replroduce your problem.
>>>
>>> Note  ./naked-singularity.sh build -s comet -a ubuntu -d ubuntu.def
>>> will build something specific for the Comet HPC machine at SDSC.
>>> The definition files for comet and tscc are in the directory
>>> definition-files
>>> Somehow I dont think you should be building specifically for those
>>> environments - unless of course you are running at SDSC
>>>
>>>
>>>
>>>
>>>
>>> On Wed, 21 Nov 2018 at 00:19, v <vso...@gmail.com> wrote:
>>>
>>> I'm seeing some issues online about incorrect keyboard mappings (so
>>> perhaps if you try other keys you can stumble on the remapped enter, he=
h),
>>> and also configuring the Vagrantfile to use a GUI. This seems like a
>>> problem with Vagrant - at least with Ubuntu you have to restart and ena=
ble
>>> your bios, did you do that? Could you share the Vagrantfile that you
>>> ultimately produced? I think others on the list can best help if you ar=
e
>>> able to share this. Otherwise it's like fishing in the dark. For
>>> containers. Which now that I think of it, would probably be pretty pain=
ful.
>>>
>>> On Tue, Nov 20, 2018 at 6:56 PM Rutu Pandya <rut...@gmail.com> wrote:
>>>
>>> Thanks Martin, Vanessa.
>>> I started with Martin's Recipe file for tensorflow-gpu - And encountere=
d
>>> a rather silly problem.
>>>
>>> In the process it shows the following in the bash prompt, and I am
>>> unable to make any selections. Tab, Enter, arrow keys, etc none work. H=
ow
>>> do I proceed?
>>>
>>> [image: Capture.JPG]
>>>
>>> Here are the detailed steps I followed to create the environment using
>>> Vagrant in Windows:
>>>
>>> 1.    Open git bash in admin mode
>>>
>>> 2.
>>>
>>> a.       mkdir -p /E/work/containers/vagrant_ubuntu16
>>>
>>> b.       cd /E/work/containers/vagrant_ubuntu16
>>>
>>> c.       vagrant box add ubuntu/xenial64
>>>
>>> d.       vagrant init ubuntu/xenial64
>>>
>>> If we want to sync folders
>>> <https://www.vagrantup.com/docs/synced-folders/> with our Windows host,
>>> edit Vagrantfile and add the following to it, right before the last
>>> line which says end:
>>>
>>> e.       config.vm.synced_folder "vmfiles", "/vagrant", type: "smb"
>>>
>>> f.        mkdir vmfiles
>>>
>>> g.       vagrant plugin install vagrant-vbguest
>>>
>>> h.       vagrant up =E2=80=93 will ask for windows username and pwd
>>>
>>> i.         vagrant ssh
>>>
>>> j.         sudo apt-get update
>>>
>>> k.       sudo apt-get install -y build-essential git autoconf libtool
>>>
>>> l.         sudo apt-get install -y debootstrap yum
>>>
>>> m.     Singularity Install:Follow
>>> https://www.sylabs.io/guides/3.0/user-guide/quick_start.html - until
>>> compiling singularity binaries
>>>
>>> n.       git clone https://github.com/mkandes/naked-singularity -->
>>> Martin's definition files
>>>
>>> o.       cd naked-singularity
>>>
>>> p.   bash naked-singularity.sh build -s comet -a tensorflow -d
>>> tensorflow-gpu.def -->to build from the definition file
>>>
>>>
>>> Thanks,
>>> Rutu
>>>
>>>
>>> On Monday, November 19, 2018 at 12:06:40 PM UTC-5, vanessa wrote:
>>>
>>> If you are having trouble with pulling a container, it likely has to do
>>> with the URI, and if you provide the complete URI (unique resource
>>> identifier) for the container others might be able to help to debug. Fo=
r
>>> Docker Hub, this would be in the format <namespace>/<repo>:<tag>. If yo=
u
>>> have your token for nvidia cloud and know the full URI (and are careful=
 to
>>> get the tag right, sometimes people assume that a "latest" exists and i=
t
>>> doesn't). if you are having trouble pulling you can also try the sregis=
try
>>> nvidia client, documentationis here.
>>> <https://singularityhub.github.io/sregistry-cli/client-nvidia> It would
>>> come down to something like:
>>>
>>> $ export SREGISTRY_NVIDIA_TOKEN=3Dxxxxxxxxxxxxxxxxxxx
>>>
>>> $ export SREGISTRY_CLIENT=3Dnvidia
>>>
>>> $ sregistry pull tensorflow:17.11
>>>
>>>
>>> would pull the container, and then you would use it as a base to build
>>> on top of:
>>>
>>> Bootstrap: localimage
>>> From: /path/to/tensorflow-17.11.simg
>>>
>>>
>>> You can also try using the various gpu tags provided a la nvidia Docker=
,
>>> these are new docs, I am just finding them now!
>>>
>>> https://www.tensorflow.org/install/docker#gpu_support
>>>
>>> and on Docker Hub:
>>>
>>> https://hub.docker.com/r/tensorflow/tensorflow/
>>>
>>> The issue with this image approach is that you are dependent on the
>>> container to build yours. I would +1 what Martin says in starting with =
a
>>> recipe.
>>>
>>> What I'm not privy to / have not tested are if there are any potential
>>> issues with pull when doing it from Virtualbox. Possibly others have tr=
ied?
>>> Hope this helps!
>>>
>>> On Mon, Nov 19, 2018 at 11:50 AM Rutu Pandya <r...@gmail.com> wrote:
>>>
>>> Thanks Vanessa,
>>>
>>> What I am really trying to do is start from the NVIDIA Tensorflow
>>> container and add some programs in it. And make this into a singularity
>>> container to use for others.
>>> I downloaded Singularity 3.0 using vagrant and virtual box. And now
>>> trying to pull the NVIDIA tensorflow container to start with.
>>>
>>> Thanks
>>>
>>> On Friday, November 16, 2018 at 3:38:38 PM UTC-5, Rutu Pandya wrote:
>>>
>>> Hello,
>>>
>>> I am trying to pull the tensorflow container from NVIDIA. It has the
>>> pull command given. Unable to pull with error saying "Got permission de=
nied
>>> when trying to connect to the Docker daemon socket".
>>>
>>> Thanks!
>>>
>>> --
>>> You received this message because you are subscribed to the Google
>>> Groups "singularity" group.
>>> To unsubscribe from this group and stop receiving emails from it, send
>>> an email to singu...@lbl.gov.
>>>
>>>
>>>
>>> --
>>> Vanessa Villamia Sochat
>>> Stanford University '16
>>> (603) 321-0676
>>>
>>> --
>>> You received this message because you are subscribed to the Google
>>> Groups "singularity" group.
>>> To unsubscribe from this group and stop receiving emails from it, send
>>> an email to singu...@lbl.gov.
>>>
>>>
>>>
>>> --
>>> Vanessa Villamia Sochat
>>> Stanford University '16
>>> (603) 321-0676
>>>
>>> --
>>> You received this message because you are subscribed to the Google
>>> Groups "singularity" group.
>>> To unsubscribe from this group and stop receiving emails from it, send
>>> an email to singu...@lbl.gov.
>>>
>>> --
>>> You received this message because you are subscribed to the Google
>>> Groups "singularity" group.
>>> To unsubscribe from this group and stop receiving emails from it, send
>>> an email to singu...@lbl.gov.
>>>
>>> --
>>> You received this message because you are subscribed to the Google
>>> Groups "singularity" group.
>>> To unsubscribe from this group and stop receiving emails from it, send
>>> an email to singu...@lbl.gov.
>>>
>>

--000000000000c68518057b3eba5e
Content-Type: text/html; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div dir=3D"ltr"><div>In the Department of teaching your g=
randmother to suck egs, I see that there were Vagrant boxes for the 2.4 ser=
ies. Stupid me.</div><div><a href=3D"https://app.vagrantup.com/singularityw=
are">https://app.vagrantup.com/singularityware</a></div><div><br></div><div=
>Still I think it might be worth asking Hashicorp about using Singularity a=
s a native provider.</div><div><br></div></div></div><br><div class=3D"gmai=
l_quote"><div dir=3D"ltr">On Thu, 22 Nov 2018 at 11:33, John Hearns &lt;<a =
href=3D"mailto:hea...@googlemail.com">hea...@googlemail.com</a>&gt; wrote:<=
br></div><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;borde=
r-left:1px #ccc solid;padding-left:1ex"><div dir=3D"ltr"><div>ps. Off topic=
 for this list, but making people aware. If you have Windows 10, there is D=
ocker available. Which uses Hyper-V.</div><div>On Windows 10 Home this is n=
ot available. Grrrrrr.</div><div>Easy to dual boot into Linux of course, bu=
t it stops my laptop from being an all round development environment.</div>=
</div><br><div class=3D"gmail_quote"><div dir=3D"ltr">On Thu, 22 Nov 2018 a=
t 11:31, John Hearns &lt;<a href=3D"mailto:hea...@googlemail.com" target=3D=
"_blank">hea...@googlemail.com</a>&gt; wrote:<br></div><blockquote class=3D=
"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding=
-left:1ex"><div dir=3D"ltr"><div dir=3D"ltr"><div dir=3D"ltr"><div>Martin h=
as made a very good answer to the query.</div><div>Worth saying Vagrant is =
a configuration layer above VirtualBox, VMware, Hyper-V or Docker!</div><di=
v>I am not that familiar with Vagrantfiles and Docker but a lightbulb comes=
 on in my head -</div><div>Should the Singularity Team be talking to Hashic=
orp re. Singularity as a provider?</div><div>I guess that is not a high pri=
ority, but many many people have Vagrant/Terraform/Vault skills out there, =
and they are good tools.</div><div><br></div><div>Longer:</div><div>Vagrant=
 is a layer about VirtualBox. It is an orchestration layer which configures=
 VMs for you in=C2=A0</div><div>VirtualBox, VMware, AWS etc.</div><div>It i=
s really easy to use - no more GUI work with VirtualBox - you have a Vagran=
tfile for each machine, which is like a Singularity recipe.</div><div>This =
creates a &#39;box&#39;. You can bring boxes (VMs) up and down, provision t=
hem, configure networks etc.</div><div>Then the same Vagrantfile can be use=
d eg. on AWS.</div><div><br></div><div>The interesting thing is that Docker=
 is one of the providers:=C2=A0 <a href=3D"https://www.vagrantup.com/docs/d=
ocker/" target=3D"_blank">https://www.vagrantup.com/docs/docker/</a><br></d=
iv><div><p style=3D"margin:0px 0px 15px;text-align:left;color:rgb(85,85,85)=
;text-transform:none;line-height:1.84em;text-indent:0px;letter-spacing:norm=
al;font-size:15px;font-style:normal;font-variant:normal;font-weight:400;tex=
t-decoration:none;word-spacing:0px;white-space:normal;box-sizing:border-box=
">While Vagrant ships out of the box with support for <a style=3D"color:rgb=
(21,99,255);text-decoration:none;box-sizing:border-box;background-color:tra=
nsparent" href=3D"https://www.virtualbox.org/" target=3D"_blank">VirtualBox=
</a>,
<a style=3D"color:rgb(21,99,255);text-decoration:none;box-sizing:border-box=
;background-color:transparent" href=3D"https://www.microsoft.com/hyper-v" t=
arget=3D"_blank">Hyper-V</a>, and <a style=3D"color:rgb(21,99,255);text-dec=
oration:none;box-sizing:border-box;background-color:transparent" href=3D"ht=
tps://www.docker.io/" target=3D"_blank">Docker</a>,
Vagrant has the ability to manage other types of machines as well. This is =
done
by using other <em style=3D"box-sizing:border-box">providers</em> with Vagr=
ant.</p><span style=3D"text-align:left;color:rgb(85,85,85);text-transform:n=
one;text-indent:0px;letter-spacing:normal;font-family:&quot;Open Sans&quot;=
,sans-serif;font-size:15px;font-style:normal;font-variant:normal;font-weigh=
t:400;text-decoration:none;word-spacing:0px;display:inline;white-space:norm=
al;float:none;background-color:rgb(255,255,255)">
</span><p style=3D"margin:0px 0px 15px;text-align:left;color:rgb(85,85,85);=
text-transform:none;line-height:1.84em;text-indent:0px;letter-spacing:norma=
l;font-size:15px;font-style:normal;font-variant:normal;font-weight:400;text=
-decoration:none;word-spacing:0px;white-space:normal;box-sizing:border-box"=
>Alternate providers can offer different features that make more sense in y=
our use case.
For example, if you are using Vagrant for any real work, <a style=3D"color:=
rgb(21,99,255);text-decoration:none;box-sizing:border-box;background-color:=
transparent" href=3D"https://www.vmware.com/" target=3D"_blank">VMware</a>
providers are recommended since they&#39;re well supported and generally mo=
re
stable and performant than VirtualBox.</p><b></b><i></i><u></u><sub></sub><=
sup></sup><strike></strike><br></div><div><b></b><i></i><u></u><sub></sub><=
sup></sup><strike></strike><br></div><div><br></div><div><br></div><div><br=
></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br=
></div><div><br></div><div><br></div></div></div></div><br><div class=3D"gm=
ail_quote"><div dir=3D"ltr">On Wed, 21 Nov 2018 at 14:49, Kandes, Martin &l=
t;<a href=3D"mailto:mka...@sdsc.edu" target=3D"_blank">mka...@sdsc.edu</a>&=
gt; wrote:<br></div><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0=
 .8ex;border-left:1px #ccc solid;padding-left:1ex">




<div dir=3D"ltr">
<div id=3D"m_-3752525239196178733m_4007550858250608376m_6633233797533712023=
divtagdefaultwrapper" style=3D"font-size:12pt;color:#000000;font-family:Cal=
ibri,Helvetica,sans-serif" dir=3D"ltr">
<p style=3D"margin-top:0;margin-bottom:0">Rutu,</p>
<p style=3D"margin-top:0;margin-bottom:0"><br>
</p>
<p style=3D"margin-top:0;margin-bottom:0">John is correct. I was merely sug=
gesting you take one of our TensorFlow definition files (e.g., [1]) and mod=
ify it to suit your needs. Then you can simply do a &#39;singularity build&=
#39; to make your version of the container.
<br>
</p>
<p style=3D"margin-top:0;margin-bottom:0"><br>
</p>
<p style=3D"margin-top:0;margin-bottom:0">There are really only=C2=A0two th=
ings you might want to / need to change in this base definition file. First=
, you might want to change the NVIDIA driver version we install. We bake in=
 the matching version=C2=A0into the container
 for users on our systems just to make it a bit easier for them [3]. Howeve=
r, you don&#39;t necessarily need to do this if you just want to use the --=
nv option instead to import the correct drivers for the container from the =
host system at runtime. Second, you
 should change the CUDA compute capability line [4] to build TensorFlow for=
 the types of GPUs you plan to run on (we run K80s and P100s). After that, =
all other changes can be your own to customize the container further. These=
 are the simply the two changes
 that I think you need to start with. <br>
</p>
<p style=3D"margin-top:0;margin-bottom:0"><br>
</p>
<p style=3D"margin-top:0;margin-bottom:0">Marty</p>
<p style=3D"margin-top:0;margin-bottom:0"><br>
</p>
<p style=3D"margin-top:0;margin-bottom:0">P.S. Sorry, I haven&#39;t used Va=
grant myself. So I&#39;m not much help there. I use/recommend VirtualBox wh=
en working with Singularity on a non-Linux system.
<br>
</p>
<p style=3D"margin-top:0;margin-bottom:0"><br>
</p>
<p style=3D"margin-top:0;margin-bottom:0">[1]</p>
<p style=3D"margin-top:0;margin-bottom:0"><br>
</p>
<p style=3D"margin-top:0;margin-bottom:0"><span>naked-singularity/definitio=
n-files/comet/tensorflow/tensorflow-gpu.def</span></p>
<p style=3D"margin-top:0;margin-bottom:0"><span><br>
</span></p>
<p style=3D"margin-top:0;margin-bottom:0"><span>[2]</span></p>
<p style=3D"margin-top:0;margin-bottom:0"><span><br>
</span></p>
<p style=3D"margin-top:0;margin-bottom:0"><span>sudo singularity build tens=
orflow-gpu.simg
<span>tensorflow-gpu.def</span><br>
</span></p>
<p style=3D"margin-top:0;margin-bottom:0"><span><br>
</span></p>
<p style=3D"margin-top:0;margin-bottom:0"><span>[3]</span></p>
<p style=3D"margin-top:0;margin-bottom:0"><span><br>
</span></p>
<p style=3D"margin-top:0;margin-bottom:0"><span></span></p>
<pre># Download NVIDIA drivers, libraries, and packages
wget --wait=3D10 &quot;${CUDA_REPO_URL}/nvidia-396_396.26-0ubuntu1_amd64.de=
b&quot;
wget --wait=3D10 &quot;${CUDA_REPO_URL}/nvidia-396-dev_396.26-0ubuntu1_amd6=
4.deb&quot;
wget --wait=3D10 &quot;${CUDA_REPO_URL}/nvidia-modprobe_396.26-0ubuntu1_amd=
64.deb&quot;
wget --wait=3D10 &quot;${CUDA_REPO_URL}/libcuda1-396_396.26-0ubuntu1_amd64.=
deb&quot;
wget --wait=3D10 &quot;${CUDA_REPO_URL}/nvidia-libopencl1-396_396.26-0ubunt=
u1_amd64.deb&quot;
wget --wait=3D10 &quot;${CUDA_REPO_URL}/nvidia-opencl-icd-396_396.26-0ubunt=
u1_amd64.deb&quot;
wget --wait=3D10 &quot;${CUDA_REPO_URL}/libxnvctrl0_396.26-0ubuntu1_amd64.d=
eb&quot;
wget --wait=3D10 &quot;${CUDA_REPO_URL}/nvidia-settings_396.26-0ubuntu1_amd=
64.deb&quot;
wget --wait=3D10 &quot;${CUDA_REPO_URL}/cuda-drivers_396.26-1_amd64.deb&quo=
t;</pre>
...
<p></p>
<p style=3D"margin-top:0;margin-bottom:0"><span></span></p>
<pre># Install NVIDIA drivers, libraries, and packages
dpkg -i nvidia-396_396.26-0ubuntu1_amd64.deb
dpkg -i nvidia-396-dev_396.26-0ubuntu1_amd64.deb
dpkg -i nvidia-modprobe_396.26-0ubuntu1_amd64.deb
dpkg -i libcuda1-396_396.26-0ubuntu1_amd64.deb
dpkg -i nvidia-libopencl1-396_396.26-0ubuntu1_amd64.deb
dpkg -i nvidia-opencl-icd-396_396.26-0ubuntu1_amd64.deb
dpkg -i libxnvctrl0_396.26-0ubuntu1_amd64.deb
dpkg -i nvidia-settings_396.26-0ubuntu1_amd64.deb
dpkg -i cuda-drivers_396.26-1_amd64.deb</pre>
<p style=3D"margin-top:0;margin-bottom:0"><span>[4]</span></p>
<p style=3D"margin-top:0;margin-bottom:0"><span><br>
</span></p>
<p style=3D"margin-top:0;margin-bottom:0"><span></span></p>
<pre>echo &#39;expect &quot;Please note that each additional compute capabi=
lity significantly increases your build time and binary size. \[Default is:=
 3.5,7.0\]&quot;&#39; &gt;&gt; install-tensorflow-python.exp
echo &#39;send &quot;3.7,6.0\r&quot;&#39; &gt;&gt; install-tensorflow-pytho=
n.exp</pre>
<br>

<p></p>
</div>
<hr style=3D"display:inline-block;width:98%">
<div id=3D"m_-3752525239196178733m_4007550858250608376m_6633233797533712023=
divRplyFwdMsg" dir=3D"ltr"><font face=3D"Calibri, sans-serif" style=3D"font=
-size:11pt" color=3D"#000000"><b>From:</b> &#39;John Hearns&#39; via singul=
arity &lt;<a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singu...@lb=
l.gov</a>&gt;<br>
<b>Sent:</b> Wednesday, November 21, 2018 1:22:19 AM<br>
<b>To:</b> <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singu...@l=
bl.gov</a><br>
<b>Subject:</b> Re: [Singularity] Re: pull NVIDIA Tensorflow container in S=
ingularity without token</font>
<div>=C2=A0</div>
</div>
<div>
<div dir=3D"ltr">
<div>Rutu, sorry if I appear to be slightly unhelpful. I in fact have spent=
 a few hours setting up the same Ubuntu version as you under VirtualBox.</d=
iv>
<div>If you can explain to the list what you are trying to achieve precisel=
y, I think that would help.</div>
</div>
<br>
<div class=3D"m_-3752525239196178733m_4007550858250608376m_6633233797533712=
023x_gmail_quote">
<div dir=3D"ltr">On Wed, 21 Nov 2018 at 09:04, John Hearns &lt;<a href=3D"m=
ailto:hea...@googlemail.com" target=3D"_blank">hea...@googlemail.com</a>&gt=
; wrote:<br>
</div>
<blockquote class=3D"m_-3752525239196178733m_4007550858250608376m_663323379=
7533712023x_gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc so=
lid;padding-left:1ex">
<div dir=3D"ltr">
<div dir=3D"ltr">
<div>And a rather stupid question from me - you are running Ubuntu in a vir=
tual environment - VirtaullBox - on Windows.</div>
<div>All will be good for training I suppose - but is your intention to the=
n use the Singularity container on a system with a real GPU?</div>
<div><br>
</div>
<div>PCI passthrough seems only for Linux hosts</div>
<div><a href=3D"https://www.virtualbox.org/manual/ch09.html#pcipassthrough"=
 target=3D"_blank">https://www.virtualbox.org/manual/ch09.html#pcipassthrou=
gh</a></div>
<div><br>
</div>
</div>
</div>
<br>
<div class=3D"m_-3752525239196178733m_4007550858250608376m_6633233797533712=
023x_gmail_quote">
<div dir=3D"ltr">On Wed, 21 Nov 2018 at 08:58, John Hearns &lt;<a href=3D"m=
ailto:hea...@googlemail.com" target=3D"_blank">hea...@googlemail.com</a>&gt=
; wrote:<br>
</div>
<blockquote class=3D"m_-3752525239196178733m_4007550858250608376m_663323379=
7533712023x_gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc so=
lid;padding-left:1ex">
<div dir=3D"ltr">
<div dir=3D"ltr">
<div>Rutu, my advice would be to either:<br>
</div>
<div>Copy the file=C2=A0~/naked-singularity/definition-files/comet/tensorfl=
ow/tensorflow-gpu.def and adapt it to fit your needs.</div>
<div>Note that there are specific CUDA versions=C2=A0</div>
<div><br>
</div>
<div>Or try the Nvidia container download again. As Vanessa says we need th=
e exact command you use.</div>
<div><br>
</div>
<div>I now see I have started a circular dependence - Martin Kandes already=
 suggested you base your container on the tensorflor def file from naked-si=
ngularity.</div>
<div>Not that you build a complete environment for comet.</div>
<div><br>
</div>
<div><br>
</div>
<div><br>
</div>
<div><br>
</div>
<div><br>
</div>
</div>
</div>
<br>
<div class=3D"m_-3752525239196178733m_4007550858250608376m_6633233797533712=
023x_gmail_quote">
<div dir=3D"ltr">On Wed, 21 Nov 2018 at 08:37, John Hearns &lt;<a href=3D"m=
ailto:hea...@googlemail.com" target=3D"_blank">hea...@googlemail.com</a>&gt=
; wrote:<br>
</div>
<blockquote class=3D"m_-3752525239196178733m_4007550858250608376m_663323379=
7533712023x_gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc so=
lid;padding-left:1ex">
<div dir=3D"ltr">
<div dir=3D"ltr">
<div>Rutu, I am trying to replroduce your problem.</div>
<div><br>
</div>
<div>Note =C2=A0./naked-singularity.sh build -s comet -a ubuntu -d ubuntu.d=
ef =C2=A0 will build something specific for the Comet HPC machine at SDSC.<=
/div>
<div>The definition files for comet and tscc are in the directory definitio=
n-files</div>
<div>Somehow I dont think you should be building specifically for those env=
ironments - unless of course you are running at SDSC</div>
<div><br>
</div>
<div><br>
</div>
<div><br>
</div>
<div><br>
</div>
</div>
</div>
<br>
<div class=3D"m_-3752525239196178733m_4007550858250608376m_6633233797533712=
023x_gmail_quote">
<div dir=3D"ltr">On Wed, 21 Nov 2018 at 00:19, v &lt;<a href=3D"mailto:vso.=
..@gmail.com" target=3D"_blank">vso...@gmail.com</a>&gt; wrote:<br>
</div>
<blockquote class=3D"m_-3752525239196178733m_4007550858250608376m_663323379=
7533712023x_gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc so=
lid;padding-left:1ex">
<div dir=3D"ltr">
<div dir=3D"ltr">I&#39;m seeing some issues online about incorrect keyboard=
 mappings (so perhaps if you try other keys you can stumble on the remapped=
 enter, heh), and also configuring the Vagrantfile to use a GUI. This seems=
 like a problem with Vagrant - at least
 with Ubuntu you have to restart and enable your bios, did you do that? Cou=
ld you share the Vagrantfile that you ultimately produced? I think others o=
n the list can best help if you are able to share this. Otherwise it&#39;s =
like fishing in the dark. For containers.
 Which now that I think of it, would probably be pretty painful.</div>
</div>
<br>
<div class=3D"m_-3752525239196178733m_4007550858250608376m_6633233797533712=
023x_gmail_quote">
<div dir=3D"ltr">On Tue, Nov 20, 2018 at 6:56 PM Rutu Pandya &lt;<a href=3D=
"mailto:rut...@gmail.com" target=3D"_blank">rut...@gmail.com</a>&gt; wrote:=
<br>
</div>
<blockquote class=3D"m_-3752525239196178733m_4007550858250608376m_663323379=
7533712023x_gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc so=
lid;padding-left:1ex">
<div dir=3D"ltr">Thanks Martin, Vanessa.=C2=A0
<div>I started with Martin&#39;s Recipe file for tensorflow-gpu - And encou=
ntered a rather silly problem.=C2=A0</div>
<div><br>
</div>
<div>In the process it shows the following in the bash prompt, and I am una=
ble to make any selections. Tab, Enter, arrow keys, etc none work. How do I=
 proceed?=C2=A0</div>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658separator" style=3D"t=
ext-align:center;clear:both">
<img alt=3D"Capture.JPG" width=3D"320" height=3D"205" style=3D"margin-left:=
1em;margin-right:1em"></p>
<div><br>
<div>Here are the detailed steps I followed to create the environment using=
 Vagrant in Windows:=C2=A0</div>
<div><br>
</div>
<div>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpF=
irst">
<span style=3D"font-size:11.5pt;line-height:17.6333px;font-family:Arial,san=
s-serif;color:rgb(36,39,41)">1.<span style=3D"font-variant-numeric:normal;f=
ont-variant-east-asian:normal;font-stretch:normal;font-size:7pt;line-height=
:normal;font-family:&quot;Times New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0</=
span></span>Open
 git bash in admin mode<u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpM=
iddle">
<span style=3D"font-size:11.5pt;line-height:17.6333px;font-family:Arial,san=
s-serif;color:rgb(36,39,41)">2.<span style=3D"font-variant-numeric:normal;f=
ont-variant-east-asian:normal;font-stretch:normal;font-size:7pt;line-height=
:normal;font-family:&quot;Times New Roman&quot;">=C2=A0
 =C2=A0</span></span><u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpM=
iddle" style=3D"margin-left:1in">
a.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0</span>mkdir =
-p /E/work/containers/vagrant_ubuntu16<u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpM=
iddle" style=3D"margin-left:1in">
b.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0</span>cd /E/=
work/containers/vagrant_ubuntu16<u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpM=
iddle" style=3D"margin-left:1in">
c.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0</span>vagran=
t box add ubuntu/xenial64<u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpL=
ast" style=3D"margin-left:1in">
d.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0</span>vagran=
t init ubuntu/xenial64<u></u><u></u></p>
<p style=3D"margin:0in 0in 9.75pt;background-image:initial;background-posit=
ion:initial;background-size:initial;background-repeat:initial;background-or=
igin:initial;background-clip:initial">
<span style=3D"font-size:11.5pt;font-family:Arial,sans-serif;color:rgb(51,5=
1,51)">If we want to=C2=A0<a href=3D"https://www.vagrantup.com/docs/synced-=
folders/" style=3D"box-sizing:border-box;background-position:0px 0px" targe=
t=3D"_blank"><span style=3D"color:rgb(179,0,0)">sync
 folders</span></a>=C2=A0with our Windows host, edit=C2=A0</span><code styl=
e=3D"box-sizing:border-box;border-radius:4px"><span style=3D"font-size:10pt=
;font-family:Consolas;color:rgb(71,71,71);background:rgb(241,241,241)">Vagr=
antfile</span></code><span style=3D"font-size:11.5pt;font-family:Arial,sans=
-serif;color:rgb(51,51,51)">=C2=A0and
 add the following to it, right before the last line which says=C2=A0</span=
><code style=3D"box-sizing:border-box;border-radius:4px"><span style=3D"fon=
t-size:10pt;font-family:Consolas;color:rgb(71,71,71);background:rgb(241,241=
,241)">end</span></code><span style=3D"font-size:11.5pt;font-family:Arial,s=
ans-serif;color:rgb(51,51,51)">:<u></u><u></u></span></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpF=
irst" style=3D"margin-left:1in">
e.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0</span>config=
.vm.synced_folder &quot;vmfiles&quot;, &quot;/vagrant&quot;, type: &quot;sm=
b&quot;<u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpM=
iddle" style=3D"margin-left:1in;box-sizing:border-box">
f.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0</span>=
mkdir vmfiles<u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpM=
iddle" style=3D"margin-left:1in">
g.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0</span>vagran=
t plugin install vagrant-vbguest<u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpM=
iddle" style=3D"margin-left:1in">
h.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0</span>vagran=
t up =E2=80=93 will ask for windows username and pwd<u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpM=
iddle" style=3D"margin-left:1in">
i.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0<=
/span>vagrant ssh<u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpM=
iddle" style=3D"margin-left:1in;box-sizing:border-box">
j.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0<=
/span>sudo apt-get update<u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpM=
iddle" style=3D"margin-left:1in">
k.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0</span>sudo a=
pt-get install -y build-essential git autoconf libtool<u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpM=
iddle" style=3D"margin-left:1in">
l.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0<=
/span>sudo apt-get install -y debootstrap yum<u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpM=
iddle" style=3D"margin-left:1in">
m.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0</span>Singularity Instal=
l:Follow=C2=A0<a href=3D"https://www.sylabs.io/guides/3.0/user-guide/quick_=
start.html" target=3D"_blank">https://www.sylabs.io/guides/3.0/user-guide/q=
uick_start.html</a>=C2=A0-
 until compiling singularity binaries=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=
=C2=A0=C2=A0=C2=A0<u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpM=
iddle" style=3D"margin-left:1in">
n.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0</span>git cl=
one=C2=A0<a href=3D"https://github.com/mkandes/naked-singularity" target=3D=
"_blank">https://github.com/mkandes/naked-singularity</a>=C2=A0--&gt;
 Martin&#39;s definition files<u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpM=
iddle" style=3D"margin-left:1in;box-sizing:border-box">
o.<span style=3D"font-variant-numeric:normal;font-variant-east-asian:normal=
;font-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Tim=
es New Roman&quot;">=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0</span><span =
style=3D"font-size:9pt;line-height:13.8px;font-family:&quot;Lucida Console&=
quot;">cd
 naked-singularity</span><u></u><u></u></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpL=
ast" style=3D"margin:0in 0in 0.0001pt 1in;line-height:normal;background-ima=
ge:initial;background-position:initial;background-size:initial;background-r=
epeat:initial;background-origin:initial;background-clip:initial;box-sizing:=
border-box">
<span style=3D"font-size:9pt;font-family:Consolas;color:rgb(36,41,46)">p.<s=
pan style=3D"font-variant-numeric:normal;font-variant-east-asian:normal;fon=
t-stretch:normal;font-size:7pt;line-height:normal;font-family:&quot;Times N=
ew Roman&quot;">=C2=A0=C2=A0=C2=A0</span></span><span style=3D"font-size:9p=
t;font-family:Consolas;color:rgb(36,41,46)">bash
 naked-singularity.sh build -s comet -a tensorflow -d tensorflow-gpu.def --=
&gt;to build from the definition file</span></p>
<p class=3D"m_-3752525239196178733m_4007550858250608376m_663323379753371202=
3x_m_8242262533271519102m_5876358270068277841m_3538547889708718885m_-267703=
5585731715237m_3112044047991992876m_647309692705782658MsoListParagraphCxSpL=
ast" style=3D"margin:0in 0in 0.0001pt 1in;line-height:normal;background-ima=
ge:initial;background-position:initial;background-size:initial;background-r=
epeat:initial;background-origin:initial;background-clip:initial;box-sizing:=
border-box">
<br>
</p>
</div>
<div>Thanks,</div>
<div>Rutu</div>
<div><br>
</div>
<div><br>
</div>
On Monday, November 19, 2018 at 12:06:40 PM UTC-5, vanessa wrote:
<blockquote class=3D"m_-3752525239196178733m_4007550858250608376m_663323379=
7533712023x_gmail_quote" style=3D"margin:0;margin-left:0.8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
<div dir=3D"ltr">
<div dir=3D"ltr">
<div dir=3D"ltr">
<div dir=3D"ltr">If you are having trouble with pulling a container, it lik=
ely has to do with the URI, and if you provide the complete URI (unique res=
ource identifier) for the container others might be able to help to debug. =
For Docker Hub, this would be in the
 format &lt;namespace&gt;/&lt;repo&gt;:&lt;tag&gt;. If you have your token =
for nvidia cloud and know the full URI (and are careful to get the tag righ=
t, sometimes people assume that a &quot;latest&quot; exists and it doesn&#3=
9;t). if you are having trouble pulling you can also try the sregistry
 nvidia client, <a href=3D"https://singularityhub.github.io/sregistry-cli/c=
lient-nvidia" rel=3D"nofollow" target=3D"_blank">
documentationis here.</a>=C2=A0It would come down to something like:</div>
<div dir=3D"ltr"><br>
</div>
<div dir=3D"ltr">
<blockquote class=3D"m_-3752525239196178733m_4007550858250608376m_663323379=
7533712023x_gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left:1px =
solid rgb(204,204,204);padding-left:1ex">
$ export SREGISTRY_NVIDIA_TOKEN=3Dxxxxxxxxxxxxxxxxxxx=C2=A0</blockquote>
<blockquote class=3D"m_-3752525239196178733m_4007550858250608376m_663323379=
7533712023x_gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left:1px =
solid rgb(204,204,204);padding-left:1ex">
$ export SREGISTRY_CLIENT=3Dnvidia </blockquote>
<blockquote class=3D"m_-3752525239196178733m_4007550858250608376m_663323379=
7533712023x_gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left:1px =
solid rgb(204,204,204);padding-left:1ex">
$ sregistry pull tensorflow:17.11</blockquote>
<div><br>
</div>
<div>would pull the container, and then you would use it as a base to build=
 on top of:</div>
<div><br>
</div>
<blockquote class=3D"m_-3752525239196178733m_4007550858250608376m_663323379=
7533712023x_gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left:1px =
solid rgb(204,204,204);padding-left:1ex">
Bootstrap: localimage<br>
From: /path/to/tensorflow-17.11.simg</blockquote>
<div><br>
</div>
<div>You can also try using the various gpu tags provided a la nvidia Docke=
r, these are new docs, I am just finding them now!</div>
<div><br>
</div>
<div><a href=3D"https://www.tensorflow.org/install/docker#gpu_support" rel=
=3D"nofollow" target=3D"_blank">https://www.tensorflow.org/install/docker#g=
pu_support</a><br>
</div>
<div><br>
</div>
<div>and on Docker Hub:</div>
<div><br>
</div>
<div><a href=3D"https://hub.docker.com/r/tensorflow/tensorflow/" rel=3D"nof=
ollow" target=3D"_blank">https://hub.docker.com/r/tensorflow/tensorflow/</a=
><br>
</div>
<div><br>
</div>
<div>The issue with this image approach is that you are dependent on the co=
ntainer to build yours. I would=C2=A0+1 what Martin says in starting with a=
 recipe.</div>
<div><br>
</div>
<div>What I&#39;m not privy to / have not tested are if there are any poten=
tial issues with pull when doing it from Virtualbox. Possibly others have t=
ried? Hope this helps!</div>
</div>
</div>
</div>
</div>
<br>
<div class=3D"m_-3752525239196178733m_4007550858250608376m_6633233797533712=
023x_gmail_quote">
<div dir=3D"ltr">On Mon, Nov 19, 2018 at 11:50 AM Rutu Pandya &lt;<a rel=3D=
"nofollow">r...@gmail.com</a>&gt; wrote:<br>
</div>
<blockquote class=3D"m_-3752525239196178733m_4007550858250608376m_663323379=
7533712023x_gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc so=
lid;padding-left:1ex">
<div dir=3D"ltr">Thanks Vanessa,
<div><br>
</div>
<div>What I am really trying to do is start from the NVIDIA Tensorflow cont=
ainer and add some programs in it. And make this into a singularity contain=
er to use for others.=C2=A0</div>
<div>I downloaded Singularity 3.0 using vagrant and virtual box. And now tr=
ying to pull the NVIDIA tensorflow container to start with.=C2=A0</div>
<div><br>
</div>
<div>Thanks<br>
<br>
On Friday, November 16, 2018 at 3:38:38 PM UTC-5, Rutu Pandya wrote:
<blockquote class=3D"m_-3752525239196178733m_4007550858250608376m_663323379=
7533712023x_gmail_quote" style=3D"margin:0;margin-left:0.8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
<div dir=3D"ltr">
<div>Hello,</div>
<div><br>
</div>
I am trying to pull the tensorflow container from NVIDIA. It has the pull c=
ommand given. Unable to pull with error saying &quot;Got permission denied =
when trying to connect to the Docker daemon socket&quot;.=C2=A0
<div><br>
</div>
<div>Thanks!</div>
</div>
</blockquote>
</div>
</div>
<p></p>
-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to
<a rel=3D"nofollow">singu...@lbl.gov</a>.<br>
</blockquote>
</div>
<br clear=3D"all">
<div><br>
</div>
-- <br>
<div dir=3D"ltr">Vanessa Villamia Sochat<br>
Stanford University &#39;16<br>
<div>
<div>
<div>(603) 321-0676</div>
</div>
</div>
</div>
</blockquote>
</div>
</div>
<p></p>
-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to
<a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singu...@lbl.gov</a>.=
<br>
</blockquote>
</div>
<br clear=3D"all">
<div><br>
</div>
-- <br>
<div dir=3D"ltr" class=3D"m_-3752525239196178733m_4007550858250608376m_6633=
233797533712023x_m_8242262533271519102m_5876358270068277841m_35385478897087=
18885m_-2677035585731715237gmail_signature">
Vanessa Villamia Sochat<br>
Stanford University &#39;16<br>
<div>
<div>
<div>(603) 321-0676</div>
</div>
</div>
</div>
<p></p>
-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to
<a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singu...@lbl.gov</a>.=
<br>
</blockquote>
</div>
</blockquote>
</div>
</blockquote>
</div>
</blockquote>
</div>
<p></p>
-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to
<a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singu...@lbl.gov</a>.=
<br>
</div>
</div>


<p></p>

-- <br>
You received this message because you are subscribed to the Google Groups &=
quot;singularity&quot; group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singu...@lbl.=
gov</a>.<br>
</blockquote></div>
</blockquote></div>
</blockquote></div>

--000000000000c68518057b3eba5e--
