X-Received: by 10.182.120.129 with SMTP id lc1mr32829346obb.30.1448465937550;
        Wed, 25 Nov 2015 07:38:57 -0800 (PST)
X-BeenThere: singularity@lbl.gov
Received: by 10.107.152.71 with SMTP id a68ls2177293ioe.96.gmail; Wed, 25 Nov
 2015 07:38:57 -0800 (PST)
X-Received: by 10.66.97.4 with SMTP id dw4mr1484456pab.33.1448465937029;
        Wed, 25 Nov 2015 07:38:57 -0800 (PST)
Return-Path: <gmku...@lbl.gov>
Received: from fe4.lbl.gov (fe4.lbl.gov. [128.3.41.71])
        by mx.google.com with ESMTPS id y10si8239392par.131.2015.11.25.07.38.56
        for <singu...@lbl.gov>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Wed, 25 Nov 2015 07:38:57 -0800 (PST)
Received-SPF: pass (google.com: domain of gmku...@lbl.gov designates 209.85.220.51 as permitted sender) client-ip=209.85.220.51;
Authentication-Results: mx.google.com;
       spf=pass (google.com: domain of gmku...@lbl.gov designates 209.85.220.51 as permitted sender) smtp.mailfrom=gmku...@lbl.gov;
       dkim=pass head...@lbl-gov.20150623.gappssmtp.com
X-Ironport-SBRS: 4.8
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: A2FuAAB11VVWlDPcVdFehA5vgyWrCpATAQ2BZhcBBYFwhAICJYEbOBQBAQEBAQEBAw4BAQEBBwsLCR8wgx1bPAEBAQMBEhEEGQEBDCwECwsYKgICIRADAQUBHA4HBAEcBAGHdwMKCAWff4ExPjGKV3GEYwEFhkoNhGwBAQEHAQEBAQEBAQEBFAYKhkuCD4JuglOBVwsGAR0agwIvgRWOHYRXg2gBhSeGF4NSSYN4gnMQi2iDZIIlNoEXHwEBgkYNFgeBd1EBBoNcCBeBKgEBAQ
X-IronPort-AV: E=Sophos;i="5.20,343,1444719600"; 
   d="scan'208,217";a="6020420"
Received: from mail-pa0-f51.google.com ([209.85.220.51])
  by fe4.lbl.gov with ESMTP; 25 Nov 2015 07:38:26 -0800
Received: by pabfh17 with SMTP id fh17so62641700pab.0
        for <singu...@lbl.gov>; Wed, 25 Nov 2015 07:38:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=lbl-gov.20150623.gappssmtp.com; s=20150623;
        h=from:content-type:content-transfer-encoding:mime-version:subject
         :message-id:date:references:in-reply-to:to;
        bh=K9Kr+PAdt1t/oIvuGAbmbS3bhFvhc1+d8API0qCxMaw=;
        b=h3TiRXe4mxYBHOn6XG20oR40NqSFBkamngXPnGnpQoQz5SYMN5TUKn82JecuM0ItG8
         cE4kIyhIXPGetQ1Pl53DwWWdSL1JyfnpmbypPG2Un81dPqvb36KLs6aw7n7yQo19J59O
         2Ih8moCAVLKuj1EiH8XHkTwNwGl/0BbHfnjobHFtecPH+Tl0+FHBsKQiBBYDZv7DCz5A
         Emaxpg1WoSETjUbZIGoJZhEhUyGXuiMYynCK16fFuUouMn1SJmnJyLVjXLQJk6Ts8t5F
         P15fCeIT1PDME06ap91j+yATljJrSZAcej/+ysvXlb+b5uI2kQjzbOTCLz2HP9j+wk58
         f0ig==
X-Gm-Message-State: ALoCoQks569OK96A/SipjBLQDvalSkjnqcl4yRKfnH5J/+y9bTamoDOVfOVcln4bNvOFa1TV81zFtvKtblGDyZtd38baaFlFZ9DZ3CBJbmbrgMkCyNn8Q74dh+1ClVePWa6IIKrsJYl1
X-Received: by 10.66.227.129 with SMTP id sa1mr27896683pac.132.1448465906508;
        Wed, 25 Nov 2015 07:38:26 -0800 (PST)
X-Received: by 10.66.227.129 with SMTP id sa1mr27896662pac.132.1448465906367;
        Wed, 25 Nov 2015 07:38:26 -0800 (PST)
Return-Path: <gmku...@lbl.gov>
Received: from [10.235.31.250] ([166.170.40.180])
        by smtp.gmail.com with ESMTPSA id cs7sm22161456pad.35.2015.11.25.07.38.25
        for <singu...@lbl.gov>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Wed, 25 Nov 2015 07:38:25 -0800 (PST)
From: "Gregory M. Kurtzer" <gmku...@lbl.gov>
Content-Type: multipart/alternative;
	boundary=Apple-Mail-0788DA43-2D04-4480-B50C-3F2AB82104C3
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (1.0)
Subject: Re: [Singularity] Containment is cool!
Message-Id: <1DB9A730-27A1-4287-AB79-FEA88B4DAAA0@lbl.gov>
Date: Wed, 25 Nov 2015 07:38:24 -0800
References: <CAN7etTz7L8Q5U_R0GAPB2JF_R7pLfh+ez9pfiK0KesKJY25sVw@mail.gmail.com> <CAC_eze_j4ntKZbcdCmA60CPcFTV-6H+dynj0MfYsNhGwPjvwDA@mail.gmail.com> <08D3BEFA-1CB8-4426-AF11-1D46D23CED2B@lbl.gov> <CAA6Bz=cHibhot0kdnDft=FKZhxQBFS+4ViiqSNpdmsZ3poe8cw@mail.gmail.com>
In-Reply-To: <CAA6Bz=cHibhot0kdnDft=FKZhxQBFS+4ViiqSNpdmsZ3poe8cw@mail.gmail.com>
To: singularity@lbl.gov
X-Mailer: iPhone Mail (13B143)

--Apple-Mail-0788DA43-2D04-4480-B50C-3F2AB82104C3
Content-Type: text/plain;
	charset=utf-8
Content-Transfer-Encoding: quoted-printable

Hi Remy,

I also agree that Singularity may have lots of use cases outside of HPC as =
well! So much to do, so little time. LOL

I will start working on the dependency resolvers for Python and R soon and =
I would love some testers who already have really world problems to solve.=
=20

Additionally I've dedicated an entire page to use cases on the website, so =
if you have any you would like to share and make it part of the defined goa=
l of Singularity please write them up and forward to me.=20

Thanks!


Sent from my iPhone

> On Nov 25, 2015, at 6:10 AM, R=C3=A9my Dernat <rem...@gmail.com> wrote:
>=20
> Hi,
>=20
> The R / Python question is very important; we need that too. I had to cre=
ate recently a docker container for R to address a specific usage (with all=
 the security issues it could lead), while every other users are using envi=
ronement module for the rest of R usage. I am pretty curious about the resu=
lts you will get Chu. Please share your sapp application (sspec file) :)
>=20
> By the way, I think singularity could be use in many different way/domain=
 (not only hpc).
>=20
> Best,
> Remy
>=20
>=20
> 2015-11-24 18:35 GMT+01:00 Gregory M. Kurtzer <gmku...@lbl.gov>:
>> Hi Chu,
>>=20
>> Yes in a nutshell you can! With that said at the moment it will take lis=
ting every file in the "%files" section of the spec. I have hooks for build=
ing out the dependency resolvers to include Python and R, but at present it=
 only resolves binary LDD dependencies.=20
>>=20
>> Let me know if you have any further questions!
>>=20
>> Greg
>>=20
>>=20
>> Sent from my iPhone
>>=20
>>> On Nov 24, 2015, at 8:49 AM, Chu Ruilin <ruil...@gmail.com> wrote:
>>>=20
>>> very cool! Can I contain a complex application like R or Python with a =
lot of modules?=20
>>>=20
>>>> On Tue, Nov 24, 2015 at 8:34 AM, Gregory M. Kurtzer <gmku...@lbl.gov> =
wrote:
>>>> Last night I added a feature to contain the file system namespace with=
 an option. The default behavior for Singularity is to allow the contents o=
f the container to interact with relative paths, but it was not difficult t=
o restrict or limit that feature. While there is more that can be done with=
 capabilities and namespaces to limit any escape this provides the necessar=
y functionality.
>>>>=20
>>>> To test this, I wrote a quick C program which will try to break out of=
 a chroot container by climbing up a directory tree (1024 times in my examp=
le) until it reaches the top most location ('/'), and then does a "ls -l" t=
o show you where it landed. This program was then wrapped up into a SAPP co=
ntainer, and here are the results:
>>>>=20
>>>> [gmk@centos7-x64 demo]$ singularity install break_test.sapp
>>>> Installing: break_test.sapp
>>>> [gmk@centos7-x64 demo]$ singularity run break_test
>>>> total 32
>>>> lrwxrwxrwx.   1 0 0    7 Jul 29  2014 bin -> usr/bin
>>>> dr-xr-xr-x.   5 0 0 4096 Oct 16 22:31 boot
>>>> drwxr-xr-x.   3 0 0   17 Mar 10  2015 cgroup
>>>> drwxr-xr-x.  20 0 0 3180 Oct  9 19:12 dev
>>>> drwxr-xr-x.  84 0 0 8192 Nov 14 00:13 etc
>>>> drwxr-xr-x.   3 0 0   16 Aug  8  2014 home
>>>> lrwxrwxrwx.   1 0 0    7 Jul 29  2014 lib -> usr/lib
>>>> lrwxrwxrwx.   1 0 0    9 Jul 29  2014 lib64 -> usr/lib64
>>>> drwxr-xr-x.   2 0 0    6 Jun 10  2014 media
>>>> drwxr-xr-x.   2 0 0    6 Jun 10  2014 mnt
>>>> drwxr-xr-x.   2 0 0    6 Jun 10  2014 opt
>>>> dr-xr-xr-x. 405 0 0    0 Oct  9 19:12 proc
>>>> dr-xr-x---.  11 0 0 4096 Nov 24 06:17 root
>>>> drwxr-xr-x.  27 0 0  880 Nov 24 07:18 run
>>>> lrwxrwxrwx.   1 0 0    8 Jul 29  2014 sbin -> usr/sbin
>>>> drwxr-xr-x.   2 0 0    6 Jun 10  2014 srv
>>>> dr-xr-xr-x.  13 0 0    0 Oct  9 19:12 sys
>>>> drwxrwxrwt.  17 0 0 4096 Nov 24 07:27 tmp
>>>> drwxr-xr-x.  13 0 0 4096 Jul 29  2014 usr
>>>> drwxr-xr-x.  23 0 0 4096 Oct  9 19:12 var
>>>> [gmk@centos7-x64 demo]$ singularity run -c break_test
>>>> total 20
>>>> drwxrwxr-x. 2 1000 1000   24 Nov 24 07:27 bin
>>>> drwxrwxr-x. 2 1000 1000   55 Nov 24 07:30 dev
>>>> drwxrwxr-x. 2 1000 1000   56 Nov 24 07:27 etc
>>>> drwxrwxr-x. 3 1000 1000   16 Nov 24 07:27 home
>>>> drwxrwxr-x. 2 1000 1000 4096 Nov 24 07:27 lib64
>>>> -rw-rw-r--. 1 1000 1000    6 Nov 24 07:30 pids
>>>> -rwxr-xr-x. 1 1000 1000  638 Nov 24 07:27 singularity
>>>> -rwxr-xr-x. 1 1000 1000   43 Nov 24 07:27 singularity.exec
>>>> -rwxr-xr-x. 1 1000 1000   17 Nov 24 07:27 singularity.test
>>>>=20
>>>> You can see that the results are different when the "-c" run option (s=
hort for --contain) is used. The resulting root directory ('/') is differen=
t when the --contain option is used because the break_test could not escape=
 the Singularity container.
>>>>=20
>>>> --=20
>>>> Gregory M. Kurtzer
>>>> Technical Lead and HPC Systems Architect
>>>> High Performance Computing Services (HPCS)
>>>> University of California
>>>> Lawrence Berkeley National Laboratory
>>>> One Cyclotron Road, Berkeley, CA 94720
>>>> --=20
>>>> You received this message because you are subscribed to the Google Gro=
ups "singularity" group.
>>>> To unsubscribe from this group and stop receiving emails from it, send=
 an email to singu...@lbl.gov.
>>>=20
>>> --=20
>>> You received this message because you are subscribed to the Google Grou=
ps "singularity" group.
>>> To unsubscribe from this group and stop receiving emails from it, send =
an email to singu...@lbl.gov.
>>=20
>> --=20
>> You received this message because you are subscribed to the Google Group=
s "singularity" group.
>> To unsubscribe from this group and stop receiving emails from it, send a=
n email to singu...@lbl.gov.
>=20
> --=20
> You received this message because you are subscribed to the Google Groups=
 "singularity" group.
> To unsubscribe from this group and stop receiving emails from it, send an=
 email to singu...@lbl.gov.

--Apple-Mail-0788DA43-2D04-4480-B50C-3F2AB82104C3
Content-Type: text/html;
	charset=utf-8
Content-Transfer-Encoding: quoted-printable

<html><head><meta http-equiv=3D"content-type" content=3D"text/html; charset=
=3Dutf-8"></head><body dir=3D"auto"><div>Hi Remy,</div><div id=3D"AppleMail=
Signature"><br></div><div id=3D"AppleMailSignature">I also agree that Singu=
larity may have lots of use cases outside of HPC as well! So much to do, so=
 little time. LOL</div><div id=3D"AppleMailSignature"><br></div><div id=3D"=
AppleMailSignature">I will start working on the dependency resolvers for Py=
thon and R soon and I would love some testers who already have really world=
 problems to solve.&nbsp;</div><div id=3D"AppleMailSignature"><br></div><di=
v id=3D"AppleMailSignature">Additionally I've dedicated an entire page to u=
se cases on the website, so if you have any you would like to share and mak=
e it part of the defined goal of Singularity please write them up and forwa=
rd to me.&nbsp;</div><div id=3D"AppleMailSignature"><br></div><div id=3D"Ap=
pleMailSignature">Thanks!</div><div id=3D"AppleMailSignature"><br></div><di=
v id=3D"AppleMailSignature"><br>Sent from my iPhone</div><div><br>On Nov 25=
, 2015, at 6:10 AM, R=C3=A9my Dernat &lt;<a href=3D"mailto:rem...@gmail.com=
">rem...@gmail.com</a>&gt; wrote:<br><br></div><blockquote type=3D"cite"><d=
iv><div dir=3D"ltr">Hi,<div><br></div><div>The R / Python question is very =
important; we need that too. I had to create recently a docker container fo=
r R to address a specific usage (with all the security issues it could lead=
), while every other users are using environement module for the rest of R =
usage. I am pretty curious about the results you will get Chu. Please share=
 your sapp application (sspec file) :)</div><div><br></div><div>By the way,=
 I think singularity could be use in many different way/domain (not only hp=
c).</div><div><br></div><div>Best,<br>Remy</div><div><br></div></div><div c=
lass=3D"gmail_extra"><br><div class=3D"gmail_quote">2015-11-24 18:35 GMT+01=
:00 Gregory M. Kurtzer <span dir=3D"ltr">&lt;<a href=3D"mailto:gmku...@lbl.=
gov" target=3D"_blank">gmku...@lbl.gov</a>&gt;</span>:<br><blockquote class=
=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padd=
ing-left:1ex"><div dir=3D"auto"><div>Hi Chu,</div><div><br></div><div>Yes i=
n a nutshell you can! With that said at the moment it will take listing eve=
ry file in the "%files" section of the spec. I have hooks for building out =
the dependency resolvers to include Python and R, but at present it only re=
solves binary LDD dependencies.&nbsp;</div><div><br></div><div>Let me know =
if you have any further questions!</div><div><br></div><div>Greg</div><div>=
<br><br>Sent from my iPhone</div><div><div class=3D"h5"><div><br>On Nov 24,=
 2015, at 8:49 AM, Chu Ruilin &lt;<a href=3D"mailto:ruil...@gmail.com" targ=
et=3D"_blank">ruil...@gmail.com</a>&gt; wrote:<br><br></div><blockquote typ=
e=3D"cite"><div><div dir=3D"ltr">very cool! Can I contain a complex applica=
tion like R or Python with a lot of modules?&nbsp;</div><div class=3D"gmail=
_extra"><br><div class=3D"gmail_quote">On Tue, Nov 24, 2015 at 8:34 AM, Gre=
gory M. Kurtzer <span dir=3D"ltr">&lt;<a href=3D"mailto:gmku...@lbl.gov" ta=
rget=3D"_blank">gmku...@lbl.gov</a>&gt;</span> wrote:<br><blockquote class=
=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padd=
ing-left:1ex"><div dir=3D"ltr">Last night I added a feature to contain the =
file system namespace with an option. The default behavior for Singularity =
is to allow the contents of the container to interact with relative paths, =
but it was not difficult to restrict or limit that feature. While there is =
more that can be done with capabilities and namespaces to limit any escape =
this provides the necessary functionality.<div><br></div><div>To test this,=
 I wrote a quick C program which will try to break out of a chroot containe=
r by climbing up a directory tree (1024 times in my example) until it reach=
es the top most location ('/'), and then does a "ls -l" to show you where i=
t landed. This program was then wrapped up into a SAPP container, and here =
are the results:</div><div><br></div><div>[gmk@centos7-x64 demo]$ singulari=
ty install break_test.sapp</div><div>Installing: break_test.sapp</div><div>=
[gmk@centos7-x64 demo]$ singularity run break_test<br>total 32<br>lrwxrwxrw=
x. &nbsp; 1 0 0 &nbsp; &nbsp;7 Jul 29 &nbsp;2014 bin -&gt; usr/bin<br>dr-xr=
-xr-x. &nbsp; 5 0 0 4096 Oct 16 22:31 boot<br>drwxr-xr-x. &nbsp; 3 0 0 &nbs=
p; 17 Mar 10 &nbsp;2015 cgroup<br>drwxr-xr-x. &nbsp;20 0 0 3180 Oct &nbsp;9=
 19:12 dev<br>drwxr-xr-x. &nbsp;84 0 0 8192 Nov 14 00:13 etc<br>drwxr-xr-x.=
 &nbsp; 3 0 0 &nbsp; 16 Aug &nbsp;8 &nbsp;2014 home<br>lrwxrwxrwx. &nbsp; 1=
 0 0 &nbsp; &nbsp;7 Jul 29 &nbsp;2014 lib -&gt; usr/lib<br>lrwxrwxrwx. &nbs=
p; 1 0 0 &nbsp; &nbsp;9 Jul 29 &nbsp;2014 lib64 -&gt; usr/lib64<br>drwxr-xr=
-x. &nbsp; 2 0 0 &nbsp; &nbsp;6 Jun 10 &nbsp;2014 media<br>drwxr-xr-x. &nbs=
p; 2 0 0 &nbsp; &nbsp;6 Jun 10 &nbsp;2014 mnt<br>drwxr-xr-x. &nbsp; 2 0 0 &=
nbsp; &nbsp;6 Jun 10 &nbsp;2014 opt<br>dr-xr-xr-x. 405 0 0 &nbsp; &nbsp;0 O=
ct &nbsp;9 19:12 proc<br>dr-xr-x---. &nbsp;11 0 0 4096 Nov 24 06:17 root<br=
>drwxr-xr-x. &nbsp;27 0 0 &nbsp;880 Nov 24 07:18 run<br>lrwxrwxrwx. &nbsp; =
1 0 0 &nbsp; &nbsp;8 Jul 29 &nbsp;2014 sbin -&gt; usr/sbin<br>drwxr-xr-x. &=
nbsp; 2 0 0 &nbsp; &nbsp;6 Jun 10 &nbsp;2014 srv<br>dr-xr-xr-x. &nbsp;13 0 =
0 &nbsp; &nbsp;0 Oct &nbsp;9 19:12 sys<br>drwxrwxrwt. &nbsp;17 0 0 4096 Nov=
 24 07:27 tmp<br>drwxr-xr-x. &nbsp;13 0 0 4096 Jul 29 &nbsp;2014 usr<br>drw=
xr-xr-x. &nbsp;23 0 0 4096 Oct &nbsp;9 19:12 var<br>[gmk@centos7-x64 demo]$=
 singularity run -c break_test<br>total 20<br>drwxrwxr-x. 2 1000 1000 &nbsp=
; 24 Nov 24 07:27 bin<br>drwxrwxr-x. 2 1000 1000 &nbsp; 55 Nov 24 07:30 dev=
<br>drwxrwxr-x. 2 1000 1000 &nbsp; 56 Nov 24 07:27 etc<br>drwxrwxr-x. 3 100=
0 1000 &nbsp; 16 Nov 24 07:27 home<br>drwxrwxr-x. 2 1000 1000 4096 Nov 24 0=
7:27 lib64<br>-rw-rw-r--. 1 1000 1000 &nbsp; &nbsp;6 Nov 24 07:30 pids<br>-=
rwxr-xr-x. 1 1000 1000 &nbsp;638 Nov 24 07:27 singularity<br>-rwxr-xr-x. 1 =
1000 1000 &nbsp; 43 Nov 24 07:27 singularity.exec<br>-rwxr-xr-x. 1 1000 100=
0 &nbsp; 17 Nov 24 07:27 singularity.test<br><div><br></div><div>You can se=
e that the results are different when the "-c" run option (short for --cont=
ain) is used. The resulting root directory ('/') is different when the --co=
ntain option is used because the break_test could not escape the Singularit=
y container.</div><span><font color=3D"#888888"><div><br></div>-- <br><div>=
Gregory M. Kurtzer<br>Technical Lead and HPC Systems Architect<br>High Perf=
ormance Computing Services (HPCS)<br>University of California<br>Lawrence B=
erkeley National Laboratory<br>One Cyclotron Road, Berkeley, CA 94720</div>
</font></span></div></div><span><font color=3D"#888888">

<p></p>

-- <br>
You received this message because you are subscribed to the Google Groups "=
singularity" group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singu...@lbl.=
gov</a>.<br>
</font></span></blockquote></div><br></div>

<p></p>

-- <br>
You received this message because you are subscribed to the Google Groups "=
singularity" group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singu...@lbl.=
gov</a>.<br>
</div></blockquote></div></div></div><div class=3D"HOEnZb"><div class=3D"h5=
">

<p></p>

-- <br>
You received this message because you are subscribed to the Google Groups "=
singularity" group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" target=3D"_blank">singu...@lbl.=
gov</a>.<br>
</div></div></blockquote></div><br></div>

<p></p>

-- <br>
You received this message because you are subscribed to the Google Groups "=
singularity" group.<br>
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov">singu...@lbl.gov</a>.<br>
</div></blockquote></body></html>
--Apple-Mail-0788DA43-2D04-4480-B50C-3F2AB82104C3--
