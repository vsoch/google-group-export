X-Received: by 10.36.66.144 with SMTP id i138mr2186706itb.16.1498590106137;
        Tue, 27 Jun 2017 12:01:46 -0700 (PDT)
X-BeenThere: singularity@lbl.gov
Received: by 10.107.160.66 with SMTP id j63ls4128734ioe.54.gmail; Tue, 27 Jun
 2017 12:01:45 -0700 (PDT)
X-Received: by 10.98.18.143 with SMTP id 15mr6627671pfs.163.1498590104914;
        Tue, 27 Jun 2017 12:01:44 -0700 (PDT)
ARC-Seal: i=1; a=rsa-sha256; t=1498590104; cv=none;
        d=google.com; s=arc-20160816;
        b=J7gviqVTYfsBPaFAAinvLKLFFUHuUPtV6PqEDsHxwbYOb4ImN5bqAzKbxdpfHrOete
         EAi9skPBfsHwaJzP1qLgyey9N2i/ZlBb4FiWdCQeLf6Md7T7ie2JnHA6o+na+E21b4oB
         U7SdJWhoNBp2JZcX814m6BIku8juxmXGtrXvyDekWQMORsaj8NabkoMLwW4XyuPJAVlH
         OFBQf9F6eQ8hQWrlyrJImsviS3YGpRePwmNWS5ClQ9U+c6pG5NG8ov2iEuKWYzIVGHc7
         xDrxiRlQxWPV8f8w0F0bi/AXrSTIB+U3XQDPY0Z3UAsyhDvwaU8M4XvzeUMqjAhO2Qrg
         067A==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=message-id:in-reply-to:to:references:date:subject:mime-version:from
         :dkim-signature:arc-authentication-results;
        bh=R42bj1pn3zgfecQZ89F2y6amEvJeewKsOxhXB3HejS4=;
        b=L5Cl31rhev8S0lRLXjXjTU8+ajA3oBQ5+nlD+C6KCh/mldEa+KPxCGy6snKk5vXSUx
         45ngY4qodMDSPaiyb3z8SoWM7qF6VO7Js7Pa9i1rG7WtKm+EPxOpyUreQLjfyfDtNSeQ
         b3Opo15Vcq44uRQ/ff1WNeIO5YAJH7ZnS1IPNo/xk0yI7UZ4I0meCGT+0RC0PI3h+3gC
         ACjbrTO9CEF2LFQecWgIxZ9aWGHSrAbixySIlK2vpxDnfWNc7Nfd3vJaaUC39lGArxAg
         PJdLoiTVOnNC1lEKqWGWV8Tv57816yKPB1IdCMOKi6Ax+I1auOIhJSY+y43U74fpIVv+
         fi0w==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=pass head...@gmail.com header.b=L2UyzwjX;
       spf=pass (google.com: domain of davidg...@gmail.com designates 209.85.220.176 as permitted sender) smtp.mailfrom=davidg...@gmail.com
Return-Path: <davidg...@gmail.com>
Received: from fe3.lbl.gov (fe3.lbl.gov. [128.3.41.68])
        by mx.google.com with ESMTP id e65si22326pgc.26.2017.06.27.12.01.44
        for <singu...@lbl.gov>;
        Tue, 27 Jun 2017 12:01:44 -0700 (PDT)
Received-SPF: pass (google.com: domain of davidg...@gmail.com designates 209.85.220.176 as permitted sender) client-ip=209.85.220.176;
Authentication-Results: mx.google.com;
       dkim=pass head...@gmail.com header.b=L2UyzwjX;
       spf=pass (google.com: domain of davidg...@gmail.com designates 209.85.220.176 as permitted sender) smtp.mailfrom=davidg...@gmail.com
X-Ironport-SBRS: 3.4
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A2FnAAC1qlJZhrDcVdFZAxoBAQEBAgEBA?=
 =?us-ascii?q?QEIAQEBARUBAQEBAgEBAQEIAQEBAYJEIR2BDoEOg2QIihmRRCKCa5MSgU4bKCE?=
 =?us-ascii?q?BCoFvU4M7AoMBPxgBAQEBAQEBAQEBAQIQAQEBCAsLCCgvgjMFAgMaBgQERiYDL?=
 =?us-ascii?q?gEBAQEBAQEBAQEBAQEBAQEaAg0eBA8SAQEYAQEBAQIBGgEIBBkBDQ4eAwELBgU?=
 =?us-ascii?q?HBAoDIAEGAwICIQIOAwEFAQsRDgcEARwEiD2BOQEDDQgBBAukGT+MCYFsGAUBH?=
 =?us-ascii?q?IMIBYNgChknDVaDQAEBAQEGAQEBAQEBAQEYAgYJAQiDFYNMgWErC4FigQyCV4F?=
 =?us-ascii?q?kDAYBPQwagkwwgjEFiU2GeIFdhH+HEzuHNocDS4RnggoZPYguM4ZTiSuCPYRvg?=
 =?us-ascii?q?wUzgRUPEIEFMwswISNeEgEGgmaCAw8QDIICWgEHhlUBDhcELIFWEwEBAQ?=
X-IronPort-AV: E=Sophos;i="5.40,271,1496127600"; 
   d="scan'208,217";a="80480006"
Received: from mail-qk0-f176.google.com ([209.85.220.176])
  by fe3.lbl.gov with ESMTP; 27 Jun 2017 12:01:39 -0700
Received: by mail-qk0-f176.google.com with SMTP id 16so33345410qkg.2
        for <singu...@lbl.gov>; Tue, 27 Jun 2017 12:01:39 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20161025;
        h=from:mime-version:subject:date:references:to:in-reply-to:message-id;
        bh=R42bj1pn3zgfecQZ89F2y6amEvJeewKsOxhXB3HejS4=;
        b=L2UyzwjXttl0yUyofEgFcIth0JhCl8x8ocYSN8KizOw4w82+oCg0zusVWLYzDMPDhc
         ybmy9TrhqQrmUv+LSqoniGOnfqDHKNx9SdHNLpVuhILW/i/cYqVeE/NckTgQEh6nd6e0
         NJkzP8gtj0VMh4Y/IRkq3JaqWbP9V/tQeOKCu+WIkAZ/7vEAEBY5dOL2CWiW1L8c6L5e
         shgtUn6asiXdBCkz1xGyahmkYSNQEkN7LePWEwpCQb+vz59hdi2wmFF4gORjs9UFlz8y
         f7i5kTcK8mLpQ1h8ZLvqDQ/0XkmQ/Wh7iDv5r4KmoEjQvC7eCG1SKCxMeK5+hH4d97hL
         +V+A==
X-Gm-Message-State: AKS2vOzRSnNc04LdJonHTI0lcKlSIGoM4k9MHmrUiXBtoQSimYU06fXJ
	6PDfoKrz0BqgdbPJsMU=
X-Received: by 10.55.162.81 with SMTP id l78mr8763918qke.57.1498590098488;
        Tue, 27 Jun 2017 12:01:38 -0700 (PDT)
Return-Path: <davidg...@gmail.com>
Received: from ?IPv6:2601:14d:8300:cca0:10d1:a17b:458a:77ad? ([2601:14d:8300:cca0:10d1:a17b:458a:77ad])
        by smtp.gmail.com with ESMTPSA id n35sm26699qta.15.2017.06.27.12.01.36
        for <singu...@lbl.gov>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 27 Jun 2017 12:01:37 -0700 (PDT)
From: David Godlove <davidg...@gmail.com>
Content-Type: multipart/alternative;
 boundary="Apple-Mail=_299B5C84-5089-42D1-9375-8AAD0424BBCA"
Mime-Version: 1.0 (Mac OS X Mail 10.3 \(3273\))
Subject: Re: [Singularity] Basic question
Date: Tue, 27 Jun 2017 15:01:36 -0400
References: <e8c29047-8a78-4ddb-8635-f702910dbc51@lbl.gov>
 <CAM=pu++FZofp5z=40+dvmgcVmdmmHna4dUyQwcXsEY6TdW602g@mail.gmail.com>
 <5fba31e6-c9e1-4953-9a32-aa7498f84fdb@lbl.gov>
 <CAM=pu+JpmeSmSZ-Xg==+j6zRgQS6bdOS185BxWKVX0fRdDvh0w@mail.gmail.com>
 <144de14f-4399-4c7c-a04f-61a6a3ab830f@lbl.gov>
 <CAM=pu+LSsAO2To3S0hjkYk8f1jKxDDN-=1mF3tBSih9Yn_jQrg@mail.gmail.com>
 <36e2df02-7c07-47f7-8e36-9db5826d183d@lbl.gov>
 <485b652c-8d8e-4ae1-b6d7-e03af2079e95@lbl.gov>
 <CAGfAqt_8fGSc+VJG3AYPY5EGL5x7EwddKXp6XcVTfFWh9NLFVQ@mail.gmail.com>
 <696450B8-EB2E-4F4B-87B9-101F69D37B85@gmail.com>
 <CAGfAqt-fEoueZTr0MjiDaJvhFDp-jSUDZ0c3djRfu2NCpg7RJA@mail.gmail.com>
 <40DE1C11-7B5E-4EC4-9C8C-2F20F88985E4@gmail.com>
 <CAGfAqt-tqPhh_+1m5K6=8TKxOOC4ZgMAFD-ncr_my-V6OnO9xQ@mail.gmail.com>
 <039EE14A-E51F-4FA7-BD8A-90048396F09D@gmail.com>
 <3B004A04-A4B4-48E3-BAD9-E75072436231@gmail.com>
To: singularity@lbl.gov
In-Reply-To: <3B004A04-A4B4-48E3-BAD9-E75072436231@gmail.com>
Message-Id: <6A53E230-4870-4592-BC89-D2523C8263E5@gmail.com>
X-Mailer: Apple Mail (2.3273)

--Apple-Mail=_299B5C84-5089-42D1-9375-8AAD0424BBCA
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=utf-8

This is so anecdotal that I=E2=80=99m hesitant to even add it.  But here go=
es. =20

I experienced a similar issue a week or two ago when I was debugging a cont=
ainer on the NIH HPC cluster.  I had a container open as a normal user on a=
 compute node.  I was alternating between running it as a user and shelling=
 into it as root with the --writeable option to edit a file.  I had 2 diffe=
rent nodes allocated, one for my user tests and another for my root tinkeri=
ng.  Every time I would shell into the container as root with -w and then t=
ry to use the container as a normal user I would get the same error you des=
cribed:=20

ERROR  : Failed to mount image in (read only): Invalid argument
ABORT  : Retval =3D 255

I was using salloc and srun to create run in an interactive session (under =
Slurm).  Every time this occurred I was able to exit my normal user session=
 and allocate a new session.  This, of course, also gave me a new node.  So=
 there are a lot of variables at play. =20

So maybe something about running 2 copies of the same container with the -w=
 option?  Or maybe something about running one copy as root?  I don=E2=80=
=99t know.  Is this scenario similar at all to your use case?

=20
> On Jun 27, 2017, at 2:25 PM, Charles Murphy <murphy....@gmail.com> wrote:
>=20
> Though I should add that it might have something to do with my singularit=
y setup on my vagrant/virtualbox, singularity script, or environment variab=
les on the cluster. A co-worker who also uses singularity on the same clust=
er (and it does work for him) pointed me to an image file, which I was able=
 to successfully use on the cluster.
>=20
>> On Jun 27, 2017, at 12:50, Charles Murphy <murphy....@gmail.com <mailto:=
murphy....@gmail.com>> wrote:
>>=20
>> Jason,
>>=20
>> Seems like they are using the default kernels. On the cluster:
>> chm2059@cannes chm2059 $ uname -r
>> 3.10.0-514.6.2.el7.x86_64
>> On vagrant/virtualbox:
>>=20
>> vagrant@vagrant:~$ uname -r
>> 4.4.0-75-generic
>>=20
>>=20
>>=20
>>> On Jun 27, 2017, at 12:46, Jason Stover <jason...@gmail.com <mailto:jas=
on...@gmail.com>> wrote:
>>>=20
>>> Hi Charles,
>>>=20
>>>  Are those using the default kernels? So .... 3.10.0-514 for CentOS
>>> and 4.4 (???) on Ubuntu 16.04.2
>>>=20
>>>  Just guessing, it looks like singularity_image_mount_image_mount()
>>> is doing something wrong during the mount on /dev/loop on the cluster
>>> CentOS install
>>>=20
>>> Thanks,
>>> -Jason
>>>=20
>>> On Tue, Jun 27, 2017 at 11:12 AM, Charles Murphy
>>> <murphy....@gmail.com <mailto:murphy....@gmail.com>> wrote:
>>>> On my cluster (where it does not work):
>>>>=20
>>>> chm2059@cannes chm2059 $ cat /etc/*-release
>>>> CentOS Linux release 7.3.1611 (Core)
>>>> NAME=3D"CentOS Linux"
>>>> VERSION=3D"7 (Core)"
>>>> ID=3D"centos"
>>>> ID_LIKE=3D"rhel fedora"
>>>> VERSION_ID=3D"7"
>>>> PRETTY_NAME=3D"CentOS Linux 7 (Core)"
>>>> ANSI_COLOR=3D"0;31"
>>>> CPE_NAME=3D"cpe:/o:centos:centos:7"
>>>> HOME_URL=3D"https://www.centos.org/ <https://www.centos.org/>"
>>>> BUG_REPORT_URL=3D"https://bugs.centos.org/ <https://bugs.centos.org/>"
>>>>=20
>>>> CENTOS_MANTISBT_PROJECT=3D"CentOS-7"
>>>> CENTOS_MANTISBT_PROJECT_VERSION=3D"7"
>>>> REDHAT_SUPPORT_PRODUCT=3D"centos"
>>>> REDHAT_SUPPORT_PRODUCT_VERSION=3D"7"
>>>>=20
>>>> CentOS Linux release 7.3.1611 (Core)
>>>> CentOS Linux release 7.3.1611 (Core)
>>>>=20
>>>> On my vagrant/virtualbox machine (where it does work):
>>>>=20
>>>> vagrant@vagrant:~$ cat /etc/*release
>>>> DISTRIB_ID=3DUbuntu
>>>> DISTRIB_RELEASE=3D16.04
>>>> DISTRIB_CODENAME=3Dxenial
>>>> DISTRIB_DESCRIPTION=3D"Ubuntu 16.04.2 LTS"
>>>> NAME=3D"Ubuntu"
>>>> VERSION=3D"16.04.2 LTS (Xenial Xerus)"
>>>> ID=3Dubuntu
>>>> ID_LIKE=3Ddebian
>>>> PRETTY_NAME=3D"Ubuntu 16.04.2 LTS"
>>>> VERSION_ID=3D"16.04"
>>>> HOME_URL=3D"http://www.ubuntu.com/ <http://www.ubuntu.com/>"
>>>> SUPPORT_URL=3D"http://help.ubuntu.com/ <http://help.ubuntu.com/>"
>>>> BUG_REPORT_URL=3D"http://bugs.launchpad.net/ubuntu/ <http://bugs.launc=
hpad.net/ubuntu/>"
>>>> VERSION_CODENAME=3Dxenial
>>>> UBUNTU_CODENAME=3Dxenial
>>>>=20
>>>>=20
>>>>=20
>>>>=20
>>>> On Jun 27, 2017, at 12:09, Jason Stover <jason...@gmail.com <mailto:ja=
son...@gmail.com>> wrote:
>>>>=20
>>>> What distro (and kernel) is the cluster running compared to your virtu=
albox?
>>>>=20
>>>> -J
>>>>=20
>>>> On Tue, Jun 27, 2017 at 11:05 AM, Charles Murphy
>>>> <murphy....@gmail.com <mailto:murphy....@gmail.com>> wrote:
>>>>=20
>>>> I get the same error message.
>>>>=20
>>>> On Jun 27, 2017, at 12:04, Jason Stover <jason...@gmail.com <mailto:ja=
son...@gmail.com>> wrote:
>>>>=20
>>>> Hi Charles,
>>>>=20
>>>> Does a simple:
>>>>=20
>>>>  singularity exec gossamer.img ls
>>>>=20
>>>> work, or give you the same error when ran on the cluster?
>>>>=20
>>>> -J
>>>>=20
>>>>=20
>>>> On Tue, Jun 27, 2017 at 10:17 AM, Charles Murphy
>>>> <murphy....@gmail.com <mailto:murphy....@gmail.com>> wrote:
>>>>=20
>>>> Also, you can see for yourself. I build the image on singularity hub:
>>>> https://singularity-hub.org/containers/1464/ <https://singularity-hub.=
org/containers/1464/>
>>>>=20
>>>>=20
>>>> On Tuesday, June 27, 2017 at 11:14:44 AM UTC-4, Charles Murphy wrote:
>>>>=20
>>>>=20
>>>> The bootstrap script does install the xenome tool (it is part of the
>>>> gossamer package). Trying to shell into the image gives me the same er=
ror:
>>>>=20
>>>> chm2059@cannes chm2059 $ singularity shell gossamer.img
>>>> ERROR  : Failed to mount image in (read only): Invalid argument
>>>> ABORT  : Retval =3D 255
>>>>=20
>>>>=20
>>>> But shelling into the image on my vagrant/virtualbox machine does work=
:
>>>>=20
>>>> vagrant@vagrant:~$ singularity shell gossamer.img
>>>> Singularity: Invoking an interactive shell within container...
>>>>=20
>>>> Singularity gossamer.img:~>
>>>>=20
>>>>=20
>>>> On Tuesday, June 27, 2017 at 11:11:04 AM UTC-4, vanessa wrote:
>>>>=20
>>>>=20
>>>> Hi Charles,
>>>>=20
>>>> Does that software exist inside the image? I don't see a line to insta=
ll
>>>> anything called xenome, and it looks like you are binding. Does shell =
work?
>>>> You might try shell, and if it works, then try looking in /usr/local/b=
in to
>>>> see what is there. If you need software on your host in the container =
you
>>>> can either install it in the container (more reproducible) or bind the
>>>> directory it is in.
>>>>=20
>>>> Best,
>>>>=20
>>>> Vanessa
>>>>=20
>>>> On Tue, Jun 27, 2017 at 7:56 AM, Charles Murphy <mur...@gmail.com <htt=
p://gmail.com/>>
>>>> wrote:
>>>>=20
>>>>=20
>>>>=20
>>>>=20
>>>> chm2059@cannes chm2059 $ singularity --debug exec gossamer.img
>>>> /usr/local/bin/xenome -h
>>>> Enabling debugging
>>>> Ending argument loop
>>>> Singularity version: 2.3-dist
>>>> Exec'ing: /usr/libexec/singularity/cli/exec.exec
>>>> Evaluating args: 'gossamer.img /usr/local/bin/xenome -h'
>>>> VERBOSE [U=3D0,P=3D79809]      message_init()                         =
   Set
>>>> messagelevel to: 5
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()
>>>> Initialize configuration file: /etc/singularity/singularity.conf
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_config_parse()
>>>> Starting parse of configuration file /etc/singularity/singularity.conf
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key allow setuid =3D 'yes'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key allow pid ns =3D 'no'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key allow user image =3D 'yes'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key protected image mode =3D 'none'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key enable overlay =3D 'no'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key config passwd =3D 'yes'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key config group =3D 'yes'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key config resolv_conf =3D 'yes'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key mount proc =3D 'yes'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key mount sys =3D 'yes'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key mount dev =3D 'yes'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key mount home =3D 'yes'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key mount tmp =3D 'yes'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key mount hostfs =3D 'yes'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key bind path =3D '/etc/hosts'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key user bind control =3D 'yes'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key mount slave =3D 'yes'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key container dir =3D '/var/lib/singularity/mnt'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_config_parse()             =
   Got
>>>> config key singularity user =3D 'singularity'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_config_parse()
>>>> Finished parsing configuration file '/etc/singularity/singularity.conf=
'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_registry_init()
>>>> Initializing Singularity Registry
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Adding value to registry: 'SHELL' =3D '/bin/bash --norc'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Returning singularity_registry_set(SHELL, /bin/bash --norc) =3D 0
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Adding value to registry: 'LIBEXECDIR' =3D '/usr/libexec'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Returning singularity_registry_set(libexecdir, /usr/libexec) =3D 0
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Adding value to registry: 'COMMAND' =3D 'exec'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Returning singularity_registry_set(COMMAND, exec) =3D 0
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Adding value to registry: 'MESSAGELEVEL' =3D '5'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Returning singularity_registry_set(MESSAGELEVEL, 5) =3D 0
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Adding value to registry: 'VERSION' =3D '2.3-dist'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Returning singularity_registry_set(version, 2.3-dist) =3D 0
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Adding value to registry: 'LOCALSTATEDIR' =3D '/var'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Returning singularity_registry_set(localstatedir, /var) =3D 0
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Adding value to registry: 'SYSCONFDIR' =3D '/etc'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Returning singularity_registry_set(sysconfdir, /etc) =3D 0
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Adding value to registry: 'BINDIR' =3D '/usr/bin'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Returning singularity_registry_set(bindir, /usr/bin) =3D 0
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Adding value to registry: 'IMAGE' =3D 'gossamer.img'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_registry_set()
>>>> Returning singularity_registry_set(IMAGE, gossamer.img) =3D 0
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_registry_get()
>>>> Returning NULL on 'HOME'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_registry_get()
>>>> Returning NULL on 'TARGET_UID'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_registry_get()
>>>> Returning NULL on 'TARGET_GID'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_init()
>>>> Initializing user info
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_init()                =
   Set
>>>> the calling user's username to: chm2059
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_init()
>>>> Marking uinfo structure as ready
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_init()
>>>> Obtaining home directory
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_priv_init()                =
   Set
>>>> home (via getpwuid()) to: /home/chm2059
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_suid_init()
>>>> Running SUID program workflow
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_suid_init()
>>>> Checking program has appropriate permissions
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_suid_init()
>>>> Checking configuration file is properly owned by root
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_suid_init()
>>>> Checking if singularity.conf allows us to run as suid
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_config_get_bool_char_impl()
>>>> Called singularity_config_get_bool(allow setuid, yes)
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_config_get_value_impl()
>>>> Returning configuration value allow setuid=3D'yes'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_config_get_bool_char_impl()
>>>> Return singularity_config_get_bool(allow setuid, yes) =3D 1
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_registry_get()
>>>> Returning NULL on 'NOSUID'
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_priv_userns()
>>>> Invoking the user namespace
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_config_get_bool_char_impl()
>>>> Called singularity_config_get_bool(allow user ns, yes)
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_config_get_value_impl()    =
   No
>>>> configuration entry found for 'allow user ns'; returning default value=
 'yes'
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_config_get_bool_char_impl()
>>>> Return singularity_config_get_bool(allow user ns, yes) =3D 1
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_priv_userns()              =
   Not
>>>> virtualizing USER namespace: running as SUID
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_userns()
>>>> Returning singularity_priv_init(void)
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()
>>>> Dropping privileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()
>>>> Restoring supplementary groups
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_drop()
>>>> Confirming we have correct UID/GID
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_ns()
>>>> Calling: _singularity_runtime_ns_pid()
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_char_impl()
>>>> Called singularity_config_get_bool(allow pid ns, yes)
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_impl()
>>>> Returning configuration value allow pid ns=3D'no'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_char_impl()
>>>> Return singularity_config_get_bool(allow pid ns, yes) =3D 0
>>>> VERBOSE [U=3D8693,P=3D79809]   singularity_runtime_ns_pid()           =
   Not
>>>> virtualizing PID namespace by configuration
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_ns()
>>>> Calling: _singularity_runtime_ns_ipc()
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_char_impl()
>>>> Called singularity_config_get_bool(allow ipc ns, yes)
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_impl()    =
   No
>>>> configuration entry found for 'allow ipc ns'; returning default value =
'yes'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_char_impl()
>>>> Return singularity_config_get_bool(allow ipc ns, yes) =3D 1
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()
>>>> Returning NULL on 'UNSHARE_IPC'
>>>> VERBOSE [U=3D8693,P=3D79809]   singularity_runtime_ns_ipc()           =
   Not
>>>> virtualizing IPC namespace on user request
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_ns()
>>>> Calling: _singularity_runtime_ns_mnt()
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_char_impl()
>>>> Called singularity_config_get_bool(mount slave, yes)
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_impl()
>>>> Returning configuration value mount slave=3D'yes'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_bool_char_impl()
>>>> Return singularity_config_get_bool(mount slave, yes) =3D 1
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_escalate()
>>>> Temporarily escalating privileges (U=3D8693)
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_escalate()
>>>> Clearing supplementary GIDs.
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_runtime_ns_mnt()
>>>> Virtualizing FS namespace
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_runtime_ns_mnt()
>>>> Virtualizing mount namespace
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_runtime_ns_mnt()
>>>> Making mounts slave
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()
>>>> Dropping privileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()
>>>> Restoring supplementary groups
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_drop()
>>>> Confirming we have correct UID/GID
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()
>>>> Setting sessiondir
>>>> VERBOSE [U=3D8693,P=3D79809]   singularity_sessiondir()
>>>> Using session directory: /var/singularity/mnt/session
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()
>>>> Checking for session directory: /var/singularity/mnt/session
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()
>>>> Obtaining the default sessiondir size
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_impl()    =
   No
>>>> configuration entry found for 'sessiondir max size'; returning default=
 value
>>>> '16'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()
>>>> Converted sessiondir size to: 16
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()
>>>> Creating the sessiondir size mount option length
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()               =
   Got
>>>> size length of: 9
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()
>>>> Creating the sessiondir size mount option string
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_sessiondir()
>>>> Checking to make sure the string was allocated correctly
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_escalate()
>>>> Temporarily escalating privileges (U=3D8693)
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_escalate()
>>>> Clearing supplementary GIDs.
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_sessiondir()
>>>> Mounting sessiondir tmpfs: /var/singularity/mnt/session
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()
>>>> Dropping privileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()
>>>> Restoring supplementary groups
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_drop()
>>>> Confirming we have correct UID/GID
>>>> VERBOSE [U=3D8693,P=3D79809]   singularity_registry_set()
>>>> Adding value to registry: 'SESSIONDIR' =3D '/var/singularity/mnt/sessi=
on'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_set()
>>>> Returning singularity_registry_set(SESSIONDIR, /var/singularity/mnt/se=
ssion)
>>>> =3D 0
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()
>>>> Returning NULL on 'CLEANUPDIR'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()
>>>> Returning NULL on 'NOSESSIONCLEANUP'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()
>>>> Returning NULL on 'NOCLEANUP'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_cleanupd()                 =
   Not
>>>> running a cleanup thread, no 'SINGULARITY_CLEANUPDIR' defined
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()
>>>> Returning value from registry: 'IMAGE' =3D 'gossamer.img'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()
>>>> Returning NULL on 'WRITABLE'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_impl()    =
   No
>>>> configuration entry found for 'limit container owners'; returning defa=
ult
>>>> value 'NULL'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_impl()    =
   No
>>>> configuration entry found for 'limit container paths'; returning defau=
lt
>>>> value 'NULL'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_open()
>>>> Opening file descriptor to image: gossamer.img
>>>> VERBOSE [U=3D8693,P=3D79809]   singularity_image_check()
>>>> Checking that file pointer is a Singularity image
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_check()
>>>> First line of image(fd=3D6): #!/usr/bin/env run-singularity
>>>>=20
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_check()
>>>> Checking if first line matches key
>>>> VERBOSE [U=3D8693,P=3D79809]   singularity_image_check()
>>>> File is not a valid Singularity image
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_config_get_value_impl()    =
   No
>>>> configuration entry found for 'max loop devices'; returning default va=
lue
>>>> '256'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()
>>>> Entered singularity_image_bind()
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()
>>>> Converting max_loop_devs_string to int: '256'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()
>>>> Converted max_loop_devs_string to int: '256' -> 256
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()
>>>> Checking if this image has been properly opened
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()
>>>> Checking if image is valid file
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()
>>>> Checking if image is already bound to a loop device
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()
>>>> Returning NULL on 'WRITABLE'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()
>>>> Setting loopdev open to: O_RDONLY
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()
>>>> Setting LO_FLAGS_AUTOCLEAR
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_bind()
>>>> Calculating image offset
>>>> VERBOSE [U=3D8693,P=3D79809]   singularity_image_check()
>>>> Checking that file pointer is a Singularity image
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_check()
>>>> First line of image(fd=3D6): #!/usr/bin/env run-singularity
>>>>=20
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_check()
>>>> Checking if first line matches key
>>>> VERBOSE [U=3D8693,P=3D79809]   singularity_image_check()
>>>> File is not a valid Singularity image
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_offset()
>>>> File is not a Singularity image, returning zero offset
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_escalate()
>>>> Temporarily escalating privileges (U=3D8693)
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_escalate()
>>>> Clearing supplementary GIDs.
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_image_bind()
>>>> Finding next available loop device...
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_image_bind()
>>>> Found available loop device: /dev/loop0
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_image_bind()
>>>> Setting loop device flags
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()
>>>> Dropping privileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_drop()
>>>> Restoring supplementary groups
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_drop()
>>>> Confirming we have correct UID/GID
>>>> VERBOSE [U=3D8693,P=3D79809]   singularity_image_bind()
>>>> Using loop device: /dev/loop0
>>>> VERBOSE [U=3D8693,P=3D79809]   singularity_runtime_rootfs()           =
   Set
>>>> container directory to: /var/singularity/mnt/container
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_rootfs()
>>>> Checking for container directory
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_runtime_rootfs()
>>>> Returning container_directory: /var/singularity/mnt/container
>>>> DEBUG   [U=3D8693,P=3D79809]   chk_mode()
>>>> Checking exact mode (40755) on: /var/singularity/mnt/container
>>>> DEBUG   [U=3D8693,P=3D79809]   chk_mode()
>>>> Found appropriate mode on file: /var/singularity/mnt/container
>>>> VERBOSE [U=3D8693,P=3D79809]   singularity_image_mount()
>>>> Checking what kind of image we are mounting
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_mount_squashfs_check(=
)
>>>> Image does not appear to be of type '.sqsh': gossamer.img
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_image_mount_dir_check()
>>>> Checking if image is a directory
>>>> VERBOSE [U=3D8693,P=3D79809]   singularity_image_mount_dir_check()
>>>> Source path is not a directory: gossamer.img
>>>> VERBOSE [U=3D8693,P=3D79809]   singularity_image_mount()
>>>> Attempting to mount as singularity image
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_registry_get()
>>>> Returning NULL on 'WRITABLE'
>>>> DEBUG   [U=3D8693,P=3D79809]   singularity_priv_escalate()
>>>> Temporarily escalating privileges (U=3D8693)
>>>> DEBUG   [U=3D0,P=3D79809]      singularity_priv_escalate()
>>>> Clearing supplementary GIDs.
>>>> VERBOSE [U=3D0,P=3D79809]      singularity_image_mount_image_mount()
>>>> Mounting /dev/loop0 in read/only to: /var/singularity/mnt/container
>>>> ERROR   [U=3D0,P=3D79809]      singularity_image_mount_image_mount()
>>>> Failed to mount image in (read only): Invalid argument
>>>> ABORT   [U=3D0,P=3D79809]      singularity_image_mount_image_mount()
>>>> Retval =3D 255
>>>>=20
>>>> On Tuesday, June 27, 2017 at 10:54:11 AM UTC-4, vanessa wrote:
>>>>=20
>>>>=20
>>>> Could you provide the --debug output?
>>>>=20
>>>> On Tue, Jun 27, 2017 at 7:48 AM, Charles Murphy <mur...@gmail.com <htt=
p://gmail.com/>>
>>>> wrote:
>>>>=20
>>>>=20
>>>> Great! Thanks for your detailed response. I=E2=80=99ve been trying to =
run my
>>>> singularity image on my cluster, but hit an error. Here are my steps:
>>>>=20
>>>> 1. I setup an ubuntu (v16.4) on my Mac via vagrant/virtualbox
>>>>=20
>>>> 2. Install singularity (v2.3)
>>>>=20
>>>> 3. Ran the following:
>>>>=20
>>>> singularity create --size 2500 --force gossamer.img
>>>>=20
>>>> 4. Then ran the following:
>>>>=20
>>>> sudo singularity bootstrap gossamer.img Singularity
>>>>=20
>>>> My Singularity bootstrap file:
>>>>=20
>>>> Bootstrap: docker
>>>> From: ubuntu:16.04
>>>>=20
>>>> %setup
>>>>=20
>>>>  mkdir -p /scratchLocal
>>>>  mkdir -p /pbtech_mounts
>>>>  mkdir -p /athena
>>>>  mkdir -p /cluster001
>>>>  mkdir -p /scratch
>>>>=20
>>>> %post
>>>> apt-get update
>>>> apt-get -y install curl git g++ cmake libboost-all-dev pandoc
>>>> zlib1g-dev libbz2-dev libsqlite3-dev
>>>> git clone https://github.com/data61/gossamer <https://github.com/data6=
1/gossamer>
>>>> cd gossamer
>>>> mkdir build
>>>> cd build
>>>> cmake ..
>>>> make && make install
>>>>=20
>>>> The mkdir are for my particular cluster setup which I=E2=80=99 am told=
 I need
>>>> to include.
>>>>=20
>>>> 5. I copied gossamer.img to my cluster and get the following error
>>>> after trying to run it:
>>>>=20
>>>> chm2059@cannes chm2059 $ singularity exec gossamer.img
>>>> /usr/local/bin/xenome -h
>>>> ERROR  : Failed to mount image in (read only): Invalid argument
>>>> ABORT  : Retval =3D 255
>>>>=20
>>>> Note if I run that same command on my vagrant/virtualbox machine it
>>>> works fine. Any ideas on what the issue is? My cluster is running
>>>> singularity (v2.3-dist)
>>>>=20
>>>> On Wednesday, June 21, 2017 at 4:08:49 PM UTC-4, vanessa wrote:
>>>>=20
>>>>=20
>>>> Hey Charles!
>>>>=20
>>>> Here is some quick guidance:
>>>>=20
>>>>=20
>>>>=20
>>>> 1. Create the singularity image on an ubuntu GCE machine.
>>>>=20
>>>>=20
>>>>=20
>>>> This would definitely work, or you could use your own computer (or a
>>>> virtual machine on it) - see http://singularity.lbl.gov/install-mac <h=
ttp://singularity.lbl.gov/install-mac>. You
>>>> could also just define the build specification file (called "Singulari=
ty")
>>>> and put it in a Github repo, and have singularity hub build it for you
>>>> (guide is here
>>>> https://github.com/singularityhub/singularityhub.github.io/wiki <https=
://github.com/singularityhub/singularityhub.github.io/wiki>) The pull
>>>> command would be something like:
>>>>=20
>>>> singularity pull shub://username/reponame <shub://username/reponame>
>>>>=20
>>>>=20
>>>>=20
>>>>=20
>>>> 2. Copy the image to my cluster.
>>>>=20
>>>>=20
>>>>=20
>>>> Yes you could do this, or use Singularity Hub. Many ways to skin a
>>>> cat!
>>>>=20
>>>>=20
>>>> 3. Run the image and point it to the data on the cluster filesystem
>>>> for it to run on. Then get it's output and save to the cluster filesys=
tem.
>>>>=20
>>>> You would want to bind the data directory to the container (don't put
>>>> the data in the container!) Like:
>>>>=20
>>>>=20
>>>>=20
>>>> singularity exec  -B /scratch/data:/scratch username-reponame.img
>>>> /path/to/python script.py
>>>>=20
>>>>=20
>>>>=20
>>>> Notice in the above I am binding /scratch/data on the host to
>>>> /scratch in the container. If your cluster doesn't support overlay fs =
you
>>>> should be sure to create /scratch in the container.
>>>>=20
>>>> Sorry I think this is a basic question, but if anyone could help.
>>>> Thanks!
>>>>=20
>>>> --
>>>>=20
>>>>=20
>>>> No worries! That's why we have the list :O)
>>>>=20
>>>> Best,
>>>>=20
>>>> Vanessa
>>>>=20
>>>>=20
>>>> You received this message because you are subscribed to the Google
>>>> Groups "singularity" group.
>>>> To unsubscribe from this group and stop receiving emails from it,
>>>> send an email to singu...@lbl.gov <http://lbl.gov/>.
>>>>=20
>>>>=20
>>>>=20
>>>>=20
>>>>=20
>>>> --
>>>> Vanessa Villamia Sochat
>>>> Stanford University '16
>>>> (603) 321-0676
>>>>=20
>>>>=20
>>>> --
>>>> You received this message because you are subscribed to the Google
>>>> Groups "singularity" group.
>>>> To unsubscribe from this group and stop receiving emails from it, send
>>>> an email to singu...@lbl.gov <http://lbl.gov/>.
>>>>=20
>>>>=20
>>>>=20
>>>>=20
>>>>=20
>>>> --
>>>> Vanessa Villamia Sochat
>>>> Stanford University '16
>>>> (603) 321-0676
>>>>=20
>>>>=20
>>>> --
>>>> You received this message because you are subscribed to the Google
>>>> Groups "singularity" group.
>>>> To unsubscribe from this group and stop receiving emails from it, send
>>>> an email to singu...@lbl.gov <http://lbl.gov/>.
>>>>=20
>>>>=20
>>>>=20
>>>>=20
>>>>=20
>>>> --
>>>> Vanessa Villamia Sochat
>>>> Stanford University '16
>>>> (603) 321-0676
>>>>=20
>>>>=20
>>>> --
>>>> You received this message because you are subscribed to the Google Gro=
ups
>>>> "singularity" group.
>>>> To unsubscribe from this group and stop receiving emails from it, send=
 an
>>>> email to singu...@lbl.gov <mailto:singu...@lbl.gov>.
>>>>=20
>>>>=20
>>>> --
>>>> You received this message because you are subscribed to the Google Gro=
ups
>>>> "singularity" group.
>>>> To unsubscribe from this group and stop receiving emails from it, send=
 an
>>>> email to singu...@lbl.gov <mailto:singu...@lbl.gov>.
>>>>=20
>>>>=20
>>>> --
>>>> You received this message because you are subscribed to the Google Gro=
ups
>>>> "singularity" group.
>>>> To unsubscribe from this group and stop receiving emails from it, send=
 an
>>>> email to singu...@lbl.gov <mailto:singu...@lbl.gov>.
>>>>=20
>>>>=20
>>>> --
>>>> You received this message because you are subscribed to the Google Gro=
ups
>>>> "singularity" group.
>>>> To unsubscribe from this group and stop receiving emails from it, send=
 an
>>>> email to singu...@lbl.gov <mailto:singu...@lbl.gov>.
>>>>=20
>>>>=20
>>>> --
>>>> You received this message because you are subscribed to the Google Gro=
ups
>>>> "singularity" group.
>>>> To unsubscribe from this group and stop receiving emails from it, send=
 an
>>>> email to singu...@lbl.gov <mailto:singu...@lbl.gov>.
>>>=20
>>> --=20
>>> You received this message because you are subscribed to the Google Grou=
ps "singularity" group.
>>> To unsubscribe from this group and stop receiving emails from it, send =
an email to singu...@lbl.gov <mailto:singu...@lbl.gov>.
>>=20
>=20
>=20
> --=20
> You received this message because you are subscribed to the Google Groups=
 "singularity" group.
> To unsubscribe from this group and stop receiving emails from it, send an=
 email to singu...@lbl.gov <mailto:singu...@lbl.gov>.


--Apple-Mail=_299B5C84-5089-42D1-9375-8AAD0424BBCA
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html;
	charset=utf-8

<html><head><meta http-equiv=3D"Content-Type" content=3D"text/html charset=
=3Dutf-8"></head><body style=3D"word-wrap: break-word; -webkit-nbsp-mode: s=
pace; -webkit-line-break: after-white-space;" class=3D"">This is so anecdot=
al that I=E2=80=99m hesitant to even add it. &nbsp;But here goes. &nbsp;<di=
v class=3D""><br class=3D""></div><div class=3D"">I experienced a similar i=
ssue a week or two ago when I was debugging a container on the NIH HPC clus=
ter. &nbsp;I had a container open as a normal user on a compute node. &nbsp=
;I was alternating between running it as a user and shelling into it as roo=
t with the --writeable option to edit a file. &nbsp;I had 2 different nodes=
 allocated, one for my user tests and another for my root tinkering. &nbsp;=
Every time I would shell into the container as root with -w and then try to=
 use the container as a normal user I would get the same error you describe=
d:&nbsp;<div class=3D""><br class=3D""></div><div class=3D""><div class=3D"=
">ERROR &nbsp;: Failed to mount image in (read only): Invalid argument</div=
><div class=3D"">ABORT &nbsp;: Retval =3D 255</div><div class=3D""><br clas=
s=3D""></div><div class=3D"">I was using salloc and srun to create run in a=
n interactive session (under Slurm). &nbsp;Every time this occurred I was a=
ble to exit my normal user session and allocate a new session. &nbsp;This, =
of course, also gave me a new node. &nbsp;So there are a lot of variables a=
t play. &nbsp;</div><div class=3D""><br class=3D""></div><div class=3D"">So=
 maybe something about running 2 copies of the same container with the -w o=
ption? &nbsp;Or maybe something about running one copy as root? &nbsp;I don=
=E2=80=99t know. &nbsp;Is this scenario similar at all to your use case?</d=
iv><div class=3D""><br class=3D""></div><div class=3D"">&nbsp;<br class=3D"=
"><div><blockquote type=3D"cite" class=3D""><div class=3D"">On Jun 27, 2017=
, at 2:25 PM, Charles Murphy &lt;<a href=3D"mailto:murphy....@gmail.com" cl=
ass=3D"">murphy....@gmail.com</a>&gt; wrote:</div><br class=3D"Apple-interc=
hange-newline"><div class=3D""><meta http-equiv=3D"Content-Type" content=3D=
"text/html charset=3Dutf-8" class=3D""><div style=3D"word-wrap: break-word;=
 -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=3D=
"">Though I should add that it might have something to do with my singulari=
ty setup on my vagrant/virtualbox, singularity script, or environment varia=
bles on the cluster. A co-worker who also uses singularity on the same clus=
ter (and it does work for him) pointed me to an image file, which I was abl=
e to successfully use on the cluster.<div class=3D""><br class=3D""><div cl=
ass=3D""><blockquote type=3D"cite" class=3D""><div class=3D"">On Jun 27, 20=
17, at 12:50, Charles Murphy &lt;<a href=3D"mailto:murphy....@gmail.com" cl=
ass=3D"">murphy....@gmail.com</a>&gt; wrote:</div><br class=3D"Apple-interc=
hange-newline"><div class=3D""><meta http-equiv=3D"Content-Type" content=3D=
"text/html charset=3Dutf-8" class=3D""><div style=3D"word-wrap: break-word;=
 -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" class=3D=
"">Jason,<div class=3D""><br class=3D""></div><div class=3D"">Seems like th=
ey are using the default kernels. On the cluster:</div><div class=3D""><pre=
 style=3D"-webkit-print-color-adjust: exact; margin-top: 15px; margin-botto=
m: 15px; background-color: rgb(248, 248, 248); border: 1px solid rgb(204, 2=
04, 204); font-size: 13px; line-height: 19px; overflow: auto; padding: 6px =
10px; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bot=
tom-right-radius: 3px; border-bottom-left-radius: 3px;" class=3D""><code cl=
ass=3D"language-none" style=3D"-webkit-print-color-adjust: exact; margin: 0=
px; padding: 0px; border: none; background-color: transparent; border-top-l=
eft-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: =
3px; border-bottom-left-radius: 3px;">chm2059@cannes chm2059 $ uname -r
3.10.0-514.6.2.el7.x86_64</code></pre><div class=3D"">On vagrant/virtualbox=
:</div></div><div class=3D""><br class=3D""></div><div class=3D""><pre styl=
e=3D"-webkit-print-color-adjust: exact; margin-top: 15px; margin-bottom: 15=
px; background-color: rgb(248, 248, 248); border: 1px solid rgb(204, 204, 2=
04); font-size: 13px; line-height: 19px; overflow: auto; padding: 6px 10px;=
 border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-r=
ight-radius: 3px; border-bottom-left-radius: 3px;" class=3D""><code class=
=3D"language-none" style=3D"-webkit-print-color-adjust: exact; margin: 0px;=
 padding: 0px; border: none; background-color: transparent; border-top-left=
-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px=
; border-bottom-left-radius: 3px;">vagrant@vagrant:~$ uname -r
4.4.0-75-generic</code></pre><div class=3D""><br class=3D""></div></div><di=
v class=3D""><br class=3D""></div><div class=3D""><br class=3D""><div class=
=3D""><blockquote type=3D"cite" class=3D""><div class=3D"">On Jun 27, 2017,=
 at 12:46, Jason Stover &lt;<a href=3D"mailto:jason...@gmail.com" class=3D"=
">jason...@gmail.com</a>&gt; wrote:</div><br class=3D"Apple-interchange-new=
line"><div class=3D""><div class=3D"">Hi Charles,<br class=3D""><br class=
=3D""> &nbsp;Are those using the default kernels? So .... 3.10.0-514 for Ce=
ntOS<br class=3D"">and 4.4 (???) on Ubuntu 16.04.2<br class=3D""><br class=
=3D""> &nbsp;Just guessing, it looks like singularity_image_mount_image_mou=
nt()<br class=3D"">is doing something wrong during the mount on /dev/loop o=
n the cluster<br class=3D"">CentOS install<br class=3D""><br class=3D"">Tha=
nks,<br class=3D"">-Jason<br class=3D""><br class=3D"">On Tue, Jun 27, 2017=
 at 11:12 AM, Charles Murphy<br class=3D"">&lt;<a href=3D"mailto:murphy....=
@gmail.com" class=3D"">murphy....@gmail.com</a>&gt; wrote:<br class=3D""><b=
lockquote type=3D"cite" class=3D"">On my cluster (where it does not work):<=
br class=3D""><br class=3D"">chm2059@cannes chm2059 $ cat /etc/*-release<br=
 class=3D"">CentOS Linux release 7.3.1611 (Core)<br class=3D"">NAME=3D"Cent=
OS Linux"<br class=3D"">VERSION=3D"7 (Core)"<br class=3D"">ID=3D"centos"<br=
 class=3D"">ID_LIKE=3D"rhel fedora"<br class=3D"">VERSION_ID=3D"7"<br class=
=3D"">PRETTY_NAME=3D"CentOS Linux 7 (Core)"<br class=3D"">ANSI_COLOR=3D"0;3=
1"<br class=3D"">CPE_NAME=3D"cpe:/o:centos:centos:7"<br class=3D"">HOME_URL=
=3D"<a href=3D"https://www.centos.org/" class=3D"">https://www.centos.org/<=
/a>"<br class=3D"">BUG_REPORT_URL=3D"<a href=3D"https://bugs.centos.org/" c=
lass=3D"">https://bugs.centos.org/</a>"<br class=3D""><br class=3D"">CENTOS=
_MANTISBT_PROJECT=3D"CentOS-7"<br class=3D"">CENTOS_MANTISBT_PROJECT_VERSIO=
N=3D"7"<br class=3D"">REDHAT_SUPPORT_PRODUCT=3D"centos"<br class=3D"">REDHA=
T_SUPPORT_PRODUCT_VERSION=3D"7"<br class=3D""><br class=3D"">CentOS Linux r=
elease 7.3.1611 (Core)<br class=3D"">CentOS Linux release 7.3.1611 (Core)<b=
r class=3D""><br class=3D"">On my vagrant/virtualbox machine (where it does=
 work):<br class=3D""><br class=3D"">vagrant@vagrant:~$ cat /etc/*release<b=
r class=3D"">DISTRIB_ID=3DUbuntu<br class=3D"">DISTRIB_RELEASE=3D16.04<br c=
lass=3D"">DISTRIB_CODENAME=3Dxenial<br class=3D"">DISTRIB_DESCRIPTION=3D"Ub=
untu 16.04.2 LTS"<br class=3D"">NAME=3D"Ubuntu"<br class=3D"">VERSION=3D"16=
.04.2 LTS (Xenial Xerus)"<br class=3D"">ID=3Dubuntu<br class=3D"">ID_LIKE=
=3Ddebian<br class=3D"">PRETTY_NAME=3D"Ubuntu 16.04.2 LTS"<br class=3D"">VE=
RSION_ID=3D"16.04"<br class=3D"">HOME_URL=3D"<a href=3D"http://www.ubuntu.c=
om/" class=3D"">http://www.ubuntu.com/</a>"<br class=3D"">SUPPORT_URL=3D"<a=
 href=3D"http://help.ubuntu.com/" class=3D"">http://help.ubuntu.com/</a>"<b=
r class=3D"">BUG_REPORT_URL=3D"<a href=3D"http://bugs.launchpad.net/ubuntu/=
" class=3D"">http://bugs.launchpad.net/ubuntu/</a>"<br class=3D"">VERSION_C=
ODENAME=3Dxenial<br class=3D"">UBUNTU_CODENAME=3Dxenial<br class=3D""><br c=
lass=3D""><br class=3D""><br class=3D""><br class=3D"">On Jun 27, 2017, at =
12:09, Jason Stover &lt;<a href=3D"mailto:jason...@gmail.com" class=3D"">ja=
son...@gmail.com</a>&gt; wrote:<br class=3D""><br class=3D"">What distro (a=
nd kernel) is the cluster running compared to your virtualbox?<br class=3D"=
"><br class=3D"">-J<br class=3D""><br class=3D"">On Tue, Jun 27, 2017 at 11=
:05 AM, Charles Murphy<br class=3D"">&lt;<a href=3D"mailto:murphy....@gmail=
.com" class=3D"">murphy....@gmail.com</a>&gt; wrote:<br class=3D""><br clas=
s=3D"">I get the same error message.<br class=3D""><br class=3D"">On Jun 27=
, 2017, at 12:04, Jason Stover &lt;<a href=3D"mailto:jason...@gmail.com" cl=
ass=3D"">jason...@gmail.com</a>&gt; wrote:<br class=3D""><br class=3D"">Hi =
Charles,<br class=3D""><br class=3D"">Does a simple:<br class=3D""><br clas=
s=3D""> &nbsp;singularity exec gossamer.img ls<br class=3D""><br class=3D""=
>work, or give you the same error when ran on the cluster?<br class=3D""><b=
r class=3D"">-J<br class=3D""><br class=3D""><br class=3D"">On Tue, Jun 27,=
 2017 at 10:17 AM, Charles Murphy<br class=3D"">&lt;<a href=3D"mailto:murph=
y....@gmail.com" class=3D"">murphy....@gmail.com</a>&gt; wrote:<br class=3D=
""><br class=3D"">Also, you can see for yourself. I build the image on sing=
ularity hub:<br class=3D""><a href=3D"https://singularity-hub.org/container=
s/1464/" class=3D"">https://singularity-hub.org/containers/1464/</a><br cla=
ss=3D""><br class=3D""><br class=3D"">On Tuesday, June 27, 2017 at 11:14:44=
 AM UTC-4, Charles Murphy wrote:<br class=3D""><br class=3D""><br class=3D"=
">The bootstrap script does install the xenome tool (it is part of the<br c=
lass=3D"">gossamer package). Trying to shell into the image gives me the sa=
me error:<br class=3D""><br class=3D"">chm2059@cannes chm2059 $ singularity=
 shell gossamer.img<br class=3D"">ERROR &nbsp;: Failed to mount image in (r=
ead only): Invalid argument<br class=3D"">ABORT &nbsp;: Retval =3D 255<br c=
lass=3D""><br class=3D""><br class=3D"">But shelling into the image on my v=
agrant/virtualbox machine does work:<br class=3D""><br class=3D"">vagrant@v=
agrant:~$ singularity shell gossamer.img<br class=3D"">Singularity: Invokin=
g an interactive shell within container...<br class=3D""><br class=3D"">Sin=
gularity gossamer.img:~&gt;<br class=3D""><br class=3D""><br class=3D"">On =
Tuesday, June 27, 2017 at 11:11:04 AM UTC-4, vanessa wrote:<br class=3D""><=
br class=3D""><br class=3D"">Hi Charles,<br class=3D""><br class=3D"">Does =
that software exist inside the image? I don't see a line to install<br clas=
s=3D"">anything called xenome, and it looks like you are binding. Does shel=
l work?<br class=3D"">You might try shell, and if it works, then try lookin=
g in /usr/local/bin to<br class=3D"">see what is there. If you need softwar=
e on your host in the container you<br class=3D"">can either install it in =
the container (more reproducible) or bind the<br class=3D"">directory it is=
 in.<br class=3D""><br class=3D"">Best,<br class=3D""><br class=3D"">Vaness=
a<br class=3D""><br class=3D"">On Tue, Jun 27, 2017 at 7:56 AM, Charles Mur=
phy &lt;murphy....@<a href=3D"http://gmail.com/" class=3D"">gmail.com</a>&g=
t;<br class=3D"">wrote:<br class=3D""><br class=3D""><br class=3D""><br cla=
ss=3D""><br class=3D"">chm2059@cannes chm2059 $ singularity --debug exec go=
ssamer.img<br class=3D"">/usr/local/bin/xenome -h<br class=3D"">Enabling de=
bugging<br class=3D"">Ending argument loop<br class=3D"">Singularity versio=
n: 2.3-dist<br class=3D"">Exec'ing: /usr/libexec/singularity/cli/exec.exec<=
br class=3D"">Evaluating args: 'gossamer.img /usr/local/bin/xenome -h'<br c=
lass=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message_i=
nit() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;Set<br class=3D"">messagelevel to: 5<br class=3D"">VERBOS=
E [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_config_parse(=
)<br class=3D"">Initialize configuration file: /etc/singularity/singularity=
.conf<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;singularity_config_parse()<br class=3D"">Starting parse of confi=
guration file /etc/singularity/singularity.conf<br class=3D"">VERBOSE [U=3D=
0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_config_parse() &nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;Got<br class=3D"">config key allow setuid =3D 'yes'<br class=3D""=
>VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_config=
_parse() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;Got<br class=3D"">config key allow pid ns =3D 'no'<=
br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singu=
larity_config_parse() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Got<br class=3D"">config key allow use=
r image =3D 'yes'<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;singularity_config_parse() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Got<br class=3D"">co=
nfig key protected image mode =3D 'none'<br class=3D"">VERBOSE [U=3D0,P=3D7=
9809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_config_parse() &nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;Got<br class=3D"">config key enable overlay =3D 'no'<br class=3D"">VERBO=
SE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_config_parse=
() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;Got<br class=3D"">config key config passwd =3D 'yes'<br c=
lass=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singulari=
ty_config_parse() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Got<br class=3D"">config key config group =
=3D 'yes'<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;singularity_config_parse() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Got<br class=3D"">config key=
 config resolv_conf =3D 'yes'<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;singularity_config_parse() &nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Got<br c=
lass=3D"">config key mount proc =3D 'yes'<br class=3D"">VERBOSE [U=3D0,P=3D=
79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_config_parse() &nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;Got<br class=3D"">config key mount sys =3D 'yes'<br class=3D"">VERBOSE =
[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_config_parse() =
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;Got<br class=3D"">config key mount dev =3D 'yes'<br class=3D=
"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_conf=
ig_parse() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;Got<br class=3D"">config key mount home =3D 'yes'=
<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sing=
ularity_config_parse() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Got<br class=3D"">config key mount tm=
p =3D 'yes'<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;singularity_config_parse() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Got<br class=3D"">config k=
ey mount hostfs =3D 'yes'<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;singularity_config_parse() &nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Got<br class=
=3D"">config key bind path =3D '/etc/hosts'<br class=3D"">VERBOSE [U=3D0,P=
=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_config_parse() &nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;Got<br class=3D"">config key user bind control =3D 'yes'<br class=3D=
"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_conf=
ig_parse() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;Got<br class=3D"">config key mount slave =3D 'yes=
'<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin=
gularity_config_parse() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Got<br class=3D"">config key contain=
er dir =3D '/var/lib/singularity/mnt'<br class=3D"">VERBOSE [U=3D0,P=3D7980=
9] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_config_parse() &nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
Got<br class=3D"">config key singularity user =3D 'singularity'<br class=3D=
"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singul=
arity_config_parse()<br class=3D"">Finished parsing configuration file '/et=
c/singularity/singularity.conf'<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_registry_init()<br class=3D"">Initia=
lizing Singularity Registry<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;singularity_registry_set()<br class=3D"">Adding valu=
e to registry: 'SHELL' =3D '/bin/bash --norc'<br class=3D"">DEBUG &nbsp;&nb=
sp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_registry_set=
()<br class=3D"">Returning singularity_registry_set(SHELL, /bin/bash --norc=
) =3D 0<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;singularity_registry_set()<br class=3D"">Adding value to registry: 'LIBE=
XECDIR' =3D '/usr/libexec'<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809=
] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_registry_set()<br class=3D"">Re=
turning singularity_registry_set(libexecdir, /usr/libexec) =3D 0<br class=
=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_r=
egistry_set()<br class=3D"">Adding value to registry: 'COMMAND' =3D 'exec'<=
br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;singularity_registry_set()<br class=3D"">Returning singularity_registr=
y_set(COMMAND, exec) =3D 0<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;singularity_registry_set()<br class=3D"">Adding value=
 to registry: 'MESSAGELEVEL' =3D '5'<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0=
,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_registry_set()<br cla=
ss=3D"">Returning singularity_registry_set(MESSAGELEVEL, 5) =3D 0<br class=
=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_r=
egistry_set()<br class=3D"">Adding value to registry: 'VERSION' =3D '2.3-di=
st'<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;singularity_registry_set()<br class=3D"">Returning singularity_reg=
istry_set(version, 2.3-dist) =3D 0<br class=3D"">VERBOSE [U=3D0,P=3D79809] =
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_registry_set()<br class=3D"">Addi=
ng value to registry: 'LOCALSTATEDIR' =3D '/var'<br class=3D"">DEBUG &nbsp;=
&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_registry_=
set()<br class=3D"">Returning singularity_registry_set(localstatedir, /var)=
 =3D 0<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;singularity_registry_set()<br class=3D"">Adding value to registry: 'SYSCO=
NFDIR' =3D '/etc'<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;singularity_registry_set()<br class=3D"">Returning s=
ingularity_registry_set(sysconfdir, /etc) =3D 0<br class=3D"">VERBOSE [U=3D=
0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_registry_set()<br cl=
ass=3D"">Adding value to registry: 'BINDIR' =3D '/usr/bin'<br class=3D"">DE=
BUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity=
_registry_set()<br class=3D"">Returning singularity_registry_set(bindir, /u=
sr/bin) =3D 0<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;singularity_registry_set()<br class=3D"">Adding value to registry:=
 'IMAGE' =3D 'gossamer.img'<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D7980=
9] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_registry_set()<br class=3D"">R=
eturning singularity_registry_set(IMAGE, gossamer.img) =3D 0<br class=3D"">=
DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singulari=
ty_registry_get()<br class=3D"">Returning NULL on 'HOME'<br class=3D"">DEBU=
G &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_r=
egistry_get()<br class=3D"">Returning NULL on 'TARGET_UID'<br class=3D"">DE=
BUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity=
_registry_get()<br class=3D"">Returning NULL on 'TARGET_GID'<br class=3D"">=
DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singulari=
ty_priv_init()<br class=3D"">Initializing user info<br class=3D"">DEBUG &nb=
sp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_priv_i=
nit() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set<br class=3D"">the calling user's=
 username to: chm2059<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_priv_init()<br class=3D"">Marking ui=
nfo structure as ready<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_priv_init()<br class=3D"">Obtaining=
 home directory<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;singularity_priv_init() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set<br =
class=3D"">home (via getpwuid()) to: /home/chm2059<br class=3D"">VERBOSE [U=
=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_suid_init()<br cl=
ass=3D"">Running SUID program workflow<br class=3D"">VERBOSE [U=3D0,P=3D798=
09] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_suid_init()<br class=3D"">Che=
cking program has appropriate permissions<br class=3D"">VERBOSE [U=3D0,P=3D=
79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_suid_init()<br class=3D"">=
Checking configuration file is properly owned by root<br class=3D"">VERBOSE=
 [U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_suid_init()<br=
 class=3D"">Checking if singularity.conf allows us to run as suid<br class=
=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin=
gularity_config_get_bool_char_impl()<br class=3D"">Called singularity_confi=
g_get_bool(allow setuid, yes)<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79=
809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_config_get_value_impl()<br c=
lass=3D"">Returning configuration value allow setuid=3D'yes'<br class=3D"">=
DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singulari=
ty_config_get_bool_char_impl()<br class=3D"">Return singularity_config_get_=
bool(allow setuid, yes) =3D 1<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79=
809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_registry_get()<br class=3D""=
>Returning NULL on 'NOSUID'<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;singularity_priv_userns()<br class=3D"">Invoking the=
 user namespace<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;singularity_config_get_bool_char_impl()<br class=3D"">=
Called singularity_config_get_bool(allow user ns, yes)<br class=3D"">DEBUG =
&nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_con=
fig_get_value_impl() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;No<br class=3D"">c=
onfiguration entry found for 'allow user ns'; returning default value 'yes'=
<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;singularity_config_get_bool_char_impl()<br class=3D"">Return singular=
ity_config_get_bool(allow user ns, yes) =3D 1<br class=3D"">VERBOSE [U=3D0,=
P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_priv_userns() &nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;Not<br class=3D"">virtualizing USER namespace: running as SUID=
<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;singularity_priv_userns()<br class=3D"">Returning singularity_priv_in=
it(void)<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;singularity_priv_drop()<br class=3D"">Dropping privileges to =
UID=3D8693, GID=3D1056 (2 supplementary GIDs)<br class=3D"">DEBUG &nbsp;&nb=
sp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_priv_drop()<=
br class=3D"">Restoring supplementary groups<br class=3D"">DEBUG &nbsp;&nbs=
p;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_priv_drop()<br class=3D"">Co=
nfirming we have correct UID/GID<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,=
P=3D79809] &nbsp;&nbsp;singularity_runtime_ns()<br class=3D"">Calling: _sin=
gularity_runtime_ns_pid()<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D798=
09] &nbsp;&nbsp;singularity_config_get_bool_char_impl()<br class=3D"">Calle=
d singularity_config_get_bool(allow pid ns, yes)<br class=3D"">DEBUG &nbsp;=
&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_config_get_value_impl()<=
br class=3D"">Returning configuration value allow pid ns=3D'no'<br class=3D=
"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_config_ge=
t_bool_char_impl()<br class=3D"">Return singularity_config_get_bool(allow p=
id ns, yes) =3D 0<br class=3D"">VERBOSE [U=3D8693,P=3D79809] &nbsp;&nbsp;si=
ngularity_runtime_ns_pid() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Not<br class=3D"">virtualizing PID namespace =
by configuration<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp=
;&nbsp;singularity_runtime_ns()<br class=3D"">Calling: _singularity_runtime=
_ns_ipc()<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;=
singularity_config_get_bool_char_impl()<br class=3D"">Called singularity_co=
nfig_get_bool(allow ipc ns, yes)<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,=
P=3D79809] &nbsp;&nbsp;singularity_config_get_value_impl() &nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;No<br class=3D"">configuration entry found for 'allow i=
pc ns'; returning default value 'yes'<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D=
8693,P=3D79809] &nbsp;&nbsp;singularity_config_get_bool_char_impl()<br clas=
s=3D"">Return singularity_config_get_bool(allow ipc ns, yes) =3D 1<br class=
=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_regist=
ry_get()<br class=3D"">Returning NULL on 'UNSHARE_IPC'<br class=3D"">VERBOS=
E [U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_runtime_ns_ipc() &nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Not<br c=
lass=3D"">virtualizing IPC namespace on user request<br class=3D"">DEBUG &n=
bsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_runtime_ns()<br clas=
s=3D"">Calling: _singularity_runtime_ns_mnt()<br class=3D"">DEBUG &nbsp;&nb=
sp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_config_get_bool_char_impl()=
<br class=3D"">Called singularity_config_get_bool(mount slave, yes)<br clas=
s=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_confi=
g_get_value_impl()<br class=3D"">Returning configuration value mount slave=
=3D'yes'<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;s=
ingularity_config_get_bool_char_impl()<br class=3D"">Return singularity_con=
fig_get_bool(mount slave, yes) =3D 1<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8=
693,P=3D79809] &nbsp;&nbsp;singularity_priv_escalate()<br class=3D"">Tempor=
arily escalating privileges (U=3D8693)<br class=3D"">DEBUG &nbsp;&nbsp;[U=
=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_priv_escalate()<b=
r class=3D"">Clearing supplementary GIDs.<br class=3D"">DEBUG &nbsp;&nbsp;[=
U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_runtime_ns_mnt()=
<br class=3D"">Virtualizing FS namespace<br class=3D"">DEBUG &nbsp;&nbsp;[U=
=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_runtime_ns_mnt()<=
br class=3D"">Virtualizing mount namespace<br class=3D"">DEBUG &nbsp;&nbsp;=
[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_runtime_ns_mnt(=
)<br class=3D"">Making mounts slave<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,=
P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_priv_drop()<br class=
=3D"">Dropping privileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)<=
br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;singularity_priv_drop()<br class=3D"">Restoring supplementary groups<b=
r class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity=
_priv_drop()<br class=3D"">Confirming we have correct UID/GID<br class=3D""=
>DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_sessiondir(=
)<br class=3D"">Setting sessiondir<br class=3D"">VERBOSE [U=3D8693,P=3D7980=
9] &nbsp;&nbsp;singularity_sessiondir()<br class=3D"">Using session directo=
ry: /var/singularity/mnt/session<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,=
P=3D79809] &nbsp;&nbsp;singularity_sessiondir()<br class=3D"">Checking for =
session directory: /var/singularity/mnt/session<br class=3D"">DEBUG &nbsp;&=
nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_sessiondir()<br class=3D"=
">Obtaining the default sessiondir size<br class=3D"">DEBUG &nbsp;&nbsp;[U=
=3D8693,P=3D79809] &nbsp;&nbsp;singularity_config_get_value_impl() &nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;No<br class=3D"">configuration entry found for =
'sessiondir max size'; returning default value<br class=3D"">'16'<br class=
=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_sessio=
ndir()<br class=3D"">Converted sessiondir size to: 16<br class=3D"">DEBUG &=
nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_sessiondir()<br cla=
ss=3D"">Creating the sessiondir size mount option length<br class=3D"">DEBU=
G &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_sessiondir() &nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;Got<br class=3D"">size length of: 9<br class=3D"">D=
EBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_sessiondir()<=
br class=3D"">Creating the sessiondir size mount option string<br class=3D"=
">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_sessiondir=
()<br class=3D"">Checking to make sure the string was allocated correctly<b=
r class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity=
_priv_escalate()<br class=3D"">Temporarily escalating privileges (U=3D8693)=
<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;singularity_priv_escalate()<br class=3D"">Clearing supplementary GIDs=
.<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;singularity_sessiondir()<br class=3D"">Mounting sessiondir tmpfs: /v=
ar/singularity/mnt/session<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809=
] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_priv_drop()<br class=3D"">Dropp=
ing privileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)<br class=3D=
"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singul=
arity_priv_drop()<br class=3D"">Restoring supplementary groups<br class=3D"=
">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_priv_drop(=
)<br class=3D"">Confirming we have correct UID/GID<br class=3D"">VERBOSE [U=
=3D8693,P=3D79809] &nbsp;&nbsp;singularity_registry_set()<br class=3D"">Add=
ing value to registry: 'SESSIONDIR' =3D '/var/singularity/mnt/session'<br c=
lass=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_re=
gistry_set()<br class=3D"">Returning singularity_registry_set(SESSIONDIR, /=
var/singularity/mnt/session)<br class=3D"">=3D 0<br class=3D"">DEBUG &nbsp;=
&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_registry_get()<br class=
=3D"">Returning NULL on 'CLEANUPDIR'<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8=
693,P=3D79809] &nbsp;&nbsp;singularity_registry_get()<br class=3D"">Returni=
ng NULL on 'NOSESSIONCLEANUP'<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=
=3D79809] &nbsp;&nbsp;singularity_registry_get()<br class=3D"">Returning NU=
LL on 'NOCLEANUP'<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbs=
p;&nbsp;singularity_cleanupd() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Not<b=
r class=3D"">running a cleanup thread, no 'SINGULARITY_CLEANUPDIR' defined<=
br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularit=
y_registry_get()<br class=3D"">Returning value from registry: 'IMAGE' =3D '=
gossamer.img'<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&n=
bsp;singularity_registry_get()<br class=3D"">Returning NULL on 'WRITABLE'<b=
r class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity=
_config_get_value_impl() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;No<br class=3D=
"">configuration entry found for 'limit container owners'; returning defaul=
t<br class=3D"">value 'NULL'<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D=
79809] &nbsp;&nbsp;singularity_config_get_value_impl() &nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;No<br class=3D"">configuration entry found for 'limit conta=
iner paths'; returning default<br class=3D"">value 'NULL'<br class=3D"">DEB=
UG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_image_open()<br=
 class=3D"">Opening file descriptor to image: gossamer.img<br class=3D"">VE=
RBOSE [U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_image_check()<br class=
=3D"">Checking that file pointer is a Singularity image<br class=3D"">DEBUG=
 &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_image_check()<br =
class=3D"">First line of image(fd=3D6): #!/usr/bin/env run-singularity<br c=
lass=3D""><br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp=
;singularity_image_check()<br class=3D"">Checking if first line matches key=
<br class=3D"">VERBOSE [U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_image_c=
heck()<br class=3D"">File is not a valid Singularity image<br class=3D"">DE=
BUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_config_get_val=
ue_impl() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;No<br class=3D"">configuratio=
n entry found for 'max loop devices'; returning default value<br class=3D""=
>'256'<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;sin=
gularity_image_bind()<br class=3D"">Entered singularity_image_bind()<br cla=
ss=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_imag=
e_bind()<br class=3D"">Converting max_loop_devs_string to int: '256'<br cla=
ss=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_imag=
e_bind()<br class=3D"">Converted max_loop_devs_string to int: '256' -&gt; 2=
56<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singula=
rity_image_bind()<br class=3D"">Checking if this image has been properly op=
ened<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singu=
larity_image_bind()<br class=3D"">Checking if image is valid file<br class=
=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_image_=
bind()<br class=3D"">Checking if image is already bound to a loop device<br=
 class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_=
registry_get()<br class=3D"">Returning NULL on 'WRITABLE'<br class=3D"">DEB=
UG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_image_bind()<br=
 class=3D"">Setting loopdev open to: O_RDONLY<br class=3D"">DEBUG &nbsp;&nb=
sp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_image_bind()<br class=3D"">=
Setting LO_FLAGS_AUTOCLEAR<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79=
809] &nbsp;&nbsp;singularity_image_bind()<br class=3D"">Calculating image o=
ffset<br class=3D"">VERBOSE [U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_im=
age_check()<br class=3D"">Checking that file pointer is a Singularity image=
<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singulari=
ty_image_check()<br class=3D"">First line of image(fd=3D6): #!/usr/bin/env =
run-singularity<br class=3D""><br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=
=3D79809] &nbsp;&nbsp;singularity_image_check()<br class=3D"">Checking if f=
irst line matches key<br class=3D"">VERBOSE [U=3D8693,P=3D79809] &nbsp;&nbs=
p;singularity_image_check()<br class=3D"">File is not a valid Singularity i=
mage<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singu=
larity_image_offset()<br class=3D"">File is not a Singularity image, return=
ing zero offset<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;=
&nbsp;singularity_priv_escalate()<br class=3D"">Temporarily escalating priv=
ileges (U=3D8693)<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;singularity_priv_escalate()<br class=3D"">Clearing s=
upplementary GIDs.<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;singularity_image_bind()<br class=3D"">Finding next=
 available loop device...<br class=3D"">VERBOSE [U=3D0,P=3D79809] &nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;singularity_image_bind()<br class=3D"">Found available=
 loop device: /dev/loop0<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] =
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_image_bind()<br class=3D"">Settin=
g loop device flags<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;singularity_priv_drop()<br class=3D"">Dropping pri=
vileges to UID=3D8693, GID=3D1056 (2 supplementary GIDs)<br class=3D"">DEBU=
G &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_p=
riv_drop()<br class=3D"">Restoring supplementary groups<br class=3D"">DEBUG=
 &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_priv_drop()<br cl=
ass=3D"">Confirming we have correct UID/GID<br class=3D"">VERBOSE [U=3D8693=
,P=3D79809] &nbsp;&nbsp;singularity_image_bind()<br class=3D"">Using loop d=
evice: /dev/loop0<br class=3D"">VERBOSE [U=3D8693,P=3D79809] &nbsp;&nbsp;si=
ngularity_runtime_rootfs() &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set<br class=3D"">container directory to: /va=
r/singularity/mnt/container<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D7=
9809] &nbsp;&nbsp;singularity_runtime_rootfs()<br class=3D"">Checking for c=
ontainer directory<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nb=
sp;&nbsp;singularity_runtime_rootfs()<br class=3D"">Returning container_dir=
ectory: /var/singularity/mnt/container<br class=3D"">DEBUG &nbsp;&nbsp;[U=
=3D8693,P=3D79809] &nbsp;&nbsp;chk_mode()<br class=3D"">Checking exact mode=
 (40755) on: /var/singularity/mnt/container<br class=3D"">DEBUG &nbsp;&nbsp=
;[U=3D8693,P=3D79809] &nbsp;&nbsp;chk_mode()<br class=3D"">Found appropriat=
e mode on file: /var/singularity/mnt/container<br class=3D"">VERBOSE [U=3D8=
693,P=3D79809] &nbsp;&nbsp;singularity_image_mount()<br class=3D"">Checking=
 what kind of image we are mounting<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D86=
93,P=3D79809] &nbsp;&nbsp;singularity_image_mount_squashfs_check()<br class=
=3D"">Image does not appear to be of type '.sqsh': gossamer.img<br class=3D=
"">DEBUG &nbsp;&nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_image_mou=
nt_dir_check()<br class=3D"">Checking if image is a directory<br class=3D""=
>VERBOSE [U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_image_mount_dir_check=
()<br class=3D"">Source path is not a directory: gossamer.img<br class=3D""=
>VERBOSE [U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_image_mount()<br clas=
s=3D"">Attempting to mount as singularity image<br class=3D"">DEBUG &nbsp;&=
nbsp;[U=3D8693,P=3D79809] &nbsp;&nbsp;singularity_registry_get()<br class=
=3D"">Returning NULL on 'WRITABLE'<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D869=
3,P=3D79809] &nbsp;&nbsp;singularity_priv_escalate()<br class=3D"">Temporar=
ily escalating privileges (U=3D8693)<br class=3D"">DEBUG &nbsp;&nbsp;[U=3D0=
,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_priv_escalate()<br cl=
ass=3D"">Clearing supplementary GIDs.<br class=3D"">VERBOSE [U=3D0,P=3D7980=
9] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_image_mount_image_mount()<br c=
lass=3D"">Mounting /dev/loop0 in read/only to: /var/singularity/mnt/contain=
er<br class=3D"">ERROR &nbsp;&nbsp;[U=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;singularity_image_mount_image_mount()<br class=3D"">Failed to mount=
 image in (read only): Invalid argument<br class=3D"">ABORT &nbsp;&nbsp;[U=
=3D0,P=3D79809] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singularity_image_mount_image=
_mount()<br class=3D"">Retval =3D 255<br class=3D""><br class=3D"">On Tuesd=
ay, June 27, 2017 at 10:54:11 AM UTC-4, vanessa wrote:<br class=3D""><br cl=
ass=3D""><br class=3D"">Could you provide the --debug output?<br class=3D""=
><br class=3D"">On Tue, Jun 27, 2017 at 7:48 AM, Charles Murphy &lt;murphy.=
...@<a href=3D"http://gmail.com/" class=3D"">gmail.com</a>&gt;<br class=3D"=
">wrote:<br class=3D""><br class=3D""><br class=3D"">Great! Thanks for your=
 detailed response. I=E2=80=99ve been trying to run my<br class=3D"">singul=
arity image on my cluster, but hit an error. Here are my steps:<br class=3D=
""><br class=3D"">1. I setup an ubuntu (v16.4) on my Mac via vagrant/virtua=
lbox<br class=3D""><br class=3D"">2. Install singularity (v2.3)<br class=3D=
""><br class=3D"">3. Ran the following:<br class=3D""><br class=3D"">singul=
arity create --size 2500 --force gossamer.img<br class=3D""><br class=3D"">=
4. Then ran the following:<br class=3D""><br class=3D"">sudo singularity bo=
otstrap gossamer.img Singularity<br class=3D""><br class=3D"">My Singularit=
y bootstrap file:<br class=3D""><br class=3D"">Bootstrap: docker<br class=
=3D"">From: ubuntu:16.04<br class=3D""><br class=3D"">%setup<br class=3D"">=
<br class=3D""> &nbsp;mkdir -p /scratchLocal<br class=3D""> &nbsp;mkdir -p =
/pbtech_mounts<br class=3D""> &nbsp;mkdir -p /athena<br class=3D""> &nbsp;m=
kdir -p /cluster001<br class=3D""> &nbsp;mkdir -p /scratch<br class=3D""><b=
r class=3D"">%post<br class=3D""> apt-get update<br class=3D""> apt-get -y =
install curl git g++ cmake libboost-all-dev pandoc<br class=3D"">zlib1g-dev=
 libbz2-dev libsqlite3-dev<br class=3D""> git clone <a href=3D"https://gith=
ub.com/data61/gossamer" class=3D"">https://github.com/data61/gossamer</a><b=
r class=3D""> cd gossamer<br class=3D""> mkdir build<br class=3D""> cd buil=
d<br class=3D""> cmake ..<br class=3D""> make &amp;&amp; make install<br cl=
ass=3D""><br class=3D"">The mkdir are for my particular cluster setup which=
 I=E2=80=99 am told I need<br class=3D"">to include.<br class=3D""><br clas=
s=3D"">5. I copied gossamer.img to my cluster and get the following error<b=
r class=3D"">after trying to run it:<br class=3D""><br class=3D"">chm2059@c=
annes chm2059 $ singularity exec gossamer.img<br class=3D"">/usr/local/bin/=
xenome -h<br class=3D"">ERROR &nbsp;: Failed to mount image in (read only):=
 Invalid argument<br class=3D"">ABORT &nbsp;: Retval =3D 255<br class=3D"">=
<br class=3D"">Note if I run that same command on my vagrant/virtualbox mac=
hine it<br class=3D"">works fine. Any ideas on what the issue is? My cluste=
r is running<br class=3D"">singularity (v2.3-dist)<br class=3D""><br class=
=3D"">On Wednesday, June 21, 2017 at 4:08:49 PM UTC-4, vanessa wrote:<br cl=
ass=3D""><br class=3D""><br class=3D"">Hey Charles!<br class=3D""><br class=
=3D"">Here is some quick guidance:<br class=3D""><br class=3D""><br class=
=3D""><br class=3D"">1. Create the singularity image on an ubuntu GCE machi=
ne.<br class=3D""><br class=3D""><br class=3D""><br class=3D"">This would d=
efinitely work, or you could use your own computer (or a<br class=3D"">virt=
ual machine on it) - see <a href=3D"http://singularity.lbl.gov/install-mac"=
 class=3D"">http://singularity.lbl.gov/install-mac</a>. You<br class=3D"">c=
ould also just define the build specification file (called "Singularity")<b=
r class=3D"">and put it in a Github repo, and have singularity hub build it=
 for you<br class=3D"">(guide is here<br class=3D""><a href=3D"https://gith=
ub.com/singularityhub/singularityhub.github.io/wiki" class=3D"">https://git=
hub.com/singularityhub/singularityhub.github.io/wiki</a>) The pull<br class=
=3D"">command would be something like:<br class=3D""><br class=3D"">singula=
rity pull <a href=3D"shub://username/reponame" class=3D"">shub://username/r=
eponame</a><br class=3D""><br class=3D""><br class=3D""><br class=3D""><br =
class=3D"">2. Copy the image to my cluster.<br class=3D""><br class=3D""><b=
r class=3D""><br class=3D"">Yes you could do this, or use Singularity Hub. =
Many ways to skin a<br class=3D"">cat!<br class=3D""><br class=3D""><br cla=
ss=3D"">3. Run the image and point it to the data on the cluster filesystem=
<br class=3D"">for it to run on. Then get it's output and save to the clust=
er filesystem.<br class=3D""><br class=3D"">You would want to bind the data=
 directory to the container (don't put<br class=3D"">the data in the contai=
ner!) Like:<br class=3D""><br class=3D""><br class=3D""><br class=3D"">sing=
ularity exec &nbsp;-B /scratch/data:/scratch username-reponame.img<br class=
=3D"">/path/to/python script.py<br class=3D""><br class=3D""><br class=3D""=
><br class=3D"">Notice in the above I am binding /scratch/data on the host =
to<br class=3D"">/scratch in the container. If your cluster doesn't support=
 overlay fs you<br class=3D"">should be sure to create /scratch in the cont=
ainer.<br class=3D""><br class=3D"">Sorry I think this is a basic question,=
 but if anyone could help.<br class=3D"">Thanks!<br class=3D""><br class=3D=
"">--<br class=3D""><br class=3D""><br class=3D"">No worries! That's why we=
 have the list :O)<br class=3D""><br class=3D"">Best,<br class=3D""><br cla=
ss=3D"">Vanessa<br class=3D""><br class=3D""><br class=3D"">You received th=
is message because you are subscribed to the Google<br class=3D"">Groups "s=
ingularity" group.<br class=3D"">To unsubscribe from this group and stop re=
ceiving emails from it,<br class=3D"">send an email to singularity...@<a hr=
ef=3D"http://lbl.gov/" class=3D"">lbl.gov</a>.<br class=3D""><br class=3D""=
><br class=3D""><br class=3D""><br class=3D""><br class=3D"">--<br class=3D=
"">Vanessa Villamia Sochat<br class=3D"">Stanford University '16<br class=
=3D"">(603) 321-0676<br class=3D""><br class=3D""><br class=3D"">--<br clas=
s=3D"">You received this message because you are subscribed to the Google<b=
r class=3D"">Groups "singularity" group.<br class=3D"">To unsubscribe from =
this group and stop receiving emails from it, send<br class=3D"">an email t=
o singularity...@<a href=3D"http://lbl.gov/" class=3D"">lbl.gov</a>.<br cla=
ss=3D""><br class=3D""><br class=3D""><br class=3D""><br class=3D""><br cla=
ss=3D"">--<br class=3D"">Vanessa Villamia Sochat<br class=3D"">Stanford Uni=
versity '16<br class=3D"">(603) 321-0676<br class=3D""><br class=3D""><br c=
lass=3D"">--<br class=3D"">You received this message because you are subscr=
ibed to the Google<br class=3D"">Groups "singularity" group.<br class=3D"">=
To unsubscribe from this group and stop receiving emails from it, send<br c=
lass=3D"">an email to singularity...@<a href=3D"http://lbl.gov/" class=3D""=
>lbl.gov</a>.<br class=3D""><br class=3D""><br class=3D""><br class=3D""><b=
r class=3D""><br class=3D"">--<br class=3D"">Vanessa Villamia Sochat<br cla=
ss=3D"">Stanford University '16<br class=3D"">(603) 321-0676<br class=3D"">=
<br class=3D""><br class=3D"">--<br class=3D"">You received this message be=
cause you are subscribed to the Google Groups<br class=3D"">"singularity" g=
roup.<br class=3D"">To unsubscribe from this group and stop receiving email=
s from it, send an<br class=3D"">email to <a href=3D"mailto:singu...@lbl.go=
v" class=3D"">singu...@lbl.gov</a>.<br class=3D""><br class=3D""><br class=
=3D"">--<br class=3D"">You received this message because you are subscribed=
 to the Google Groups<br class=3D"">"singularity" group.<br class=3D"">To u=
nsubscribe from this group and stop receiving emails from it, send an<br cl=
ass=3D"">email to <a href=3D"mailto:singu...@lbl.gov" class=3D"">singu...@l=
bl.gov</a>.<br class=3D""><br class=3D""><br class=3D"">--<br class=3D"">Yo=
u received this message because you are subscribed to the Google Groups<br =
class=3D"">"singularity" group.<br class=3D"">To unsubscribe from this grou=
p and stop receiving emails from it, send an<br class=3D"">email to <a href=
=3D"mailto:singu...@lbl.gov" class=3D"">singu...@lbl.gov</a>.<br class=3D""=
><br class=3D""><br class=3D"">--<br class=3D"">You received this message b=
ecause you are subscribed to the Google Groups<br class=3D"">"singularity" =
group.<br class=3D"">To unsubscribe from this group and stop receiving emai=
ls from it, send an<br class=3D"">email to <a href=3D"mailto:singu...@lbl.g=
ov" class=3D"">singu...@lbl.gov</a>.<br class=3D""><br class=3D""><br class=
=3D"">--<br class=3D"">You received this message because you are subscribed=
 to the Google Groups<br class=3D"">"singularity" group.<br class=3D"">To u=
nsubscribe from this group and stop receiving emails from it, send an<br cl=
ass=3D"">email to <a href=3D"mailto:singu...@lbl.gov" class=3D"">singu...@l=
bl.gov</a>.<br class=3D""></blockquote><br class=3D"">-- <br class=3D"">You=
 received this message because you are subscribed to the Google Groups "sin=
gularity" group.<br class=3D"">To unsubscribe from this group and stop rece=
iving emails from it, send an email to <a href=3D"mailto:singu...@lbl.gov" =
class=3D"">singu...@lbl.gov</a>.<br class=3D""></div></div></blockquote></d=
iv><br class=3D""></div></div></div></blockquote></div><br class=3D""></div=
></div><div class=3D""><br class=3D"webkit-block-placeholder"></div>

-- <br class=3D"">
You received this message because you are subscribed to the Google Groups "=
singularity" group.<br class=3D"">
To unsubscribe from this group and stop receiving emails from it, send an e=
mail to <a href=3D"mailto:singu...@lbl.gov" class=3D"">singu...@lbl.gov</a>=
.<br class=3D"">
</div></blockquote></div><br class=3D""></div></div></div></body></html>
--Apple-Mail=_299B5C84-5089-42D1-9375-8AAD0424BBCA--
